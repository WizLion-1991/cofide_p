function rhh_Calculo_Anual_ISR(){}function rhh_Calculo_Anual_ISR_Modi(){$("#dialogWait").dialog("open");var itemIdCob=0;var strPost="";var intIdMaster=document.getElementById("AN_ISR_ID").value;strPost+="&intIdMaster="+intIdMaster;$.ajax({type:"POST",data:strPost,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_CalculoAnualISR.jsp?id=3",success:function(datos){jQuery("#GRID_CALC_ISR").clearGridData();var objsc=datos.getElementsByTagName("ISR")[0];var lst=objsc.getElementsByTagName("ISR_Deta");for(var i=0;i<lst.length;i++){var obj=lst[i];var datarow={GRD_ISR_TOTAL_REMUN:obj.getAttribute("dblTOTAL_REMUND"),GRD_ISR_TOTAL_PRC_EX:obj.getAttribute("dblTOTAL_PRC_EXCD"),GRD_ISR_TOTAL_PRC_GRAV:obj.getAttribute("dblTOTAL_PRC_GRAVD"),GRD_ISR_IMPUESTO_CALC:obj.getAttribute("dblIMPUESTO_CALCD"),GRD_ISR_IMPUESTO_RET_AN:obj.getAttribute("dblIMPUESTO_RET_AND"),GRD_ISR_DIFERENCIA:obj.getAttribute("dblDIFERENCIAD"),GRD_ISR_IDEMPLEADO:obj.getAttribute("intIdEmpleado"),GRD_ISR_IDNOMBRE:obj.getAttribute("strNombreEmpleado")};itemIdCob++;jQuery("#GRID_CALC_ISR").addRowData(itemIdCob,datarow,"last");}var lst1=objsc.getElementsByTagName("ISR_Master");for(var i=0;i<lst1.length;i++){var obj=lst1[i];document.getElementById("AN_ISR_TOTAL_REMUN").value=obj.getAttribute("dblTOTAL_REMUN");document.getElementById("AN_ISR_TOTAL_PRC_EXC").value=obj.getAttribute("dblTOTAL_PRC_EXC");document.getElementById("AN_ISR_TOTAL_PRC_GRAV").value=obj.getAttribute("dblTOTAL_PRC_GRAV");document.getElementById("AN_ISR_IMPUESTO_CALC").value=obj.getAttribute("dblIMPUESTO_CALC");document.getElementById("AN_ISR_IMPUESTO_RET_AN").value=obj.getAttribute("dblIMPUESTO_RET_AN");document.getElementById("AN_ISR_DIFERENCIA").value=obj.getAttribute("dblDIFERENCIA");}$("#dialogWait").dialog("close");},error:function(){jQuery("#GRID_CALC_ISR").clearGridData();alert("No hay productos con esas caracteristicas");$("#dialogWait").dialog("close");}});}function CalCuloAN_ISR(){$("#dialogWait").dialog("open");var itemIdCob=0;var strPost="";var bolValida=0;var intAnio=document.getElementById("AN_ISR_ANIO").value;var intTipoNomina=document.getElementById("AN_ISR_TIPO_NOMINA").value;strPost+="&intAnio="+intAnio;strPost+="&intTipoNomina="+intTipoNomina;if(intAnio==""){alert("Captura el A単o");bolValida=1;}else{if(intAnio.length!=4){alert("El a単o debe ser de 4 digitos");bolValida=1;}}if(intTipoNomina==0){alert("Captura el Tipo de Nomina");bolValida=1;}if(bolValida==0){$.ajax({type:"POST",data:strPost,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_CalculoAnualISR.jsp?id=1",success:function(datos){jQuery("#GRID_CALC_ISR").clearGridData();var objsc=datos.getElementsByTagName("ISR")[0];var lst=objsc.getElementsByTagName("ISR_Deta");var dblTOTAL_REMUN=0;var dblTOTAL_PRC_EXC=0;var dblTOTAL_PRC_GRAV=0;var dblIMPUESTO_CALC=0;var dblIMPUESTO_RET_AN=0;var dblDIFERENCIA=0;for(var i=0;i<lst.length;i++){var obj=lst[i];dblTOTAL_REMUN=parseFloat(dblTOTAL_REMUN)+parseFloat(obj.getAttribute("TotalRemuneraciones"));dblTOTAL_PRC_EXC=parseFloat(dblTOTAL_PRC_EXC)+parseFloat(obj.getAttribute("TotalPercepcionesExentas"));dblTOTAL_PRC_GRAV=parseFloat(dblTOTAL_PRC_GRAV)+parseFloat(obj.getAttribute("TotalPercepcionesGravadas"));dblIMPUESTO_CALC=parseFloat(dblIMPUESTO_CALC)+parseFloat(obj.getAttribute("ImpuestoCalculado"));dblIMPUESTO_RET_AN=parseFloat(dblIMPUESTO_RET_AN)+parseFloat(obj.getAttribute("ImpuestoRetenidoAnio"));dblDIFERENCIA=parseFloat(dblDIFERENCIA)+parseFloat(obj.getAttribute("Diferencia"));var datarow={GRD_ISR_TOTAL_REMUN:obj.getAttribute("TotalRemuneraciones"),GRD_ISR_TOTAL_PRC_EX:obj.getAttribute("TotalPercepcionesExentas"),GRD_ISR_TOTAL_PRC_GRAV:obj.getAttribute("TotalPercepcionesGravadas"),GRD_ISR_IMPUESTO_CALC:obj.getAttribute("ImpuestoCalculado"),GRD_ISR_IMPUESTO_RET_AN:obj.getAttribute("ImpuestoRetenidoAnio"),GRD_ISR_DIFERENCIA:obj.getAttribute("Diferencia"),GRD_ISR_IDEMPLEADO:obj.getAttribute("IdEmpleado"),GRD_ISR_IDNOMBRE:obj.getAttribute("NombreEmpleado")};itemIdCob++;jQuery("#GRID_CALC_ISR").addRowData(itemIdCob,datarow,"last");}document.getElementById("AN_ISR_TOTAL_REMUN").value=dblTOTAL_REMUN.toFixed(2);document.getElementById("AN_ISR_TOTAL_PRC_EXC").value=dblTOTAL_PRC_EXC.toFixed(2);document.getElementById("AN_ISR_TOTAL_PRC_GRAV").value=dblTOTAL_PRC_GRAV.toFixed(2);document.getElementById("AN_ISR_IMPUESTO_CALC").value=dblIMPUESTO_CALC.toFixed(2);document.getElementById("AN_ISR_IMPUESTO_RET_AN").value=dblIMPUESTO_RET_AN.toFixed(2);document.getElementById("AN_ISR_DIFERENCIA").value=dblDIFERENCIA.toFixed(2);$("#dialogWait").dialog("close");},error:function(){jQuery("#GRID_CALC_ISR").clearGridData();alert("No hay productos con esas caracteristicas");$("#dialogWait").dialog("close");}});}$("#dialogWait").dialog("close");}function doSaveGridDeta(datos){$("#dialogWait").dialog("open");var itemIdCob=0;var strPost="";var intIdMaster="";if(datos!=null){intIdMaster=trim(datos).replace("OK","");}else{intIdMaster=document.getElementById("CC_ID").value;}var grid1=jQuery("#GRID_CALC_ISR");var idArr=grid1.getDataIDs();if(idArr.length==0){alert("No Contiene ISR");}else{for(var i=0;i<idArr.length;i++){var id=idArr[i];var lstRow=grid1.getRowData(id);strPost+="&TOTAL_REMUN"+i+"="+lstRow.GRD_ISR_TOTAL_REMUN+"";strPost+="&TOTAL_PRC_EX"+i+"="+lstRow.GRD_ISR_TOTAL_PRC_EX+"";strPost+="&TOTAL_PRC_GRAV"+i+"="+lstRow.GRD_ISR_TOTAL_PRC_GRAV+"";strPost+="&IMPUESTO_CALC"+i+"="+lstRow.GRD_ISR_IMPUESTO_CALC+"";strPost+="&IMPUESTO_RET_AN"+i+"="+lstRow.GRD_ISR_IMPUESTO_RET_AN+"";strPost+="&DIFERENCIA"+i+"="+lstRow.GRD_ISR_DIFERENCIA+"";strPost+="&IdEmpleado"+i+"="+lstRow.GRD_ISR_IDEMPLEADO+"";strPost+="&NombreEmpleado"+i+"="+lstRow.GRD_ISR_IDNOMBRE+"";}strPost+="&intlenghtArr="+idArr.length;strPost+="&intIdMaster="+intIdMaster;$.ajax({type:"POST",data:strPost,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_CalculoAnualISR.jsp?id=2",success:function(datos){if(datos.substring(0,2)=="OK"){_objSc.RestoreSave();_objSc=null;}else{alert(datos);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":pto:"+objeto+" "+quepaso+" "+otroobj);}});}}function doSaveGridDetaModi(datos){$("#dialogWait").dialog("open");var itemIdCob=0;var strPost="";var intIdMaster="";if(datos!=null){intIdMaster=trim(datos).replace("OK","");}else{intIdMaster=document.getElementById("CC_ID").value;}var grid1=jQuery("#GRID_CALC_ISR");var idArr=grid1.getDataIDs();if(idArr.length==0){alert("No Contiene ISR");}else{for(var i=0;i<idArr.length;i++){var id=idArr[i];var lstRow=grid1.getRowData(id);strPost+="&TOTAL_REMUN"+i+"="+lstRow.GRD_ISR_TOTAL_REMUN+"";strPost+="&TOTAL_PRC_EX"+i+"="+lstRow.GRD_ISR_TOTAL_PRC_EX+"";strPost+="&TOTAL_PRC_GRAV"+i+"="+lstRow.GRD_ISR_TOTAL_PRC_GRAV+"";strPost+="&IMPUESTO_CALC"+i+"="+lstRow.GRD_ISR_IMPUESTO_CALC+"";strPost+="&IMPUESTO_RET_AN"+i+"="+lstRow.GRD_ISR_IMPUESTO_RET_AN+"";strPost+="&DIFERENCIA"+i+"="+lstRow.GRD_ISR_DIFERENCIA+"";strPost+="&IdEmpleado"+i+"="+lstRow.GRD_ISR_IDEMPLEADO+"";strPost+="&NombreEmpleado"+i+"="+lstRow.GRD_ISR_IDNOMBRE+"";}strPost+="&intlenghtArr="+idArr.length;strPost+="&intIdMaster="+intIdMaster;$.ajax({type:"POST",data:strPost,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_CalculoAnualISR.jsp?id=4",success:function(datos){if(datos.substring(0,2)=="OK"){_objSc.RestoreSave();_objSc=null;}else{alert(datos);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":pto:"+objeto+" "+quepaso+" "+otroobj);}});}}function GeneraBach(){$("#dialogWait").dialog("open");var strPost="";var bolValida=0;var intAnio=document.getElementById("AN_ISR_ANIO").value;var intTipoNomina=document.getElementById("AN_ISR_TIPO_NOMINA").value;strPost+="&intAnio="+intAnio;strPost+="&intTipoNomina="+intTipoNomina;if(intAnio==""){alert("Captura el A単o");
bolValida=1;}else{if(intAnio.length!=4){alert("El a単o debe ser de 4 digitos");bolValida=1;}}if(intTipoNomina==0){alert("Captura el Tipo de Nomina");bolValida=1;}if(bolValida==0){Abrir_Link("ERP_CalculoAnualISR.jsp?id=5&boton_1=XLS"+strPost,500,600,0,0);}$("#dialogWait").dialog("close");}