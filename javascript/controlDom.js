function Formulario(strNombre,strTitulo,xmlDoc,objDiv,dialog,Oper,withoutButtons,objScreen){this.strNombre=strNombre;this.strTitulo=strTitulo;this.xmlDoc=xmlDoc;this.objDiv=objDiv;this.dialog=dialog;this.Oper=Oper;this.objScreen=objScreen;this.withoutButtons=withoutButtons;this.bolUseMod=false;this.bolgetData=false;if(this.Oper==null){this.Oper="";}if(this.withoutButtons==null){this.withoutButtons=false;}this.ObtenNomNext=function ObtenNomNext(i,_ctrlParam){var nomNext="";if((i+1)==_ctrlParam.length){nomNext="btn1";}else{if((i+1)<_ctrlParam.length){for(var cNX=i+1;cNX<_ctrlParam.length;cNX++){var obj2=_ctrlParam[cNX];var bolPasaC2=false;if(this.Oper==""){bolPasaC2=true;}if(this.Oper=="_new"&&obj2.getAttribute("frmd_nuevo")==1){bolPasaC2=true;}if(this.Oper=="_ed"&&obj2.getAttribute("frmd_modif")==1){bolPasaC2=true;}if(bolPasaC2==true){if(obj2.getAttribute("frmd_tipo")!="hidden"&&obj2.getAttribute("frmd_oculto")!=1&&obj2.getAttribute("frmd_tipo")!="label"&&obj2.getAttribute("frmd_tipo")!="grid"){nomNext=obj2.getAttribute("frmd_nombre");break;}}}}}return nomNext;};this.aleatorio=function aleatorio(inferior,superior){var numPosibilidades=superior-inferior;var aleat=Math.random()*numPosibilidades;aleat=Math.floor(aleat);return parseInt(inferior)+aleat;};this.makeForm=function makeForm(){if(this.xmlDoc!=null){try{var strNameForms="";var strTypeForms="";var _objscMKFoRM=this.xmlDoc.getElementsByTagName("Screen")[0];var strtitle=_objscMKFoRM.getAttribute("frm_title");var strfrm_abrv=_objscMKFoRM.getAttribute("frm_abrv");var strScript=_objscMKFoRM.getAttribute("frm_script");var strjavascript=_objscMKFoRM.getAttribute("frm_javascript");strjavascript=sustituye(strjavascript,"##","&&");var strTitleButton=_objscMKFoRM.getAttribute("frm_titleButton");var strfrm_scriptCancel=_objscMKFoRM.getAttribute("frm_scriptCancel");var intfrm_enctype=_objscMKFoRM.getAttribute("frm_enctype");var strfrm_target=_objscMKFoRM.getAttribute("frm_target");var intfrm_numtabs=_objscMKFoRM.getAttribute("frm_numtabs");var strfrm_onTabShow=_objscMKFoRM.getAttribute("frm_onTabShow");var strfrm_onTabClick=_objscMKFoRM.getAttribute("frm_onTabClick");var strfrm_onTabHide=_objscMKFoRM.getAttribute("frm_onTabHide");var intfrm_focusauto=_objscMKFoRM.getAttribute("frm_focusauto");var intfrm_idMaster=_objscMKFoRM.getAttribute("frm_id");var intfrm_tiene_ayuda_rapida=_objscMKFoRM.getAttribute("frm_tiene_ayuda_rapida");if(this.strNombre==""){this.strNombre=_objscMKFoRM.getAttribute("frm_abrv");}var bolUsaTabs=false;if(intfrm_numtabs==0){intfrm_numtabs=1;}if(intfrm_numtabs>1){bolUsaTabs=true;}if(this.Oper=="_importa"){bolUsaTabs=false;intfrm_numtabs=1;}var strfrm_scriptBegin="";var strfrm_esreporte=_objscMKFoRM.getAttribute("frm_esreporte");if(strfrm_esreporte==1){this.withoutButtons=true;}if(this.Oper=="_new"){strfrm_scriptBegin=_objscMKFoRM.getAttribute("frm_scriptBeginAlta");}if(this.bolUseMod){if(this.Oper=="_ed"){strfrm_scriptBegin=_objscMKFoRM.getAttribute("frm_scriptBeginModi");}}if(strTitleButton==""){strTitleButton="ALMACENAR";}var _ctrlMKFoRM=_objscMKFoRM.getElementsByTagName("ctrl");var strHtml="";if(intfrm_enctype==1){strHtml+='<form method="post" id="form1" accept-charset="utf-8" '+strfrm_target+' enctype="multipart/form-data" action="'+strScript+'">';strHtml+='<div id="form" class="tabla">';}else{strHtml+='<form method="post" id="form1" accept-charset="utf-8" '+strfrm_target+' action="'+strScript+'">';strHtml+='<div id="form" class="tabla">';}var strHtmlBody="";var strHtmlHead="";var strHtmlFoot='<div id="Master" class="tabla">';if(bolUsaTabs==true){strHtmlBody+='<div id="tabs'+this.strNombre+'">';strHtmlBody+="<ul>";for(var ac=1;ac<=intfrm_numtabs;ac++){var bolFindTitle=false;for(i=0;i<_ctrlMKFoRM.length;i++){_objctrlMKFoRM=_ctrlMKFoRM[i];var iTabNum=_objctrlMKFoRM.getAttribute("frmd_TabNum");var strFrmTipo=_objctrlMKFoRM.getAttribute("frmd_tipo");var iOrden=_objctrlMKFoRM.getAttribute("frmd_orden");var strFrmTittle=_objctrlMKFoRM.getAttribute("frmd_titulo");if(iTabNum==ac){if(strFrmTipo=="label"&&iOrden==0){bolFindTitle=true;strHtmlBody+='<li><a href="#tabs'+this.strNombre+"-"+ac+'">'+strFrmTittle+"</a></li>";}}}if(!bolFindTitle){strHtmlBody+='<li><a href="#tabs'+this.strNombre+"-"+ac+'">tab '+ac+"</a></li>";}}strHtmlBody+="</ul>";}var strHtmlAyuda="";if(intfrm_tiene_ayuda_rapida==1){strHtmlAyuda=+"&nbsp<span class='help_fast1'><a href='javascript:ShowHelpFastSc("+intfrm_idMaster+")'>Ayuda <i class='fa fa-life-ring'></i></a></span> ";}var lstHtml=new Array();for(var ic=1;ic<=intfrm_numtabs;ic++){lstHtml[ic]="";if(bolUsaTabs==true){lstHtml[ic]+='<div id="tabs'+this.strNombre+"-"+ic+'">';lstHtml[ic]+='<div id="head'+ic+'"></div>';}else{strHtmlHead+='<div class="form_head" id="headMaster'+ic+'">'+strtitle+strHtmlAyuda+"</div>";}lstHtml[ic]+='<table class="tabla_form" border=0 align="center" cellpadding="0" cellspacing="0">';}if(bolUsaTabs==true){strHtmlHead+='<div class="form_head" id="headMaster'+ic+'">'+strtitle+strHtmlAyuda+" </div>";}strHtmlHead+='<table class="tabla_form" border=0 align="center" cellpadding="0" cellspacing="0">';var intContNvaFila=0;var intContClosFila=0;var intCeldas=0;var _intNumMaxFilas=0;for(var i=0;i<_ctrlMKFoRM.length;i++){var _objctrlMKFoRM=_ctrlMKFoRM[i];var bolPasaC=false;if(this.Oper==""){bolPasaC=true;}if(this.Oper=="_new"&&_objctrlMKFoRM.getAttribute("frmd_nuevo")==1){bolPasaC=true;}if(this.Oper=="_ed"&&_objctrlMKFoRM.getAttribute("frmd_modif")==1){bolPasaC=true;}if(this.Oper=="_importa"&&_objctrlMKFoRM.getAttribute("frmd_importa")==1){bolPasaC=true;}if(bolPasaC==true){if(_objctrlMKFoRM.getAttribute("frmd_cuantosagrupo")>_intNumMaxFilas){_intNumMaxFilas=_objctrlMKFoRM.getAttribute("frmd_cuantosagrupo");}}}for(var iF=-1;iF<lstHtml.length;iF++){for(i=0;i<_ctrlMKFoRM.length;i++){_objctrlMKFoRM=_ctrlMKFoRM[i];var iTabNumx=_objctrlMKFoRM.getAttribute("frmd_TabNum");if(iTabNumx==iF){var strHtmlTmp="";bolPasaC=false;if(this.Oper==""){bolPasaC=true;}if(this.Oper=="_new"&&_objctrlMKFoRM.getAttribute("frmd_nuevo")==1){bolPasaC=true;}if(this.Oper=="_ed"&&_objctrlMKFoRM.getAttribute("frmd_modif")==1){bolPasaC=true;}if(this.Oper=="_importa"&&_objctrlMKFoRM.getAttribute("frmd_importa")==1){bolPasaC=true;}if(bolPasaC==true){if(intContNvaFila==0){strHtmlTmp+="<tr>";intCeldas=0;}if(_objctrlMKFoRM.getAttribute("frmd_cuantosagrupo")!=0){intContClosFila=_objctrlMKFoRM.getAttribute("frmd_cuantosagrupo");intContNvaFila=9;}var intColspan=0;if(intContClosFila==0&&intCeldas<_intNumMaxFilas){intColspan=_intNumMaxFilas-(intCeldas)+1;}var strFrmNom=_objctrlMKFoRM.getAttribute("frmd_nombre");var strFrmTip=_objctrlMKFoRM.getAttribute("frmd_tipo");var strFrmTit=_objctrlMKFoRM.getAttribute("frmd_titulo");var strFrmVal=_objctrlMKFoRM.getAttribute("frmd_valor");var strFrmWidth=_objctrlMKFoRM.getAttribute("frmd_ancho");var strFrmAlign=_objctrlMKFoRM.getAttribute("frmd_align");var strFrmOblig=_objctrlMKFoRM.getAttribute("frmd_obligatorio");var strFrmJava=_objctrlMKFoRM.getAttribute("frmd_javascript");var strFrmRenglon=_objctrlMKFoRM.getAttribute("frmd_renglon");var strFrmDato=_objctrlMKFoRM.getAttribute("frmd_dato");var strFrmLength=_objctrlMKFoRM.getAttribute("frmd_maxlen");var strFrmIconalt=trim(_objctrlMKFoRM.getAttribute("frmd_iconalt"));var strFrmIconlink=trim(_objctrlMKFoRM.getAttribute("frmd_iconlink"));var strfrmd_oculto=_objctrlMKFoRM.getAttribute("frmd_oculto");var strfrmd_letras=_objctrlMKFoRM.getAttribute("frmd_letras");var strfrmd_mask=_objctrlMKFoRM.getAttribute("frmd_mask");var intOrden=_objctrlMKFoRM.getAttribute("frmd_orden");var intfrm_rowspan=_objctrlMKFoRM.getAttribute("frmd_rowspan");var intfrm_colspan=_objctrlMKFoRM.getAttribute("frmd_colspan");var intfrmd_nowrap=_objctrlMKFoRM.getAttribute("frmd_nowrap");var intfrmd_tabauto=_objctrlMKFoRM.getAttribute("frmd_tabauto");var intfrmd_readonly=_objctrlMKFoRM.getAttribute("frmd_readonly");var strfrmd_classdiv=_objctrlMKFoRM.getAttribute("frmd_classdiv");var strfrmd_classdivctrl=_objctrlMKFoRM.getAttribute("frmd_classdivctrl");
var strfrmd_classctrl=_objctrlMKFoRM.getAttribute("frmd_classctrl");var strfrmd_placeholder=_objctrlMKFoRM.getAttribute("frmd_placeholder");var strRowSpan="";var strNOWrap="";if(intfrm_rowspan!=0){strRowSpan=' rowspan="'+intfrm_rowspan+'" ';}if(intfrmd_nowrap==1){strNOWrap=" NOWRAP ";}if(intColspan>0&&intfrm_colspan==0){strHtmlTmp+='<td colspan="'+intColspan+'" '+strRowSpan+strNOWrap+' valign="top">';}else{if(intfrm_colspan>0){strHtmlTmp+='<td colspan="'+intfrm_colspan+'" '+strRowSpan+strNOWrap+' valign="top">';}else{strHtmlTmp+="<td "+strRowSpan+strNOWrap+' valign="top">';}}intCeldas++;if(strFrmVal=="[random]"){var iSup=0;for(var iNum=1;iNum<=strFrmWidth;iNum++){iSup+=1000;}strFrmVal=this.aleatorio(1,iSup);}var nomNext="";if(intfrmd_tabauto==1){nomNext=this.ObtenNomNext(i,_ctrlMKFoRM);}var isn=false;if(_objctrlMKFoRM.getAttribute("frmd_val_num")==1){isn=true;}if(strFrmTip=="text"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaTexto(strFrmTit,strFrmNom,strFrmVal,strFrmWidth,strFrmLength,isn,false,nomNext,strFrmAlign,strFrmOblig,strFrmIconalt,strFrmIconlink,strFrmJava,strfrmd_oculto,strfrmd_letras,intfrmd_readonly,strfrm_abrv,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl,strfrmd_placeholder);}if(strFrmTip=="num_per"){strNameForms+=strFrmNom+"1"+"|";strTypeForms+=strFrmTip+""+"|";strNameForms+=strFrmNom+"2"+"|";strTypeForms+=strFrmTip+""+"|";strHtmlTmp+=CreaTextoPeriod(strFrmTit,strFrmNom,strFrmVal,strFrmWidth,strFrmLength,isn,false,nomNext,strFrmAlign,strFrmOblig,strFrmIconalt,strFrmIconlink,strFrmJava,strfrmd_oculto,strfrmd_letras,intfrmd_readonly,strfrm_abrv,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl,strfrmd_placeholder);}if(strFrmTip=="date"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaDate(strFrmTit,strFrmNom,strFrmVal,nomNext,strFrmAlign,strFrmOblig,strFrmIconalt,strFrmIconlink,strFrmJava,strfrmd_oculto,intfrmd_readonly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="date_per"){strNameForms+=strFrmNom+"1"+"|";strTypeForms+=strFrmTip+""+"|";strNameForms+=strFrmNom+"2"+"|";strTypeForms+=strFrmTip+""+"|";strHtmlTmp+=CreaDatePeriod(strFrmTit,strFrmNom,strFrmVal,nomNext,strFrmAlign,strFrmOblig,strFrmIconalt,strFrmIconlink,strFrmJava,strfrmd_oculto,intfrmd_readonly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="password"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaTexto(strFrmTit,strFrmNom,strFrmVal,strFrmWidth,strFrmLength,isn,true,nomNext,strFrmAlign,strFrmOblig,strFrmIconalt,strFrmIconlink,strFrmJava,strfrmd_oculto,strfrmd_letras,intfrmd_readonly,strfrm_abrv,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl,strfrmd_placeholder);}if(strFrmTip=="label"){if(bolUsaTabs){if(intOrden!=0){strHtmlTmp+=CreaLabel(strFrmTit,strFrmNom,strFrmVal,strFrmAlign,strfrmd_oculto,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}}else{strHtmlTmp+=CreaLabel(strFrmTit,strFrmNom,strFrmVal,strFrmAlign,strfrmd_oculto,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}}if(strFrmTip=="hidden"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaHidden(strFrmNom,strFrmVal);}if(strFrmTip=="select"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";var elements=_objctrlMKFoRM.getElementsByTagName("element");strHtmlTmp+=CreaSelect(strFrmTit,strFrmNom,strFrmVal,elements,nomNext,strFrmAlign,strFrmOblig,true,strFrmDato,strFrmJava,strfrmd_oculto,strFrmIconalt,strFrmIconlink,intfrmd_readonly,strfrm_esreporte,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="radio"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaRadio(strFrmTit,strFrmNom,strFrmVal,strfrmd_oculto,strFrmJava,strFrmIconalt,strFrmIconlink,intfrmd_readonly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="checkbox"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaCheckBox(strFrmTit,strFrmNom,strFrmVal,strfrmd_oculto,strFrmJava,strFrmIconalt,strFrmIconlink,intfrmd_readonly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="htmledit"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaTextAreaHtml(strFrmTit,strFrmNom,strFrmVal,strFrmRenglon,strFrmWidth,nomNext,strFrmOblig,strfrmd_oculto,strfrmd_letras,intfrmd_readonly,strFrmIconalt,strFrmIconlink,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="PanelCheck"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";var elementsCheck=_objctrlMKFoRM.getElementsByTagName("element");strHtmlTmp+=CreaPanelCheck(strFrmTit,strFrmNom,strFrmVal,elementsCheck,true,strfrmd_oculto,strFrmJava,strFrmIconalt,strFrmIconlink,intfrmd_readonly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="PanelRadio"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";var elementsRadio=_objctrlMKFoRM.getElementsByTagName("element");strHtmlTmp+=CreaPanelRadio(strFrmTit,strFrmNom,strFrmVal,elementsRadio,strfrmd_oculto,strFrmJava,true,strFrmIconalt,strFrmIconlink,intfrmd_readonly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="textarea"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaTextArea(strFrmTit,strFrmNom,strFrmVal,strFrmRenglon,strFrmWidth,nomNext,strFrmOblig,strfrmd_oculto,strfrmd_letras,intfrmd_readonly,strFrmIconalt,strFrmIconlink,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="button"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaBoton(strFrmTit,strFrmNom,strFrmVal,strFrmJava,strFrmAlign,false,true,intfrmd_readonly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="file"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaFile(strFrmTit,strFrmNom,strFrmVal,nomNext,strFrmAlign,strFrmOblig,strFrmIconalt,strFrmIconlink,strFrmJava,strfrmd_oculto,intfrmd_readonly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="image"){strNameForms+=strFrmNom+"|";strTypeForms+=strFrmTip+"|";strHtmlTmp+=CreaImage(strFrmTit,strFrmNom,strFrmVal,nomNext,strFrmAlign,strFrmJava,strfrmd_oculto,strFrmWidth,strFrmRenglon,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="grid"){strHtmlTmp+=this.CreaGrid(strFrmTit,strFrmNom,strFrmVal,strFrmWidth,strFrmLength,nomNext,strFrmAlign,strFrmOblig,strFrmIconalt,strFrmIconlink,strFrmJava,strfrmd_oculto,strfrmd_letras,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}if(strFrmTip=="div"){strHtmlTmp+=CreaDiv(strFrmNom,strFrmVal,strFrmJava,strfrmd_oculto,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl);}strHtmlTmp+="</td>";if(intContClosFila==0){strHtmlTmp+="</tr>";intContNvaFila=0;}else{intContClosFila--;}if(iTabNumx==-1){strHtmlFoot+=strHtmlTmp;}else{if(iTabNumx==0){strHtmlHead+=strHtmlTmp;}lstHtml[iF]+=strHtmlTmp;}}}}}for(ic=1;ic<=intfrm_numtabs;ic++){lstHtml[ic]+="</table>";if(bolUsaTabs){lstHtml[ic]+="</div>";}}strHtmlHead+="</table></div>";strHtmlFoot+="</div>";strHtml+=strHtmlHead;for(ic=1;ic<=intfrm_numtabs;ic++){strHtmlBody+=lstHtml[ic];}if(bolUsaTabs==true){strHtmlBody+="</div>";}strHtml+=strHtmlBody;if(strHtmlFoot!='<div id="Master" class="tabla"></div>'){strHtml+=strHtmlFoot;}var strNomScreen="";if(objScreen!=null&&objScreen!="undefined"){strNomScreen=objScreen.opnOptAct;}if(this.withoutButtons==false){if(strScript==""){strHtml+=CreaBoton("","btn1",strTitleButton,"javascript:"+strjavascript+"","center",false,true,false,false);}else{strHtml+=CreaBoton("","btn1",strTitleButton,"EnviaForm('form1','"+strScript+"','"+strNameForms+"','"+strTypeForms+"','','"+strNomScreen+"')","center",false,true,false,false);}var strTitleButton2="CANCELAR";if(this.dialog!=null&&this.dialog!="undefined"){strHtml+=CreaBoton("","btn2",strTitleButton2,"javascript:"+strfrm_scriptCancel+";$('#"+this.dialog+"').dialog('close');","center");}}if(strfrm_esreporte==1){strHtml+="<table border=0 class='tabla_form' width='100%'>";
strHtml+="<tr>";strHtml+="<td><a href=\"javascript:EnviaForm('form1','"+strScript+"','"+strNameForms+"','"+strTypeForms+"','HTML','"+strNomScreen+'\')"><img src="images/layout/repo_html.png" alt="PANTALLA" border="0"></a>&nbsp;</td>';strHtml+="<td><a href=\"javascript:EnviaForm('form1','"+strScript+"','"+strNameForms+"','"+strTypeForms+"','XLS','"+strNomScreen+'\')"><img src="images/layout/repo_xls.png" alt="EXCEL" border="0"></a>&nbsp;</td>';strHtml+="<td><a href=\"javascript:EnviaForm('form1','"+strScript+"','"+strNameForms+"','"+strTypeForms+"','PDF','"+strNomScreen+'\')"><img src="images/layout/repo_pdf.png" alt="PDF" border="0"></a>&nbsp;</td>';strHtml+="<td><a href=\"javascript:EnviaForm('form1','"+strScript+"','"+strNameForms+"','"+strTypeForms+"','MAIL','"+strNomScreen+'\')"><img src="images/layout/repo_mail.png" alt="MAIL" border="0"></a>&nbsp;</td>';strHtml+="</tr>";strHtml+="</table>";}strHtml+="</form>";strHtml+="<br>";strHtml+="</div>";if(this.dialog!=null&&this.dialog!="undefined"){document.getElementById(this.dialog+"_inside").innerHTML=strHtml;$("#"+this.dialog).dialog("option","title",strtitle);$("#"+this.dialog).dialog("open");}else{objDiv.innerHTML=strHtml;}idxSelRows=0;lstselRows=[];lstselRows.length=0;for(i=0;i<_ctrlMKFoRM.length;i++){_objctrlMKFoRM=_ctrlMKFoRM[i];bolPasaC=false;if(this.Oper==""){bolPasaC=true;}if(this.Oper=="_new"&&_objctrlMKFoRM.getAttribute("frmd_nuevo")==1){bolPasaC=true;}if(this.Oper=="_ed"&&_objctrlMKFoRM.getAttribute("frmd_modif")==1){bolPasaC=true;}if(this.Oper=="_importa"&&_objctrlMKFoRM.getAttribute("frmd_importa")==1){bolPasaC=true;}if(bolPasaC==true){if(_objctrlMKFoRM.getAttribute("frmd_tipo")=="date"){$("#"+_objctrlMKFoRM.getAttribute("frmd_nombre")).datepicker({changeMonth:true,changeYear:true});}if(_objctrlMKFoRM.getAttribute("frmd_tipo")=="date_per"){$("#"+_objctrlMKFoRM.getAttribute("frmd_nombre")+"1").datepicker({changeMonth:true,changeYear:true});$("#"+_objctrlMKFoRM.getAttribute("frmd_nombre")+"2").datepicker({changeMonth:true,changeYear:true});}if(_objctrlMKFoRM.getAttribute("frmd_mask")!=""){$("#"+_objctrlMKFoRM.getAttribute("frmd_nombre")).mask(_objctrlMKFoRM.getAttribute("frmd_mask"));}if(_objctrlMKFoRM.getAttribute("frmd_tipo")=="htmledit"){$("."+_objctrlMKFoRM.getAttribute("frmd_nombre")).jqte();}if(_objctrlMKFoRM.getAttribute("frmd_autocomplete")==1){if(_objctrlMKFoRM.getAttribute("frmd_autoValor")!=""){var strAutoValor=_objctrlMKFoRM.getAttribute("frmd_autoValor");var strFunction=new Function("event","ui","{"+"document.getElementById('"+strAutoValor+"').value = ui.item.id;"+"}");$("#"+_objctrlMKFoRM.getAttribute("frmd_nombre")).autocomplete({source:_objctrlMKFoRM.getAttribute("frmd_autoURL"),minLength:2,select:strFunction});}else{$("#"+_objctrlMKFoRM.getAttribute("frmd_nombre")).autocomplete({source:_objctrlMKFoRM.getAttribute("frmd_autoURL"),minLength:2});}}if(_objctrlMKFoRM.getAttribute("frmd_esgrid")==1&&_objctrlMKFoRM.getAttribute("frmd_gridid")!=0){this.StartGrid(_objctrlMKFoRM,_objctrlMKFoRM.getAttribute("frmd_nombre"));}}}if(bolUsaTabs==true){$("#tabs"+this.strNombre+"").tabs({show:{effect:"clip",duration:800}});if(strfrm_onTabShow!=""){var _onTabShow=new Function("event","ui",strfrm_onTabShow);$("#tabs"+this.strNombre+"").bind("tabsshow",_onTabShow);}if(strfrm_onTabClick!=""){var _onTabClick=new Function("event","ui",strfrm_onTabClick);$("#tabs"+this.strNombre+"").bind("tabsactivate",_onTabClick);}if(strfrm_onTabHide!=""){var _onTabHide=new Function("event","ui",strfrm_onTabHide);$("#tabs"+this.strNombre+"").bind("tabsload",_onTabHide);}}if(strfrm_scriptBegin!=""){var scriptInicial=new Function(strfrm_scriptBegin);scriptInicial();}if(this.dialog!=null){$("#"+this.dialog).dialog("open");}if(intfrm_focusauto==1){for(i=0;i<_ctrlMKFoRM.length;i++){_objctrlMKFoRM=_ctrlMKFoRM[i];bolPasaC=false;if(this.Oper==""){bolPasaC=true;}if(this.Oper=="_new"&&_objctrlMKFoRM.getAttribute("frmd_nuevo")==1){bolPasaC=true;}if(this.Oper=="_ed"&&_objctrlMKFoRM.getAttribute("frmd_modif")==1){bolPasaC=true;}if(this.Oper=="_importa"&&_objctrlMKFoRM.getAttribute("frmd_importa")==1){bolPasaC=true;}if(bolPasaC==true){if(_objctrlMKFoRM.getAttribute("frmd_tipo")!="hidden"&&_objctrlMKFoRM.getAttribute("frmd_oculto")!=1&&_objctrlMKFoRM.getAttribute("frmd_tipo")!="label"&&_objctrlMKFoRM.getAttribute("frmd_tipo")!="grid"&&_objctrlMKFoRM.getAttribute("frmd_TabNum")<=1){if(_objctrlMKFoRM.getAttribute("frmd_tipo")=="date_per"||_objctrlMKFoRM.getAttribute("frmd_tipo")=="num_per"){setTimeout("FocoInicial('"+_objctrlMKFoRM.getAttribute("frmd_nombre")+"1')",1000);}else{setTimeout("FocoInicial('"+_objctrlMKFoRM.getAttribute("frmd_nombre")+"')",1000);}break;}}}}if(this.bolgetData){if(objScreen!=null&&objScreen!="undefined"){if(objScreen.getDataAuto){objScreen.OpnFillRowData(objScreen.idOperAct);}}}}catch(err){var txt="There was an error when try to draw form.\n\n";txt+="Error description: "+err+" \n\n";txt+="Click OK to continue.\n\n";alert(txt);}}else{alert("Error al consultar la opcion");}};this.CreaGrid=function CreaGrid(label,name,value,size,length,nameNext,align,oblig,iconAlt,iconLink,script,oculto,mayusc,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";var strOblig="";var strIconImg="";if(length>0){strOpt+=" maxlength='"+length+"' ";}if(oblig==1){strOblig="<label class='oblig'>*</label>";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'"> '+strIconImg+"</a>";}strOpt+=script;var strOculto="";if(oculto==1){strOculto='style="display:none"';}var strHTMLGrid="<table id='"+name+"' class='scroll'  ></table>"+"<div id='pager"+name+"' class='scroll' cellpadding='0' cellspacing='0' style='text-align:center;height:10%;'>&nbsp;</div>"+"<div id='menu"+name+"'></div>";var strHTML="<div class='form_field' "+strOculto+"><div align='"+align+"'><strong>"+label+"</strong>&nbsp;</div><div>"+strHTMLGrid+strOblig+strIconImg+'</div><div id="err_'+name+'" ></div></div>';return strHTML;};this.StartGrid=function StartGrid(objGrid,strName){var ContainerGrid=objGrid.getElementsByTagName("formGrid")[0];var formGrid=ContainerGrid.getElementsByTagName("form")[0];var strtitle=formGrid.getAttribute("frm_title");var strfrm_urlgrid=formGrid.getAttribute("frm_urlgrid");var strfrm_orden=formGrid.getAttribute("frm_orden");var strfrm_tipoorden=formGrid.getAttribute("frm_tipoorden");var intfrm_gridscroll=formGrid.getAttribute("frm_gridscroll");var strfrm_scriptdblClickGrid=formGrid.getAttribute("frm_scriptdblClickGrid");var strfrm_abrv=formGrid.getAttribute("frm_abrv");var strfrm_urlNew=formGrid.getAttribute("frm_urlNew");var strfrm_urlEd=formGrid.getAttribute("frm_urlEd");var strfrm_urlDel=formGrid.getAttribute("frm_urlDel");var strfrm_ongridSelRow=formGrid.getAttribute("frm_ongridSelRow");var strfrm_ongridafterInsertRow=formGrid.getAttribute("frm_ongridafterInsertRow");var strfrm_ongridComplete=formGrid.getAttribute("frm_ongridComplete");var strfrm_ongridloadError=formGrid.getAttribute("frm_ongridloadError");var strfrm_ongridRightClickRow=formGrid.getAttribute("frm_ongridRightClickRow");var strfrm_ongridSelectAll=formGrid.getAttribute("frm_ongridSelectAll");var strfrm_ongridSortCol=formGrid.getAttribute("frm_ongridSortCol");var intfrm_gridEdit=formGrid.getAttribute("frm_gridEdit");var intfrm_gridrows=formGrid.getAttribute("frm_gridrows");var intfrm_multikey=formGrid.getAttribute("frm_multikey");var intfrm_grid_width=formGrid.getAttribute("frm_grid_width");var intfrm_grid_height=formGrid.getAttribute("frm_grid_height");var bolMultiKey=false;if(intfrm_multikey==1){bolMultiKey=true;}var _fdblClick=null;if(strfrm_scriptdblClickGrid.length>0){_fdblClick=new Function("id",strfrm_scriptdblClickGrid);}idxSelRows++;lstselRows[idxSelRows]=0;var formdeta=formGrid.getElementsByTagName("formdeta");var arrcolNames=new Array();var arrcolModel=new Array();var intNames=-1;for(var i=0;i<formdeta.length;i++){var obj=formdeta[i];var frmd_ongridblur=obj.getAttribute("frmd_ongridblur");
var frmd_ongridfocus=obj.getAttribute("frmd_ongridfocus");var frmd_ongridkeypress=obj.getAttribute("frmd_ongridkeypress");var frmd_ongridkeydown=obj.getAttribute("frmd_ongridkeydown");var frmd_ongridchange=obj.getAttribute("frmd_ongridchange");var frmd_ongridclick=obj.getAttribute("frmd_ongridclick");var frmd_dataInit=obj.getAttribute("frmd_dataInit");var strGridNombre=obj.getAttribute("frmd_nombre");var frmd_options=obj.getAttribute("frmd_options");var frmd_edit_url=obj.getAttribute("frmd_edit_url");var strFrmTip=obj.getAttribute("frmd_tipo");var strFrmd_grid_decimal_places=obj.getAttribute("frmd_grid_decimal_places");var strFrmd_grid_formatter=obj.getAttribute("frmd_grid_formatter");var strFrmd_grid_unformat=obj.getAttribute("frmd_grid_unformat");if(obj.getAttribute("frmd_consulta")=="1"){var intfrmd_search=obj.getAttribute("frmd_search");var bolfrm_gridEdit=false;if(intfrm_gridEdit==1){bolfrm_gridEdit=true;}var bolHidden=false;intNames++;arrcolNames[intNames]=obj.getAttribute("frmd_titulo");if(obj.getAttribute("frmd_tipo")=="hidden"){bolHidden=true;}var dblAncho=obj.getAttribute("frmd_ancho");if(dblAncho==0){dblAncho=40;}var bolesEdit=false;if(obj.getAttribute("frmd_IsEditGrid")==1){bolesEdit=true;}var strFormat=null;var strAlign="left";var strstype="text";var strLst=":SELECCIONE;";var bolsearch=false;var bolDecimalPlaces=false;if(intfrmd_search==1){bolsearch=true;}if(obj.getAttribute("frmd_val_num")==1&&obj.getAttribute("frmd_dato")=="double"){strFormat="number";strAlign="right";if(strFrmd_grid_decimal_places!=0){bolDecimalPlaces=true;}dblAncho=dblAncho*3;}else{dblAncho=dblAncho*2;}if(obj.getAttribute("frmd_tipo")=="select"||obj.getAttribute("frmd_tipo")=="radio"||obj.getAttribute("frmd_tipo")=="PanelRadio"){strstype="select";if(obj.getAttribute("frmd_tipo")=="select"){var elements=obj.getElementsByTagName("element");for(var k=0;k<elements.length;k++){var obj2=elements[k];var strPComa="";if(k+1<elements.length){strPComa=";";}strLst+=obj2.getAttribute("send")+":"+obj2.getAttribute("show")+strPComa;}}else{if(obj.getAttribute("frmd_tipo")=="PanelRadio"){var elements=obj.getElementsByTagName("element");for(var k=0;k<elements.length;k++){var obj2=elements[k];var strPComa="";if(k+1<elements.length){strPComa=";";}strLst+=obj2.getAttribute("send")+":"+obj2.getAttribute("show")+strPComa;}}else{strLst="999:SELECCIONE;0:N0;1:SI";}}}var _fongridblur=null;var _fongridfocus=null;var _fongridkeypress=null;var _fongridkeydown=null;var _fongridchange=null;var _fongridclick=null;var _fdataInit=null;var frmd_ongridkeypressAuto="";if(frmd_ongridblur!=""){_fongridblur=new Function("e",frmd_ongridblur);}else{_fongridblur=new Function("");}if(frmd_ongridfocus!=""){_fongridfocus=new Function("e",frmd_ongridfocus);}else{_fongridfocus=new Function("");}if(frmd_ongridkeypress!=""){_fongridkeypress=new Function("e",frmd_ongridkeypress);}else{var strNomNext="";for(var y=i+1;y<formdeta.length;y++){var obj2=formdeta[y];if(obj2.getAttribute("frmd_consulta")=="1"&&obj2.getAttribute("frmd_IsEditGrid")==1&&obj2.getAttribute("frmd_tipo")!="grid"){strNomNext=formdeta[y].getAttribute("frmd_nombre");break;}}if(strNomNext!=""){frmd_ongridkeypressAuto="if(e.originalEvent.keyCode == 13){document.getElementById(lstselRows["+idxSelRows+'] + "_'+strNomNext+'").focus();document.getElementById(lstselRows['+idxSelRows+'] + "_'+strNomNext+'").select();}';_fongridkeypress=new Function("e",frmd_ongridkeypressAuto);}else{_fongridkeypress=new Function("e","");}}if(frmd_ongridkeydown!=""){_fongridkeydown=new Function("e",frmd_ongridkeydown);}else{_fongridkeydown=new Function("");}if(frmd_ongridchange!=""){_fongridchange=new Function("e",frmd_ongridchange);}else{_fongridchange=new Function("");}if(frmd_ongridclick!=""){_fongridclick=new Function("e",frmd_ongridclick);}else{_fongridclick=new Function("");}if(frmd_dataInit!=""){_fdataInit=new Function("elem",frmd_dataInit);}else{_fdataInit=new Function("");}if(strFormat==null){arrcolModel[intNames]={name:strGridNombre,index:strGridNombre,width:dblAncho,editable:bolesEdit,sortable:bolsearch,search:bolsearch,edittype:strFrmTip,hidden:bolHidden,align:strAlign,searchoptions:{value:strLst},stype:strstype,editoptions:{dataInit:_fdataInit,dataEvents:[{type:"blur",data:{i:7},fn:_fongridblur},{type:"focus",data:{i:7},fn:_fongridfocus},{type:"keypress",fn:_fongridkeypress},{type:"keydown",fn:_fongridkeydown},{type:"change",data:{i:7},fn:_fongridchange},{type:"click",data:{i:7},fn:_fongridclick}]}};}else{arrcolModel[intNames]={name:strGridNombre,index:strGridNombre,width:dblAncho,editable:bolesEdit,sortable:bolsearch,search:bolsearch,edittype:strFrmTip,formatter:strFormat,hidden:bolHidden,align:strAlign,searchoptions:{value:strLst},stype:strstype,editoptions:{dataInit:_fdataInit,dataEvents:[{type:"blur",data:{i:7},fn:_fongridblur},{type:"focus",data:{i:7},fn:_fongridfocus},{type:"keypress",fn:_fongridkeypress},{type:"keydown",fn:_fongridkeydown},{type:"change",data:{i:7},fn:_fongridchange},{type:"click",data:{i:7},fn:_fongridclick}]}};if(bolDecimalPlaces){var intNumDecimalPlaces=parseInt(strFrmd_grid_decimal_places);arrcolModel[intNames].formatoptions={decimalPlaces:intNumDecimalPlaces};}if(strFrmd_grid_formatter!=""){arrcolModel[intNames].formatter=""+strFrmd_grid_formatter+"";}if(strFrmd_grid_unformat!=""){arrcolModel[intNames].unformat=strFrmd_grid_unformat;}}if(bolfrm_gridEdit){if(arrcolModel[intNames].edittype=="checkbox"){arrcolModel[intNames].editoptions={value:frmd_options,dataInit:_fdataInit,dataEvents:[{type:"blur",data:{i:7},fn:_fongridblur},{type:"focus",data:{i:7},fn:_fongridfocus},{type:"keypress",fn:_fongridkeypress},{type:"keydown",fn:_fongridkeydown},{type:"change",data:{i:7},fn:_fongridchange},{type:"click",data:{i:7},fn:_fongridclick}]};}if(arrcolModel[intNames].edittype=="select"){if(frmd_edit_url!=""){arrcolModel[intNames].editoptions={dataUrl:frmd_edit_url,dataInit:_fdataInit,dataEvents:[{type:"blur",data:{i:7},fn:_fongridblur},{type:"focus",data:{i:7},fn:_fongridfocus},{type:"keypress",fn:_fongridkeypress},{type:"keydown",fn:_fongridkeydown},{type:"change",data:{i:7},fn:_fongridchange},{type:"click",data:{i:7},fn:_fongridclick}]};}else{if(frmd_options!=""){arrcolModel[intNames].editoptions={value:frmd_options,dataInit:_fdataInit,dataEvents:[{type:"blur",data:{i:7},fn:_fongridblur},{type:"focus",data:{i:7},fn:_fongridfocus},{type:"keypress",fn:_fongridkeypress},{type:"keydown",fn:_fongridkeydown},{type:"change",data:{i:7},fn:_fongridchange},{type:"click",data:{i:7},fn:_fongridclick}]};}else{arrcolModel[intNames].editoptions={value:strLst,dataInit:_fdataInit,dataEvents:[{type:"blur",data:{i:7},fn:_fongridblur},{type:"focus",data:{i:7},fn:_fongridfocus},{type:"keypress",fn:_fongridkeypress},{type:"keydown",fn:_fongridkeydown},{type:"change",data:{i:7},fn:_fongridchange},{type:"click",data:{i:7},fn:_fongridclick}]};}}}}}}_DefineGrid(bolfrm_gridEdit,strName,strfrm_urlgrid,strfrm_abrv,intfrm_gridscroll,arrcolNames,arrcolModel,strfrm_orden,strfrm_tipoorden,strtitle,_fdblClick,strfrm_ongridSelRow,strfrm_ongridafterInsertRow,strfrm_ongridComplete,strfrm_ongridloadError,strfrm_ongridRightClickRow,strfrm_ongridSelectAll,strfrm_ongridSortCol,idxSelRows,intfrm_gridrows,bolMultiKey,intfrm_grid_width,intfrm_grid_height);var strTemplate="<button class='fg-button ui-state-default ui-state-disabled ui-corner-all' type='button' id='[01]' onClick='[02]' [03]>[04]</button>";var strTemplate2="<button class='fg-button ui-state-default ui-priority-primary ui-corner-all' type='button' id='[01]' onClick='[02]' [03]>[04]</button>";var strHtmlMenu="<table><tr>";if(strfrm_urlNew!=""){strHtmlMenu+="<td>"+strTemplate2.replace("[01]","New"+strName).replace("[02]",strfrm_urlNew).replace("[03]","").replace("[04]","<img src='images/layout/Itplus1.gif' border='0'><font size=-2>Nuevo</font>")+"</td>";}if(strfrm_urlDel!=""){strHtmlMenu+="<td>"+strTemplate2.replace("[01]","Del"+strName).replace("[02]",strfrm_urlDel).replace("[03]","").replace("[04]","<img src='images/layout/Itdel1.gif' border='0'><font size=-2>Borrar</font>")+"</td>";
}var Menu=formGrid.getElementsByTagName("Menudeta");if(Menu!=null){for(i=0;i<Menu.length;i++){obj2=Menu[i];var Mtitle=obj2.getAttribute("frmn_titulo");var Mlink=obj2.getAttribute("frmn_link");var Micon=obj2.getAttribute("frmn_icon");var Midtitle=obj2.getAttribute("frmn_idtitle");var Menabled=obj2.getAttribute("fmrn_enabled");if(Mtitle==""&&Micon==""){strHtmlMenu+="<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>";}else{if(Menabled==1){strHtmlMenu+="<td>"+strTemplate2.replace("[01]",Midtitle).replace("[02]",Mlink).replace("[03]","").replace("[04]",(Micon==""?"":"<img src='"+Micon+"' border='0'>")+(Mtitle==""?"":"<font size=-2>"+Mtitle+"</font>"))+"</td>";}else{strHtmlMenu+="<td>"+strTemplate.replace("[01]",Midtitle).replace("[02]",Mlink).replace("[03]"," disabled ").replace("[04]",(Micon==""?"":"<img src='"+Micon+"' border='0'>")+(Mtitle==""?"":"<font size=-2>"+Mtitle+"</font>"))+"</td>";}}}}strHtmlMenu+="</tr></table>";document.getElementById("menu"+strName).innerHTML=strHtmlMenu;};}function FocoInicial(strName){try{document.getElementById(strName).focus();}catch(err){var txt="There was an error when try to set focus on  control "+strName+".\n\n";txt+="Error description: "+err.description+" \n\n";txt+="Click OK to continue.\n\n";alert(txt);}}function Seloptions(Etiqueta,Valor,Valor2,Valor3){this.Etiqueta=Etiqueta;this.Valor=Valor;this.Valor2=Valor2;this.Valor3=Valor3;}function ProcesaError(data,ioArgs){alert("Hubo un error"+ioArgs.args+" "+data);return"Error when retrieving data from the server!";}function CreaLabel(label,name,value,align,oculto){var strOculto="";if(oculto==1){strOculto='style="display:none"';}return"<div class='form_field' "+strOculto+"><div id='"+name+"' align='"+align+"'><strong>"+label+"</strong>&nbsp;</div><div>"+value+"</div></div>";}function CreaTexto(label,name,value,size,length,isnumeric,isPassword,nameNext,align,oblig,iconAlt,iconLink,script,oculto,mayusc,ReadOnly,strfrm_abrv,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl,strfrmd_placeholder){var strOpt="";var strTipo="text";var strOblig="";var strIconImg="";var strSoloNumBlur="";if(isPassword){strTipo="Password";}if(length>0){strOpt+=" maxlength='"+length+"' ";}if(oblig==1){strOblig="<label class='oblig'>*</label>";}if(isnumeric==true){strOpt+=" onkeypress=\"return solonumero(event,'"+nameNext+"');\" ";strSoloNumBlur=",1";}if(nameNext!=""&&isnumeric==false){strOpt+=" onkeypress=\"javascript:Ch_Fi(event,'"+nameNext+"',true);\"";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0' id='img_"+name+"'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'">'+strIconImg+"</a>";}strOpt+=script;var strOculto="";if(oculto==1){strOculto='style="display:none"';}if(strfrmd_placeholder==null){strfrmd_placeholder="";}return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"' "+strOculto+"><div align='"+align+"'><strong>"+label+"</strong>"+strOblig+"</div><div align='"+align+"'><input type=\""+strTipo+'" name="'+name+'" id="'+name+'" value="'+value+'" placeholder="'+strfrmd_placeholder+'" size="'+size+'" '+strOpt+" "+((ReadOnly==1)?' readonly class="READONLY" ':' class="outEdit" onFocus="PonFoco(this)" onBlur="QuitaFoco(this,\''+mayusc+"'"+strSoloNumBlur+')" onkeyup="_OnKeyUpValidate(this,\''+strfrm_abrv+"');\"")+" />"+strIconImg+'</div><div id="err_'+name+'" ></div></div>';}function CreaTextoPeriod(label,name,value,size,length,isnumeric,isPassword,nameNext,align,oblig,iconAlt,iconLink,script,oculto,mayusc,ReadOnly,strfrm_abrv,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl,strfrmd_placeholder){var strOpt="";var strTipo="text";var strOblig="";var strIconImg="";if(isPassword){strTipo="Password";}if(length>0){strOpt+=" maxlength='"+length+"' ";}if(oblig==1){strOblig="<label class='oblig'>*</label>";}if(isnumeric==true){strOpt+=" onkeypress=\"return solonumero(event,'"+nameNext+"');\" ";}var strNext1="";var strNext2="";if(isnumeric==false){if(nameNext!=""){strNext1=" onkeypress=\"javascript:Ch_Fi(event,'"+name+"2');\" ";strNext2="";if(nameNext!=""){strNext2=" onkeypress=\"javascript:Ch_Fi(event,'"+nameNext+"');\" ";}}}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'">'+strIconImg+"</a>";}strOpt+=script;var strOculto="";if(oculto==1){strOculto='style="display:none"';}return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"' "+strOculto+"><div align='"+align+"'><strong>"+label+"</strong>&nbsp;</div><div align='"+align+"'>"+'<input type="'+strTipo+'" name="'+name+'1" id="'+name+'1" value="'+value+'" size="'+size+'" '+strOpt+strNext1+" "+((ReadOnly==1)?' readonly class="READONLY" ':' class="outEdit" onFocus="PonFoco(this)" onBlur="QuitaFoco(this,\''+mayusc+"')\" ")+" />&nbsp; . . ."+'<input type="'+strTipo+'" name="'+name+'2" id="'+name+'2" value="'+value+'" size="'+size+'" '+strOpt+strNext2+" "+((ReadOnly==1)?' readonly class="READONLY" ':' class="outEdit" onFocus="PonFoco(this)" onBlur="QuitaFoco(this,\''+mayusc+"')\" ")+" />"+strOblig+strIconImg+'</div><div id="err_'+name+'" ></div></div>';}function CreaDate(label,name,value,nameNext,align,oblig,iconAlt,iconLink,script,oculto,ReadOnly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";var strTipo="text";var strOblig="";var strIconImg="";if(oblig==1){strOblig="<label class='oblig'>*</label>";}if(nameNext!=""){strOpt=" onkeypress=\"javascript:Ch_Fi(event,'"+nameNext+"');\"";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'"> '+strIconImg+"</a>";}strOpt+=script;var strOculto="";if(oculto==1){strOculto='style="display:none"';}return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"' "+strOculto+"><div align='"+align+"'><strong>"+label+'</strong>&nbsp;</div><div><input type="'+strTipo+'" name="'+name+'" id="'+name+'" value="'+value+'" '+strOpt+" "+" "+((ReadOnly==1)?' readonly class="READONLY" ':' class="outEdit"  ')+" "+"/>"+strOblig+strIconImg+'</div><div id="err_'+name+'" ></div></div>';}function CreaDatePeriod(label,name,value,nameNext,align,oblig,iconAlt,iconLink,script,oculto,ReadOnly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";var strTipo="text";var strOblig="";var strIconImg="";if(oblig==1){strOblig="<label class='oblig'>*</label>";}var strNext1=" onkeypress=\"javascript:Ch_Fi(event,'"+name+"2');\" ";var strNext2="";if(nameNext!=""){strNext2=" onkeypress=\"javascript:Ch_Fi(event,'"+nameNext+"');\" ";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'"> '+strIconImg+"</a>";}strOpt+=script;var strOculto="";var value1=value;if(trim(value)!=""){value1="01"+value.substring(2);}if(oculto==1){strOculto='style="display:none"';}return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"' "+strOculto+"><div align='"+align+"'><strong>"+label+"</strong>&nbsp;</div><div>"+'<input type="'+strTipo+'" name="'+name+'1" id="'+name+'1" value="'+value1+'" '+strOpt+strNext1+" "+((ReadOnly==1)?' readonly class="READONLY" ':' class="outEdit"  ')+" />"+'&nbsp;. . . <input type="'+strTipo+'" name="'+name+'2" id="'+name+'2" value="'+value+'" '+strOpt+strNext2+" "+((ReadOnly==1)?' readonly class="READONLY" ':' class="outEdit" ')+"  />"+strOblig+strIconImg+'</div><div id="err_'+name+'" ></div></div>';}function CreaTextArea(label,name,value,rows,cols,nameNext,oblig,oculto,mayusc,ReadOnly,iconAlt,iconLink,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";var strOculto="";var strIconImg="";if(oculto==1){strOculto='style="display:none"';}if(nameNext!=""){strOpt=" onkeypress=\"javascript:Ch_Fi(event,'"+nameNext+"');\"";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'">'+strIconImg+"</a>";}return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"' "+strOculto+"><div><strong>"+label+'</strong>&nbsp;</div><div><textarea name="'+name+'" id="'+name+'" cols="'+cols+'" rows ="'+rows+'" '+strOpt+ +" "+((ReadOnly==1)?' readonly class="READONLY" ':' class="outEdit" onFocus="PonFoco(this)" onBlur="QuitaFoco(this,\''+mayusc+"')\" ")+" />"+value+"</textarea></div>"+strIconImg+'<div id="err_'+name+'" ></div></div>';
}function CreaTextAreaHtml(label,name,value,rows,cols,nameNext,oblig,oculto,mayusc,ReadOnly,iconAlt,iconLink,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";var strOculto="";var strIconImg="";if(oculto==1){strOculto='style="display:none"';}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'">'+strIconImg+"</a>";}return"<div><div><strong>"+label+'</strong>&nbsp;</div><div><textarea name="'+name+'" id="'+name+'" class="'+name+'" style="height:300px;width:600px;"   >'+value+"</textarea></div>"+strIconImg+'<div id="err_'+name+'" ></div></div>';}function CreaHidden(name,value){var strTipo="hidden";return'<input type="'+strTipo+'" name="'+name+'" id="'+name+'" value="'+value+'" />';}function CreaVacio(label,name,NomEstilo,ValorHtml){if(ValorHtml==null){ValorHtml="";}return"<div class='"+NomEstilo+"'><div><strong>"+label+"</strong>&nbsp;</div><div id='"+name+"' >&nbsp;"+ValorHtml+"</div></div>";}function CreaSelect(label,name,value,elements,nameNext,align,oblig,esXML,tipoDato,script,oculto,iconAlt,iconLink,ReadOnly,strfm_esreporte,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";if(nameNext!=""){strOpt=" onkeypress=\"javascript:Ch_Fi(event,'"+nameNext+"');\"";}var strOblig="";if(oblig==1){strOblig="<label class='oblig'>*</label>";}strOpt+=script;var strIconImg="";if(iconAlt==undefined){iconAlt="";}if(iconLink==undefined){iconLink="";}if((iconAlt)!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if((iconLink)!=""){strIconImg='<a href="javascript:'+iconLink+'">'+strIconImg+"</a>";}var strOculto="";if(oculto==1){strOculto='style="display:none"';}var strControl="<select name='"+name+"' id='"+name+"' "+strOpt+ +" "+((ReadOnly==1)?' onmouseover="this.disabled=true;" onmouseleave="this.disabled=false;" onmouseout="this.disabled=false;" class="READONLY" ':' class="outEdit" onFocus="PonFoco(this)" onBlur="QuitaFoco(this)" ')+">";var strTitSel="Seleccione";if(strfm_esreporte==1){strTitSel="Todos";}if(tipoDato=="text"||tipoDato=="double"){strControl+="<option value=''>"+strTitSel+"</option>";}else{strControl+="<option value='0'>"+strTitSel+"</option>";}if(elements!=null){var strSel="";}if(!esXML){for(var i=0;i<elements.length;i++){strSel="";if(value==elements[i].Valor){strSel=" selected ";}strControl+="<option value='"+elements[i].Valor+"' "+strSel+">"+elements[i].Etiqueta+"</option>";}}else{for(var i=0;i<elements.length;i++){var obj=elements[i];strSel="";if(value==obj.getAttribute("send")){strSel=" selected ";}strControl+="<option value='"+obj.getAttribute("send")+"' "+strSel+">"+obj.getAttribute("show")+"</option>";}}strControl+="</select>";return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"' "+strOculto+"><div><strong>"+label+"</strong>&nbsp;"+strOblig+strIconImg+"</div><div>"+strControl+'</div><div id="err_'+name+'" ></div></div>';}function CreaBoton(label,name,value,nomFunction,align,esSubmit,bolUsForm,ReadOnly,isDisabledAuto,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";var strControl="";var strTipo="button";if(esSubmit){strTipo="submit";}if(isDisabledAuto==undefined||isDisabledAuto==null){isDisabledAuto=false;}if(isDisabledAuto){if(nomFunction!=""){strOpt=' onClick="this.disabled=true;'+nomFunction+'" ';}else{strOpt=' onClick="this.disabled=true" ';}}else{if(nomFunction!=""){strOpt=' onClick="'+nomFunction+'" ';}}if(bolUsForm==undefined||bolUsForm==null){bolUsForm=true;}if(bolUsForm){if(label==""){strControl='<div class="'+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"\"><div align='"+align+"'><input type=\""+strTipo+'" name="'+name+'" class="boton" id="'+name+'" value="'+value+'"  '+strOpt+" "+((ReadOnly==1)?' readonly class="READONLYBUTTON" ':" ")+"/></div></div>";}else{strControl='<div class="'+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"\"><div align='"+align+"'><strong>"+label+'</strong>&nbsp;</div><div><input type="'+strTipo+'" name="'+name+'" class="boton" id="'+name+'" value="'+value+'"  '+strOpt+" "+((ReadOnly==1)?' readonly class="READONLYBUTTON" ':" ")+"/></div></div>";}}else{if(label==""){strControl='<button type="'+strTipo+'" name="'+name+'" class="boton" id="'+name+'" value="'+value+'" '+strOpt+" "+((ReadOnly==1)?' readonly class="READONLYBUTTON" ':" ")+">"+value+"</button>";}else{strControl="<strong>"+label+'</strong>&nbsp;</div><div><button type="'+strTipo+'" name="'+name+'" class="boton" id="'+name+'" value="'+value+'" '+strOpt+" "+((ReadOnly==1)?' readonly class="READONLYBUTTON" ':" ")+">"+value+"</button>";}}return strControl;}function CreaRadio(label,name,value,oculto,strJavascript,iconAlt,iconLink,ReadOnly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt1="";var strOpt2="";var strOculto="";if(oculto==1){strOculto='style="display:none"';}if(value==1){strOpt1=" checked ";}if(value==0){strOpt2=" checked ";}var strIconImg="";if(iconAlt==undefined){iconAlt="";}if(iconLink==undefined){iconLink="";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'">'+strIconImg+"</a>";}return'<div class="'+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+'"  '+strOculto+"><div><strong>"+label+"</strong>&nbsp;"+strIconImg+"</div><div>"+'<input type="radio" name="'+name+'" id="'+name+'1" value="1"  '+strOpt1+" "+strJavascript+" "+((ReadOnly==1)?' readonly class="READONLY" ':" ")+" />SI"+'<input type="radio" name="'+name+'" id="'+name+'2" value="0"  '+strOpt2+" "+strJavascript+" "+((ReadOnly==1)?' readonly class="READONLY" ':" ")+" />NO"+'</div><div id="err_'+name+'" ></div></div>';}function CreaCheckBox(label,name,value,oculto,strJavascript,iconAlt,iconLink,ReadOnly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt1="";var strOculto="";if(oculto==1){strOculto='style="display:none"';}if(value==1){strOpt1=" checked ";}var strIconImg="";if(iconAlt==undefined){iconAlt="";}if(iconLink==undefined){iconLink="";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'">'+strIconImg+"</a>";}return'<div class="'+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+'"  '+strOculto+"><div><strong>"+label+"</strong>&nbsp;"+strIconImg+"</div><div>"+'<input type="checkbox" name="'+name+'" id="'+name+'" value="1"  '+strOpt1+" "+strJavascript+" "+((ReadOnly==1)?' readonly class="READONLY" ':" ")+" />"+'</div><div id="err_'+name+'" ></div></div>';}function CreaPanelCheck(label,name,value,elements,esXML,oculto,strJavascript,iconAlt,iconLink,ReadOnly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strControl="<div id='panel_radio"+name+"' >";if(strfrmd_classdivctrl!=null){if(strfrmd_classdivctrl!=""){strControl="<div id='panel_radio"+name+"' class='"+strfrmd_classdivctrl+"'>";}}var numelem=0;var strIconImg="";if(iconAlt==undefined){iconAlt="";}if(iconLink==undefined){iconLink="";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'">'+strIconImg+"</a>";}var strOculto="";if(oculto==1){strOculto='style="display:none"';}var lstValores=value.split("|");for(var j=0;j<lstValores.length;j++){lstValores[j]=lstValores[j].replace("|","","g");}if(elements!=null){var strSel="";strControl+='<input type="checkbox" name="sel_'+name+'" '+(strfrmd_classctrl!=null?(strfrmd_classctrl!=""?" class='"+strfrmd_classctrl+"'":""):"")+' id="sel_'+name+'" value="1" onClick="PCheckSelTodo(this,\''+name+"');\"/>&nbsp;"+strTitlePanel+"<br>";numelem=elements.length;if(!esXML){for(var i=0;i<elements.length;i++){strSel="";for(var j=0;j<lstValores.length;j++){if(lstValores[j]==elements[i].Valor){strSel=" checked ";}}strControl+='<input type="checkbox" name="'+name+'" '+(strfrmd_classctrl!=null?(strfrmd_classctrl!=""?" class='"+strfrmd_classctrl+"'":""):"")+' id="'+name+i+'" value="'+elements[i].Valor+'" '+strSel+strJavascript+"/>&nbsp;"+elements[i].Etiqueta+"<br>";
}}else{for(var i=0;i<elements.length;i++){var obj=elements[i];strSel="";if(value==obj.getAttribute("send")){strSel=" selected ";}strControl+='<input type="checkbox" name="'+name+'" '+(strfrmd_classctrl!=null?(strfrmd_classctrl!=""?" class='"+strfrmd_classctrl+"'":""):"")+' id="'+name+i+'" value="'+obj.getAttribute("send")+'" '+strSel+strJavascript+"/>&nbsp;"+obj.getAttribute("show")+"<br>";}}}strControl+="</div>";return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"'  "+strOculto+"><div><strong>"+label+"</strong>&nbsp;"+strIconImg+"</div>"+strControl+CreaHidden(name+"count",numelem)+"</div>";}function PCheckSelTodo(obj,strName){var cuantos=document.getElementById(strName+"count").value;var bolCheck=false;if(obj.checked){bolCheck=true;}for(var i=0;i<cuantos;i++){document.getElementById(strName+i).checked=bolCheck;}}function CreaPanelRadio(label,name,value,elements,oculto,strScript,esXML,iconAlt,iconLink,ReadOnly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){if(esXML==null){esXML=false;}var strIconImg="";if(iconAlt==undefined){iconAlt="";}if(iconLink==undefined){iconLink="";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'">'+strIconImg+"</a>";}var strControl="";var numelem=0;var strOculto="";if(oculto==1){strOculto='style="display:none"';}if(elements!=null){numelem=elements.length;if(!esXML){for(var i=0;i<elements.length;i++){var strSel="";if(value==elements[i].Valor){strSel=" checked ";}strControl+='<input type="radio" name="'+name+'" id="'+name+i+'" value="'+elements[i].Valor+'" '+strSel+" "+strScript+"/>&nbsp;"+elements[i].Etiqueta+"<br>";}}else{for(var i=0;i<elements.length;i++){var obj=elements[i];var strSel="";if(value==obj.getAttribute("send")){strSel=" checked ";}strControl+='<input type="radio" name="'+name+'" id="'+name+i+'" value="'+obj.getAttribute("send")+'" '+strSel+" "+strScript+"/>&nbsp;"+obj.getAttribute("show")+"<br>";}}}return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"'  "+strOculto+"><div><strong>"+label+"</strong>&nbsp;"+strIconImg+"</div>"+strControl+CreaHidden(name+"count",numelem)+"</div>";}function Ch_Fi(evento,nameNext,bolSel){if(bolSel==null){bolSel=true;}if(evento.keyCode==13){var objNext=document.getElementById(nameNext);if(objNext!=null){objNext.focus();if(bolSel&&(Left(objNext.type,6)!="select"&&Left(objNext.type,6)!="button")){objNext.select();}}else{objNext=document.getElementById(nameNext+"1");if(objNext!=null){objNext.focus();}}}}function QuitaFoco(obj,Mayusc,solonumero){if(obj.type=="text"){if(Mayusc!=null&&obj.value.length>0){if(Mayusc==0){obj.value=UCase(obj.value);}if(Mayusc==1){obj.value=obj.value.toLowerCase();}if(Mayusc==2){var lstLet=obj.value.split(" ");var strTemp="";for(var i=0;i<lstLet.length;i++){strTemp+=Left(UCase(lstLet[i]),1)+Right(lstLet[i].toLowerCase(),lstLet[i].length-1);if(i<=lstLet.length-1){strTemp+=" ";}}obj.value=strTemp;}if(Mayusc==3){}}else{if(solonumero!=null){if(solonumero==1){if(obj.value.length==0){obj.value=0;}}}obj.value=UCase(obj.value);}}obj.setAttribute("class","outEdit");obj.setAttribute("className","outEdit");}function PonFoco(obj){obj.setAttribute("class","inEdit");obj.setAttribute("className","inEdit");}function sustituye(valor,caracter,caracterSust){do{valor=valor.replace(caracter,caracterSust);}while(valor.indexOf(caracter)>=0);return valor;}function CreaFile(label,name,value,nameNext,align,oblig,iconAlt,iconLink,script,oculto,ReadOnly,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";var strTipo="file";var strOblig="";var strIconImg="";if(oblig==1){strOblig="<label class='oblig'>*</label>";}if(nameNext!=""){strOpt=" onkeypress=\"javascript:Ch_Fi(event,'"+nameNext+"');\"";}if(iconAlt!=""){strIconImg="<img src='"+iconAlt+"' alt='' border='0'>";}if(iconLink!=""){strIconImg='<a href="javascript:'+iconLink+'"> '+strIconImg+"</a>";}strOpt+=script;var strOculto="";if(oculto==1){strOculto='style="display:none"';}return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"' "+strOculto+"><div align='"+align+"'><strong>"+label+'</strong>&nbsp;</div><div><input type="'+strTipo+'" name="'+name+'" id="'+name+'" value="'+value+'"  '+strOpt+" "+((ReadOnly==1)?' readonly class="READONLY" ':' class="outEdit" onFocus="PonFoco(this)" onBlur="QuitaFoco(this)" ')+"  />"+strOblig+strIconImg+'</div><div id="err_'+name+'" ></div></div>';}function CreaImage(label,name,value,nameNext,align,script,oculto,ancho,alto,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";var strOblig="";var strIconImg="";if(nameNext!=""){strOpt=" onkeypress=\"javascript:Ch_Fi(event,'"+nameNext+"');\"";}strOpt+=script;var strOculto="";if(oculto==1){strOculto='style="display:none"';}return"<div class='"+((strfrmd_classdiv!="")?strfrmd_classdiv:"form_field")+"' "+strOculto+"><div align='"+align+"'>"+'&nbsp;</div><div><img id="'+name+'" src="'+value+'"  '+strOpt+' alt="'+label+'" title="'+label+'" width="'+ancho+'" height="'+alto+'" />'+strOblig+strIconImg+'</div><div id="err_'+name+'" ></div></div>';}function CreaDiv(name,value,script,oculto,strfrmd_classdiv,strfrmd_classdivctrl,strfrmd_classctrl){var strOpt="";strOpt+=script;var strOculto="";if(oculto==1){strOculto='style="display:none"';}return'<div class="'+value+'" id="'+name+'" '+strOculto+strOpt+"></div>";}function _OnKeyUpValidate(obj,strNomScreen){var objScren=objMap.getScreen(strNomScreen);if(objScren!=null){objScren.OpnValidaControl(obj.id);}}