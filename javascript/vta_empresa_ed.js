var itemIdSv=0;function vta_empresa_ed(){}function InitEmp(){if(document.getElementById("EMP_PATHIMG").value==""){document.getElementById("EMP_IMAGE1").src="images/image_PNG.png";}else{ImgLoad(document.getElementById("EMP_PATHIMG").value,"EMP_IMAGE1");}if(document.getElementById("EMP_ID")!=null){var intEMP_ID=document.getElementById("EMP_ID").value;ImgLoad("images/codBar"+intEMP_ID+".png","EMP_IMAGE2");}document.getElementById("BTN_GUARDAR").parentNode.parentNode.style.display="none";document.getElementById("BTN_CANCEL").parentNode.parentNode.style.display="none";getDataEmp();}function getDataEmp(){$("#dialogWait").dialog("open");$.ajax({type:"POST",data:"",scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"vta_empresa_ed.jsp?ID=1",success:function(datos){var lstEmpresas=datos.getElementsByTagName("Datos")[0];var objEmpresa=lstEmpresas.getElementsByTagName("datos")[0];document.getElementById("EMP_RAZONSOCIAL").value=objEmpresa.getAttribute("EMP_RAZONSOCIAL");document.getElementById("EMP_RFC").value=objEmpresa.getAttribute("EMP_RFC");document.getElementById("EMP_CALLE").value=objEmpresa.getAttribute("EMP_CALLE");document.getElementById("EMP_NUMERO").value=objEmpresa.getAttribute("EMP_NUMERO");document.getElementById("EMP_NUMINT").value=objEmpresa.getAttribute("EMP_NUMINT");document.getElementById("EMP_COLONIA").value=objEmpresa.getAttribute("EMP_COLONIA");document.getElementById("EMP_MUNICIPIO").value=objEmpresa.getAttribute("EMP_MUNICIPIO");document.getElementById("EMP_ESTADO").value=objEmpresa.getAttribute("EMP_ESTADO");document.getElementById("EMP_CP").value=objEmpresa.getAttribute("EMP_CP");document.getElementById("EMP_TELEFONO1").value=objEmpresa.getAttribute("EMP_TELEFONO1");document.getElementById("EMP_TELEFONO2").value=objEmpresa.getAttribute("EMP_TELEFONO2");document.getElementById("EMP_REPRESENTANTE").value=objEmpresa.getAttribute("EMP_REPRESENTANTE");document.getElementById("EMP_TIPOCOMP").value=objEmpresa.getAttribute("EMP_TIPOCOMP");document.getElementById("EMP_REGISTRO_PATRONAL").value=objEmpresa.getAttribute("EMP_REGISTRO_PATRONAL");if(objEmpresa.getAttribute("EMP_TIPOPERS")=="1"){document.getElementById("EMP_TIPOPERS0").checked=true;}if(objEmpresa.getAttribute("EMP_TIPOPERS")=="2"){document.getElementById("EMP_TIPOPERS1").checked=true;}if(objEmpresa.getAttribute("EMP_TIPOPERS")=="3"){document.getElementById("EMP_TIPOPERS2").checked=true;}if(objEmpresa.getAttribute("EMP_NO_ISR")=="1"){document.getElementById("EMP_NO_ISR1").checked=true;}if(objEmpresa.getAttribute("EMP_NO_ISR")=="2"){document.getElementById("EMP_NO_ISR2").checked=true;}if(objEmpresa.getAttribute("EMP_NO_IVA")=="1"){document.getElementById("EMP_NO_IVA1").checked=true;}if(objEmpresa.getAttribute("EMP_NO_IVA")=="2"){document.getElementById("EMP_NO_IVA2").checked=true;}if(document.getElementById("EMP_PATHIMG").value==""){document.getElementById("EMP_IMAGE1").src="images/image_PNG.png";}else{ImgLoad(document.getElementById("EMP_PATHIMG").value,"EMP_IMAGE1");}var idx=objEmpresa.getAttribute("EMP_ID");setTimeout("LoadRegimen("+idx+")",1000);$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":pto:"+objeto+" "+quepaso+" "+otroobj);}});}function ImgLoad(sSrc,strNomImg){var oImg=new Image();oImg.onload=function(){document.getElementById(strNomImg).src=oImg.src;};oImg.onerror=function(){document.getElementById(strNomImg).src="images/image_PNG.png";};oImg.src=sSrc+"#";}function UpFileEmp(strNomFile){ValidaClean(strNomFile);if(document.getElementById(strNomFile).value==""){ValidaShow(strNomFile,lstMsg[13]);return false;}if(Right(document.getElementById(strNomFile).value.toUpperCase(),3)!="PNG"){ValidaShow(strNomFile,lstMsg[60]);return false;}ajaxFileUpload(strNomFile,document.getElementById("EMP_ID").value);return true;}function ajaxFileUpload(strNomFile,intEMP_ID){$("#dialogWait").dialog("open");alert(strNomFile+" "+intEMP_ID);$.ajaxFileUpload({url:"ERP_UPFileEmp.jsp?EMP_ID="+intEMP_ID,secureuri:false,fileElementId:strNomFile,dataType:"json",success:function(data,status){if(typeof(data.error)!="undefined"){if(data.error!=""){alert(data.error);}else{alert(data.msg);if(strNomFile=="EMP_IMAGE1"){ImgLoad(document.getElementById("EMP_PATHIMG").value,"EMP_IMAGE1");}else{ImgLoad("images/codBar"+intEMP_ID+".png","EMP_IMAGE2");}}}$("#dialogWait").dialog("close");},error:function(data,status,e){alert(e);$("#dialogWait").dialog("close");}});return false;}function tabShowEmpresas(event,ui){var idx=document.getElementById("EMP_ID").value;if(ui.newTab.index()==2){LoadRegimen(idx);}}function LoadRegimen(idx){var grid=jQuery("#GRID_REGFIS");grid.setGridParam({url:"CIP_TablaOp.jsp?ID=5&opnOpt=LISTREG&_search=true&EMP_ID="+idx});grid.trigger("reloadGrid");}function nuevoRegimen(){document.getElementById("BTN_GUARDAR").parentNode.parentNode.style.display="";document.getElementById("BTN_CANCEL").parentNode.parentNode.style.display="";document.getElementById("BTN_NEWREG").parentNode.parentNode.style.display="none";document.getElementById("BTN_DELREG").parentNode.parentNode.style.display="none";}function cancelRegimen(){document.getElementById("BTN_GUARDAR").parentNode.parentNode.style.display="none";document.getElementById("BTN_CANCEL").parentNode.parentNode.style.display="none";document.getElementById("BTN_NEWREG").parentNode.parentNode.style.display="";document.getElementById("BTN_DELREG").parentNode.parentNode.style.display="";}function delRegimen(){var grid=jQuery("#GRID_REGFIS");if(grid.getGridParam("selrow")!=null){var id=grid.getGridParam("selrow");var lstRow=grid.getRowData(id);var IdRen=lstRow.EMPR_ID;if(confirm("Â¿Confirma borrar el regimen fiscal "+lstRow.REGF_ID+"?")){grid.delRowData(grid.getGridParam("selrow"));$.ajax({type:"POST",data:"idReg="+IdRen,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_RegimenFiscal.jsp?ID=2",success:function(datos){if(datos.substring(0,2)=="OK"){alert("Regimen Fiscal Borrado!!");}else{alert(datos);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":pto:"+objeto+" "+quepaso+" "+otroobj);}});}}}function saveRegimen(){if(document.getElementById("CMB_REGFIS").value!=0){var strPost="&idReg="+encode(document.getElementById("CMB_REGFIS").value);strPost+="&idEmp="+document.getElementById("EMP_ID").value;$.ajax({type:"POST",data:strPost,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_RegimenFiscal.jsp?ID=3",success:function(datos){if(datos.substring(0,2)=="OK"){var grid=jQuery("#GRID_REGFIS");grid.trigger("reloadGrid");cancelRegimen();alert("Alta exitosa!!");}else{if(datos.substring(0,2)=="NO"){alert("El regimen Fiscal ya existe, elija otro!");}else{alert(datos);}}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":pto:"+objeto+" "+quepaso+" "+otroobj);}});}else{alert("ELIJA EL REGIMEN FISCAL QUE DESEA DAR DE ALTA PARA ESTA EMPRESA.");}}