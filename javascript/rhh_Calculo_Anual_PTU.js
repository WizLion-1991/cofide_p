function rhh_Calculo_Anual_PTU(){}function rhh_Calculo_Anual_PTU_Ini(){document.getElementById("btn1").style.display="none";}function CalCuloAn_PTU(){$("#dialogWait").dialog("open");var itemIdCob=0;var itemIdCob1=0;var strPost="";var bolValida=0;var intAnio=document.getElementById("PTU_ANIO").value;var dblMontoDistribuir=document.getElementById("PTU_IMPORTE").value;var intTipoNomina=document.getElementById("PTU_TIPO_NOM").value;strPost+="&intAnio="+intAnio;strPost+="&intTipoNomina="+intTipoNomina;strPost+="&dblMontoDistribuir="+dblMontoDistribuir;if(intAnio==""){alert("Captura el Año");bolValida=1;}else{if(intAnio.length!=4){alert("El año debe ser de 4 digitos");bolValida=1;}}if(intTipoNomina==0){alert("Captura el Tipo de Nomina");bolValida=1;}if(dblMontoDistribuir==0){alert("Captura el Monto a distribuir");bolValida=1;}if(bolValida==0){$.ajax({type:"POST",data:strPost,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_CalculoAnualPTU.jsp?id=1",success:function(datos){jQuery("#GRD_CALC_PTU").clearGridData();jQuery("#GRD_LIST_PTU").clearGridData();var objsc=datos.getElementsByTagName("calculoPtu")[0];var lstProds=objsc.getElementsByTagName("calculoPtu_deta");for(var i=0;i<lstProds.length;i++){var obj=lstProds[i];var datarow={CALC_PTU_CONCEPTO:obj.getAttribute("strFactor"),CALC_PTU_IMPORTE:obj.getAttribute("dblImporte")};itemIdCob++;jQuery("#GRD_CALC_PTU").addRowData(itemIdCob,datarow,"last");}var dblSumDias=0;var dblSumSalario=0;var dblSumDiasPTU=0;var dblSumSalarioPTU=0;var dblSumTotalPTU=0;var lstProds1=objsc.getElementsByTagName("calculoPtu_deta_1");for(var i=0;i<lstProds1.length;i++){var obj1=lstProds1[i];dblSumDias=parseFloat(dblSumDias)+parseFloat(obj1.getAttribute("TotalDiasLaborados"));dblSumSalario=parseFloat(dblSumSalario)+parseFloat(obj1.getAttribute("TotalSalarioPercibido"));dblSumDiasPTU=parseFloat(dblSumDiasPTU)+parseFloat(obj1.getAttribute("PtuDias"));dblSumSalarioPTU=parseFloat(dblSumSalarioPTU)+parseFloat(obj1.getAttribute("PtuSalario"));dblSumTotalPTU=parseFloat(dblSumTotalPTU)+parseFloat(obj1.getAttribute("PtuTotal"));var datarow1={LIST_PTU_NUM:obj1.getAttribute("numero"),LIST_PTU_NOM:obj1.getAttribute("nombre"),LIST_PTU_DIAS_LABORADOS:obj1.getAttribute("TotalDiasLaborados"),LIST_PTU_SALARIO_PERC:obj1.getAttribute("TotalSalarioPercibido"),LIST_PTU_DIAS:obj1.getAttribute("PtuDias"),LIST_PTU_SALARIO:obj1.getAttribute("PtuSalario"),LIST_PTU_TOTAL:obj1.getAttribute("PtuTotal")};itemIdCob1++;jQuery("#GRD_LIST_PTU").addRowData(itemIdCob1,datarow1,"last");}jQuery("#GRD_LIST_PTU").footerData("set",{LIST_PTU_NOM:"SUMAS",LIST_PTU_DIAS_LABORADOS:FormatNumber(dblSumDias,2,true,false,true,false),LIST_PTU_SALARIO_PERC:dblSumSalario,LIST_PTU_DIAS:dblSumDiasPTU,LIST_PTU_SALARIO:dblSumSalarioPTU,LIST_PTU_TOTAL:dblSumTotalPTU});$("#dialogWait").dialog("close");},error:function(){jQuery("#GRD_CALC_PTU").clearGridData();jQuery("#GRD_LIST_PTU").clearGridData();alert("No hay productos con esas caracteristicas");$("#dialogWait").dialog("close");}});}}function GuardaPtu(){$("#dialogWait").dialog("open");var strPost="";var intAnio=document.getElementById("PTU_ANIO").value;var dblMontoDistribuir=document.getElementById("PTU_IMPORTE").value;var intTipoNomina=document.getElementById("PTU_TIPO_NOM").value;strPost+="&intAnio="+intAnio;strPost+="&intTipoNomina="+intTipoNomina;strPost+="&dblMontoDistribuir="+dblMontoDistribuir;var grid1=jQuery("#GRD_LIST_PTU");var idArr=grid1.getDataIDs();if(idArr.length==0){alert("No Contiene PTU");}else{for(var i=0;i<idArr.length;i++){var id=idArr[i];var lstRow=grid1.getRowData(id);strPost+="&EMP_NUM"+i+"="+lstRow.LIST_PTU_NUM+"";strPost+="&PTU_DIAS"+i+"="+lstRow.LIST_PTU_DIAS+"";strPost+="&PTU_SALARIO"+i+"="+lstRow.LIST_PTU_SALARIO+"";strPost+="&PTU_TOTAL"+i+"="+lstRow.LIST_PTU_TOTAL+"";}strPost+="&intlenghtArr="+idArr.length;$.ajax({type:"POST",data:strPost,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"XML",url:"ERP_CalculoAnualPTU.jsp?id=2",success:function(datos){var objsc=datos.getElementsByTagName("respuesta")[0];var lstAnticipos=objsc.getElementsByTagName("respuesta_deta");for(var i=0;i<lstAnticipos.length;i++){var obj=lstAnticipos[i];var strRespuesta=obj.getAttribute("strRespuesta");if(strRespuesta=="OK"){jQuery("#GRD_CALC_PTU").clearGridData();jQuery("#GRD_LIST_PTU").clearGridData();$("#dialogWait").dialog("close");}else{alert("Error al guardar PTU");}}jQuery("#GRD_CALC_PTU").clearGridData();jQuery("#GRD_LIST_PTU").clearGridData();$("#dialogWait").dialog("close");},error:function(){jQuery("#GRD_CALC_PTU").clearGridData();jQuery("#GRD_LIST_PTU").clearGridData();alert("No hay productos con esas caracteristicas");$("#dialogWait").dialog("close");}});}}