var itemIdEdCtaProv=0;function vta_edo_cta_prov(){}function initEdoCtaProv(){$("#dialogWait").dialog("open");myLayout.close("west");myLayout.close("east");myLayout.close("south");myLayout.close("north");document.getElementById("btn1").style.display="none";ChangeStyleEdoCtaProv();$("#dialogWait").dialog("close");$.ajax({type:"POST",data:"",scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_EdoCtaProv.jsp?id=1",success:function(datos){var objSelDest=document.getElementById("ED_PERIODO");select_clear(objSelDest);var lstPer=datos.getElementsByTagName("periodo");for(i=0;i<lstPer.length;i++){var obj=lstPer[i];select_add(objSelDest,obj.getAttribute("valor"),obj.getAttribute("valor"));}},error:function(objeto,quepaso,otroobj){alert("edo_cta1:"+objeto+" "+quepaso+" "+otroobj);}});}function OpnDiagEdoCtaProv(){OpnOpt("PROVEEDOR","grid","dialogProv",false,false);}function ChangeStyleEdoCtaProv(){d.getElementById("ED_INICIAL").setAttribute("class","textNumberReadOnly");d.getElementById("ED_INICIAL").setAttribute("className","textNumberReadOnly");d.getElementById("ED_CARGOS").setAttribute("class","textNumberReadOnly");d.getElementById("ED_CARGOS").setAttribute("className","textNumberReadOnly");d.getElementById("ED_ABONOS").setAttribute("class","textNumberReadOnly");d.getElementById("ED_ABONOS").setAttribute("className","textNumberReadOnly");d.getElementById("ED_FINAL").setAttribute("class","textNumberReadOnly");d.getElementById("ED_FINAL").setAttribute("className","textNumberReadOnly");}function RefreshCteEdoCtaProv(){$("#dialogCte").dialog("close");var intIdCliente=document.getElementById("ED_PROVEEDOR").value;if(parseInt(intIdCliente)!=0){$("#dialogWait").dialog("open");$.ajax({type:"POST",data:"PV_ID="+intIdCliente,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_EdoCtaProv.jsp?id=2",success:function(datos){var lstProv=datos.getElementsByTagName("proveedor");var bolExiste=false;for(i=0;i<lstProv.length;i++){var obj=lstProv[i];document.getElementById("ED_NOMBRE").value=obj.getAttribute("nombre");document.getElementById("ED_LIM_CREDITO").value=FormatNumber(obj.getAttribute("monto_credito"),2,true,false,true,false);document.getElementById("ED_DIAS_CREDITO").value=obj.getAttribute("dias_credito");var grid=jQuery("#GRID_DETA");grid.clearGridData();var lstMoneda=obj.getElementsByTagName("moneda");var objSelDest=document.getElementById("ED_MONEDA");select_clear(objSelDest);for(m=0;m<lstMoneda.length;m++){var obj=lstMoneda[m];select_add(objSelDest,obj.getAttribute("desc"),obj.getAttribute("id"));}var selectobject=document.getElementById("ED_MONEDA");for(var ih=0;ih<selectobject.length;ih++){if(parseInt(selectobject.options[ih].value)==parseInt(obj.getAttribute("moneda"))){selectobject.selectedIndex=ih;}}bolExiste=true;}if(!bolExiste){alert(lstMsg[210]);$("#dialogWait").dialog("close");}else{RefreshListProv(false);}},error:function(objeto,quepaso,otroobj){alert("edo_cta2:"+objeto+" "+quepaso+" "+otroobj);}});}}function RefreshListProv(bolWait){$("#dialogCte").dialog("close");var intIdProveedor=document.getElementById("ED_PROVEEDOR").value;if(parseInt(intIdProveedor)!=0){if(bolWait!=null){if(bolWait){$("#dialogWait").dialog("open");}}else{$("#dialogWait").dialog("open");}var strPeriodo=document.getElementById("ED_PERIODO").value;var intIdMoneda=document.getElementById("ED_MONEDA").value;$.ajax({type:"POST",data:"PV_ID="+intIdProveedor+"&MON_ID="+intIdMoneda+"&Periodo="+strPeriodo.replace("/",""),scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_EdoCtaProv.jsp?id=3",success:function(datos){var lstProv=datos.getElementsByTagName("saldos");for(i=0;i<lstProv.length;i++){var obj=lstProv[i];document.getElementById("ED_INICIAL").value=FormatNumber(obj.getAttribute("inicial"),2,true,false,true,false);document.getElementById("ED_CARGOS").value=FormatNumber(obj.getAttribute("cargos"),2,true,false,true,false);document.getElementById("ED_ABONOS").value=FormatNumber(obj.getAttribute("abonos"),2,true,false,true,false);document.getElementById("ED_FINAL").value=FormatNumber(obj.getAttribute("final"),2,true,false,true,false);}RefreshGridListProv(intIdProveedor,intIdMoneda,strPeriodo);},error:function(objeto,quepaso,otroobj){alert("edo_cta3:"+objeto+" "+quepaso+" "+otroobj);}});}}function RefreshGridListProv(intIdProveedor,intIdMoneda,strPeriodo){var grid=jQuery("#GRID_DETA");grid.clearGridData();var iConSaldo=0;if(document.getElementById("ED_CON_SALDO").checked){iConSaldo=1;}$.ajax({type:"POST",data:"PV_ID="+intIdProveedor+"&MON_ID="+intIdMoneda+"&Periodo="+strPeriodo.replace("/","")+"&ConSaldo="+iConSaldo,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_EdoCtaProv.jsp?id=4",success:function(datos){var lstProv=datos.getElementsByTagName("doc");for(i=0;i<lstProv.length;i++){var obj=lstProv[i];var strStatus=obj.getAttribute("estatus");var datarow={DET_ID:obj.getAttribute("id"),DET_TIPO:obj.getAttribute("tipo"),DET_FOLIO:obj.getAttribute("folio"),DET_FECHA:obj.getAttribute("fecha"),DET_VENCIMIENTO:obj.getAttribute("vencimiento"),DET_CARGOS:obj.getAttribute("cargos"),DET_ABONOS:obj.getAttribute("abonos"),DET_SALDO:obj.getAttribute("saldo"),DET_ESTATUS:strStatus,DET_BANCO:obj.getAttribute("banco")};itemIdEdCtaProv++;grid.addRowData(itemIdEdCtaProv,datarow,"last");}var arr=grid.getDataIDs();for(var i=0;i<arr.length;i++){var id=arr[i];var lstRow=grid.getRowData(id);if(lstRow.DET_ESTATUS=="VENCIDO"){grid.setCell(id,"DET_TIPO","","advertencia","",false);grid.setCell(id,"DET_FOLIO","","advertencia","",false);grid.setCell(id,"DET_FECHA","","advertencia","",false);grid.setCell(id,"DET_VENCIMIENTO","","advertencia","",false);grid.setCell(id,"DET_CARGOS","","advertencia","",false);grid.setCell(id,"DET_ABONOS","","advertencia","",false);grid.setCell(id,"DET_SALDO","","advertencia","",false);grid.setCell(id,"DET_ESTATUS","","advertencia","",false);grid.setCell(id,"DET_BANCO","","advertencia","",false);}}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert("edo_cta4:"+objeto+" "+quepaso+" "+otroobj);}});}function ImprimirEdoCtaProv(){var intIdProveedor=document.getElementById("ED_PROVEEDOR").value;var strPeriodo=document.getElementById("ED_PERIODO").value;var intIdMoneda=document.getElementById("ED_MONEDA").value;strPeriodo=strPeriodo.replace("/","");var iConSaldo=0;if(document.getElementById("ED_CON_SALDO").checked){iConSaldo=1;}Abrir_Link("ERP_EdoCtaProv.jsp?id=6"+"&boton_1=PDF&Proveedor="+intIdProveedor+"&Periodo="+strPeriodo+"&Moneda="+intIdMoneda+"&EMP_ID="+intEMP_ID+"&iConSaldo="+iConSaldo,"_reporte",500,600,0,0);}function SalirEdoCtaProv(){myLayout.open("west");myLayout.open("east");myLayout.open("south");myLayout.open("north");document.getElementById("MainPanel").innerHTML="";var objMainFacPedi=objMap.getScreen("EDO_CTA_PR");objMainFacPedi.bolActivo=false;objMainFacPedi.bolMain=false;objMainFacPedi.bolInit=false;objMainFacPedi.idOperAct=0;}function VerDetalleEdoCtaProv(){var grid=jQuery("#GRID_DETA");if(grid.getGridParam("selrow")!=null){$("#dialogWait").dialog("open");var lstRowAct=grid.getRowData(grid.getGridParam("selrow"));var intIdProveedor=document.getElementById("ED_PROVEEDOR").value;var intIdMoneda=document.getElementById("ED_MONEDA").value;$.ajax({type:"POST",data:"PV_ID="+intIdProveedor+"&MON_ID="+intIdMoneda+"&FAC_ID="+lstRowAct.DET_ID,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_EdoCtaProv.jsp?id=5",success:function(datos){var lstCte=datos.getElementsByTagName("doc");var strHTML="<table border=0>";strHTML+="<tr>";strHTML+="<th>&nbsp;</th>";strHTML+="<th>"+lstMsg[200]+"</th>";strHTML+="<th>"+lstMsg[201]+"</th>";strHTML+="<th>"+lstMsg[202]+"</th>";strHTML+="<th>"+lstMsg[203]+"</th>";strHTML+="<th>"+lstMsg[204]+"</th>";
strHTML+="<th>"+lstMsg[205]+"</th>";strHTML+="<th>"+lstMsg[206]+"</th>";strHTML+="<th>"+"Banco"+"</th>";strHTML+="</tr>";var dblSaldo=0;for(i=0;i<lstCte.length;i++){var obj=lstCte[i];var dblCargo=obj.getAttribute("cargos");var dblAbono=obj.getAttribute("abonos");if(parseFloat(obj.getAttribute("paridad"))!=1){if(intIdMoneda==1){dblCargo=parseFloat(dblCargo)*parseFloat(obj.getAttribute("paridad"));dblAbono=parseFloat(dblAbono)*parseFloat(obj.getAttribute("paridad"));}else{dblCargo=parseFloat(dblCargo)/parseFloat(obj.getAttribute("paridad"));dblAbono=parseFloat(dblAbono)/parseFloat(obj.getAttribute("paridad"));}}dblSaldo+=parseFloat(dblCargo)-parseFloat(dblAbono);strHTML+="<tr>";if(parseFloat(dblAbono)>0){strHTML+="<td><a href='javascript:ImprimirEdoCtaPago("+obj.getAttribute("id")+","+obj.getAttribute("id_Masivo")+')\'><img border="0" src="images/ptovta/printer_64.png"></a></td>';}else{strHTML+="<td><a href='javascript:ImprimirEdoCtaCxp("+obj.getAttribute("id_Cxp")+')\'><img border="0" src="images/ptovta/printer_64.png"></a></td>';}strHTML+="<td>"+obj.getAttribute("fecha")+"</td>";if(obj.getAttribute("folio")!="null"){strHTML+="<td>"+obj.getAttribute("folio")+"</td>";}else{strHTML+="<td></td>";}strHTML+="<td>"+obj.getAttribute("concepto")+"</td>";strHTML+="<td align='right'>"+FormatNumber(dblCargo,2,true,false,true,false)+"</td>";strHTML+="<td align='right'>"+FormatNumber(dblAbono,2,true,false,true,false)+"</td>";strHTML+="<td align='right'>"+FormatNumber(dblSaldo,2,true,false,true,false)+"</td>";strHTML+="<td align='right'>"+obj.getAttribute("paridad")+"</td>";strHTML+="<td align='right'>"+obj.getAttribute("banco")+"</td>";strHTML+="</tr>";}strHTML+="</table border=0>";document.getElementById("dialog2_inside").innerHTML=strHTML;$("#dialogWait").dialog("close");$("#dialog2").dialog("option","title",lstMsg[207]+" "+lstRowAct.DET_FOLIO);$("#dialog2").dialog("open");},error:function(objeto,quepaso,otroobj){alert("edo_cta4:"+objeto+" "+quepaso+" "+otroobj);}});}}function ImprimirEdoCtaCxp(IdCxp){var strHtml=CreaHidden("CXP_ID",IdCxp);openFormat("CUENTAXPAGAR","PDF",strHtml);}function ImprimirEdoCtaPago(intMpId,intMpmId){if(parseInt(intMpId)!=0){openFormat("COBROSMAS","PDF",CreaHidden("MM_ID",intMpmId));}else{openFormat("CBMASCUENTAS","PDF",CreaHidden("MP_ID",intMpId));}}