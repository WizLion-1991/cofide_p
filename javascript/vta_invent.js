var itemIdInv=0;var bolEntrada=false;var bolSalida=false;var bolTraspaso=false;var bolTraspasoSalida=false;var bolTraspasoEntrada=false;var bolCambioFechaInv=false;var ENTRADA=1;var SALIDA=2;var TRASPASO=3;var TRASPASO_SALIDA=4;var TRASPASO_ENTRADA=5;var objTabla=null;var numFilas=0;var idT=0;var intContaIdGrid=0;var itemId=0;var objeto=null;var existenciaTemp=0;var newObjProd=null;var valorSerie=null;function vta_invent(){}function InitInv(){$("#dialogWait").dialog("open");myLayout.close("west");myLayout.close("east");myLayout.close("south");myLayout.close("north");d.getElementById("SC_ID").value=intSucDefa;FormStyleInv();d.getElementById("INV_OPER").value=strUserName;d.getElementById("INV_PROD").focus();var strHtml="<ul>"+getMenuItem("CallbtnIV0();","Guardar Movimiento","images/ptovta/CircleSave.png")+getMenuItem("CallbtnIV1();","Nuevo Movimiento","images/ptovta/VisPlus.png")+getMenuItem("CallbtnIV2();","Recuperar Movimiento","images/ptovta/VisMagnifier.png")+getMenuItem("CallbtnIV3();","Notas","images/ptovta/VisNote.png")+getMenuItem("CallbtnIV4();","Borrar Producto","images/ptovta/VisClose.png")+getMenuItem("CallbtnIV9();","Salir","images/ptovta/exitBig.png")+"</ul>";document.getElementById("TOOLBAR").innerHTML=strHtml;bolEntrada=false;bolSalida=false;bolTraspaso=false;bolTraspasoSalida=false;bolTraspasoEntrada=false;bolCambioFechaInv=false;$.ajax({type:"POST",data:"keys=64,65,66,67,68,69",scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"Acceso.do",success:function(datos){var objsc=datos.getElementsByTagName("Access")[0];var lstKeys=objsc.getElementsByTagName("key");for(i=0;i<lstKeys.length;i++){var obj=lstKeys[i];if(obj.getAttribute("id")==64&&obj.getAttribute("enabled")=="true"){bolEntrada=true;}if(obj.getAttribute("id")==65&&obj.getAttribute("enabled")=="true"){bolSalida=true;}if(obj.getAttribute("id")==66&&obj.getAttribute("enabled")=="true"){bolTraspaso=true;}if(obj.getAttribute("id")==67&&obj.getAttribute("enabled")=="true"){bolTraspasoSalida=true;}if(obj.getAttribute("id")==68&&obj.getAttribute("enabled")=="true"){bolTraspasoEntrada=true;}if(obj.getAttribute("id")==69&&obj.getAttribute("enabled")=="true"){bolCambioFechaInv=true;}}if(bolCambioFechaInv){if($("#INV_FECHA").datepicker("isDisabled")){$("#INV_FECHA").datepicker("enable");}var objFecha=document.getElementById("INV_FECHA");objFecha.setAttribute("class","outEdit");objFecha.setAttribute("className","outEdit");objFecha.readOnly=false;}else{$("#INV_FECHA").datepicker("disable");}setTimeout("d.getElementById('INV_PROD').focus();",3000);document.getElementById("btnSI").onclick=function(){ConfirmaSIIV();};document.getElementById("btnNO").onclick=function(){ConfirmaNOIV();};$("#dialogWait").dialog("close");SelOperInv();},error:function(objeto,quepaso,otroobj){alert(":pto:"+objeto+" "+quepaso+" "+otroobj);}});}function SelOperInv(){var elements=new Array();var objSel=document.getElementById("INV_TIPO");var intIdx=0;for(var i=0;i<objSel.length;i++){if(objSel.options[i].value!=""){var bolPasa=false;if(parseInt(objSel.options[i].value)==ENTRADA&&bolEntrada){bolPasa=true;}if(parseInt(objSel.options[i].value)==SALIDA&&bolSalida){bolPasa=true;}if(parseInt(objSel.options[i].value)==TRASPASO&&bolTraspaso){bolPasa=true;}if(parseInt(objSel.options[i].value)==TRASPASO_SALIDA&&bolTraspasoSalida){bolPasa=true;}if(parseInt(objSel.options[i].value)==TRASPASO_ENTRADA&&bolTraspasoEntrada){bolPasa=true;}if(bolPasa){elements[intIdx]=new Seloptions(objSel.options[i].text,objSel.options[i].value);intIdx++;}}}elements2=new Array();objSel=document.getElementById("SC_ID2");intIdx=0;for(i=0;i<objSel.length;i++){if(objSel.options[i].value!="0"){elements2[intIdx]=new Seloptions(objSel.options[i].text,objSel.options[i].value);intIdx++;}}var strHTML=CreaPanelRadio("","OperInvSel",-1,elements,0,' onClick="SelOperInvEval()" ',false,"","",false);strHTML+=CreaPanelRadio(lstMsg[42],"OperInvSuc",-1,elements2,1,' onClick="SelOperInvDo()" ',false,"","",false);strHTML+=CreaTexto(lstMsg[43],"NumTrasOrig",0,10,10,true,false,"","left",0,"","","",1,0,false);strHTML+='<button style="display:none" onClick="SelOperInvEvalTE()" value="Continuar" '+' id="btnOperSv" class="boton" name="btnOperSv" type="button">Continuar</button>';$("#dialogInv").dialog("option","title",lstMsg[36]);document.getElementById("dialogInv_inside").innerHTML=strHTML;$("#dialogInv").dialog("option","width",500);$("#dialogInv").dialog("open");}function SelOperInvEval(){for(var i=0;i<d.getElementById("OperInvSelcount").value;i++){if(d.getElementById("OperInvSel"+i).checked){if(parseFloat(d.getElementById("OperInvSel"+i).value)==TRASPASO||parseFloat(d.getElementById("OperInvSel"+i).value)==TRASPASO_SALIDA){d.getElementById("OperInvSuccount").parentNode.style.display="";d.getElementById("OperInvSelcount").parentNode.style.display="none";}else{if(parseFloat(d.getElementById("OperInvSel"+i).value)==TRASPASO_ENTRADA){d.getElementById("NumTrasOrig").parentNode.parentNode.style.display="";d.getElementById("btnOperSv").style.display="";d.getElementById("OperInvSelcount").parentNode.style.display="none";d.getElementById("NumTrasOrig").focus();}else{SelOperInvDo();}}return;}}}function SelOperInvEvalTE(){$("#dialogWait").dialog("open");if(parseFloat(d.getElementById("NumTrasOrig").value)==0){alert(lstMsg[44]);$("#dialogWait").dialog("close");return;}$.ajax({type:"POST",data:"Id_Tras="+d.getElementById("NumTrasOrig").value,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"InvMov.do?id=11",success:function(datos){if(trim(datos)!=""){var objSel=document.getElementById("SC_ID");var bolFind=false;var strSuc=trim(datos);for(i=0;i<objSel.length;i++){if(objSel.options[i].value!="0"){if((objSel.options[i].value)==strSuc){objSel.value=strSuc;bolFind=true;break;}}}if(bolFind){d.getElementById("INV_TRASORIGEN").value=d.getElementById("NumTrasOrig").value;d.getElementById("NumTrasOrig").value=0;SelectInactive(d.getElementById("SC_ID"));SelOperInvDo();$("#dialogWait").dialog("close");}else{alert(lstMsg[49]);$("#dialogWait").dialog("close");return;}}else{$("#dialogWait").dialog("close");alert(lstMsg[45]);}},error:function(objeto,quepaso,otroobj){$("#dialogWait").dialog("close");alert(":pto:"+objeto+" "+quepaso+" "+otroobj);}});}function SelOperInvDo(){for(var i=0;i<d.getElementById("OperInvSelcount").value;i++){if(d.getElementById("OperInvSel"+i).checked){d.getElementById("INV_TIPO").value=d.getElementById("OperInvSel"+i).value;}}if((document.getElementById("INV_TIPO").value==TRASPASO||document.getElementById("INV_TIPO").value==TRASPASO_SALIDA)){d.getElementById("OperInvSuccount").parentNode.style.display="none";d.getElementById("OperInvSelcount").parentNode.style.display="";for(i=0;i<d.getElementById("OperInvSuccount").value;i++){if(d.getElementById("OperInvSuc"+i).checked){d.getElementById("SC_ID2").value=d.getElementById("OperInvSuc"+i).value;}}}if(document.getElementById("INV_TIPO").value==ENTRADA||document.getElementById("INV_TIPO").value==TRASPASO_ENTRADA){d.getElementById("INV_LOTE").parentNode.parentNode.style.display="";d.getElementById("INV_FECHA_CAD").parentNode.parentNode.style.display="";}else{d.getElementById("INV_LOTE").parentNode.parentNode.style.display="none";d.getElementById("INV_FECHA_CAD").parentNode.parentNode.style.display="none";}if(document.getElementById("INV_TIPO").value==TRASPASO_ENTRADA){d.getElementById("NumTrasOrig").parentNode.style.display="none";}d.getElementById("INV_PROD").focus();$("#dialogInv").dialog("close");}function FormStyleInv(){d.getElementById("INV_TOT").setAttribute("class","ui-Total");d.getElementById("INV_TOT").setAttribute("className","ui-Total");d.getElementById("btn1").style.display="none";}function CallbtnIV0(){SaveInv();}function CallbtnIV1(){$("#SioNO").dialog("option","title",lstMsg[33]);d.getElementById("Operac").value="Nva";document.getElementById("SioNO_inside").innerHTML="";$("#SioNO").dialog("open");
}function CallbtnIV2(){OpnOpt("INV_VIEW","grid","dialogView",false,false);}function CallbtnIV3(){var grid=jQuery("#INV_GRID");var id=grid.getGridParam("selrow");if(id!=null){var lstRowAct=grid.getRowData(id);var strHTML=CreaTexto(lstMsg[30],"NOTASMOD",lstRowAct.MOVD_NOTAS,80,80,false,false,"","left",0,"","","",0,0,0);strHTML+=CreaBoton("","NOTASBTN",lstMsg[31],"ChangeNotesInv()","center",false,true,0);$("#dialog2").dialog("option","title",lstMsg[29]);document.getElementById("dialog2").innerHTML=strHTML;$("#dialog2").dialog("option","width",500);$("#dialog2").dialog("open");document.getElementById("NOTASMOD").focus();}}function ChangeNotesInv(){var grid=jQuery("#INV_GRID");var id=grid.getGridParam("selrow");if(id!=null){var lstRowAct=grid.getRowData(id);lstRowAct.MOVD_NOTAS=d.getElementById("NOTASMOD").value;grid.setRowData(id,lstRowAct);}$("#dialog2").dialog("close");}function CallbtnIV4(){InvDrop();}function CallbtnIV9(){myLayout.open("west");myLayout.open("east");myLayout.open("south");myLayout.open("north");document.getElementById("MainPanel").innerHTML="";}function ConfirmaSIIV(){if(d.getElementById("Operac").value=="Nva"){ResetOperaActualInv();}if(d.getElementById("Operac").value=="Save"){SaveInvDo();}if(d.getElementById("Operac").value=="Anular"){InvAnulDo();}d.getElementById("Operac").value="";$("#SioNO").dialog("close");}function ConfirmaNOIV(){$("#SioNO").dialog("close");}function AddItemEvtIV(event,obj){if(event.keyCode==13){AddItemIV();}}function AddItemIV(){var strCod=UCase(d.getElementById("INV_PROD").value);var dblInvCosto=d.getElementById("INV_COSTO").value;var objInvTipo=d.getElementById("INV_TIPO");if(trim(strCod)!=""){$("#dialogWait").dialog("open");var bolNvo=true;var grid=jQuery("#INV_GRID");var arr=grid.getDataIDs();var idProd=0;for(var i=0;i<arr.length;i++){var id=arr[i];var lstRowAct=grid.getRowData(id);valorSerie=lstRowAct;if(lstRowAct.MOVD_CVE==strCod||lstRowAct.MOVD_CODBARRAS==strCod){idProd=id;bolNvo=false;break;}}if(bolNvo){$.ajax({type:"POST",data:"PR_CODIGO="+strCod+"&SC_ID="+d.getElementById("SC_ID").value+"&SC_ID2="+d.getElementById("SC_ID2").value,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"VtasMov.do?id=5",success:function(datoVal){var objProd=datoVal.getElementsByTagName("vta_productos")[0];var Pr_Id=0;var Pr_Id2=0;if(objProd!=undefined){Pr_Id=objProd.getAttribute("PR_ID");Pr_Id2=objProd.getAttribute("PR_ID2");d.getElementById("INV_DESC").value=objProd.getAttribute("PR_DESCRIPCION");if(Pr_Id!=0){strCod=objProd.getAttribute("PR_CODIGO");}}var dblCantidad=d.getElementById("INV_CANT").value;if(objInvTipo.value=="1"||objInvTipo.value=="5"){if(parseFloat(dblInvCosto)>0){objProd.setAttribute("PR_COSTOCOMPRA",parseFloat(dblInvCosto));}}if(Pr_Id!=0){if(parseInt(objInvTipo.value)==TRASPASO||parseInt(objInvTipo.value)==TRASPASO_SALIDA){if(Pr_Id2==0){alert(lstMsg[47]+strCod+lstMsg[48]);$("#dialogWait").dialog("close");return;}}var dblExistencia=0;if((parseInt(objInvTipo.value)==SALIDA||parseInt(objInvTipo.value)==TRASPASO||parseInt(objInvTipo.value)==TRASPASO_SALIDA)&&parseInt(objProd.getAttribute("PR_REQEXIST"))==1){$.ajax({type:"POST",data:"PR_ID="+Pr_Id,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"InvMov.do?id=1",success:function(datoExist){dblExistencia=parseFloat(datoExist);existenciaTemp=dblExistencia;if(parseFloat(dblCantidad)>dblExistencia){alert(lstMsg[3]+"("+dblCantidad+") "+lstMsg[34]+strCod+"("+dblExistencia+") "+lstMsg[4]);if(parseFloat(dblExistencia)>0){dblCantidad=dblExistencia;}else{dblCantidad=0;}}},error:function(objeto,quepaso,otroobj){alert(":ptoExist:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}var iUsoSerie=objProd.getAttribute("PR_USO_NOSERIE");if(iUsoSerie=="1"){AddItemInv(objProd,Pr_Id,dblCantidad,strCod,dblExistencia);entradaYsalida(objProd);}else{AddItemInv(objProd,Pr_Id,dblCantidad,strCod,dblExistencia);}}else{alert(lstMsg[0]);d.getElementById("INV_DEVO").value=0;document.getElementById("INV_PROD").focus();$("#dialogWait").dialog("close");}newObjProd=objProd;},error:function(objeto,quepaso,otroobj){alert(":pto3:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}else{var Cantidad=d.getElementById("INV_CANT").value;var gridD=jQuery("#INV_GRID");var lstRow=gridD.getRowData(idProd);var nvaCantidad=parseFloat(lstRow.MOVD_CANTIDAD)+parseFloat(Cantidad);if(parseInt(objInvTipo.value)==SALIDA||parseInt(objInvTipo.value)==TRASPASO||parseInt(objInvTipo.value)==TRASPASO_SALIDA){if(nvaCantidad>existenciaTemp){alert(lstMsg[3]+"("+nvaCantidad+") "+lstMsg[34]+strCod+"("+existenciaTemp+") "+lstMsg[4]);if(parseFloat(existenciaTemp)>0){nvaCantidad=existenciaTemp;}else{nvaCantidad=0;}}}if(lstRow.MOVD_USASERIE=="1"){entradaYsalida(newObjProd);}lstRow.MOVD_CANTIDAD=nvaCantidad;lstRowChangeCosto(lstRow,idProd,gridD);CleanCaptura();setSumInv();$("#dialogWait").dialog("close");}}}function AddItemInv(objProd,Pr_Id,Cantidad,strCod,dblExist){var objInvTipo=d.getElementById("INV_TIPO");var dblCosto=parseFloat(objProd.getAttribute("PR_COSTOCOMPRA"));if(parseInt(objInvTipo.value)==SALIDA||parseInt(objInvTipo.value)==TRASPASO||parseInt(objInvTipo.value)==TRASPASO_SALIDA){dblCosto=parseFloat(objProd.getAttribute("PR_COSTOPROM"));if(dblCosto==0){dblCosto=parseFloat(objProd.getAttribute("PR_COSTOCOMPRA"));}}else{if(dblCosto==0){dblCosto=parseFloat(d.getElementById("INV_COSTO").value);}}if(dblCosto==0){alert(lstMsg[35]);$("#dialogWait").dialog("close");d.getElementById("INV_PROD").focus();}else{var objImportes=new _ImporteMovAlm();objImportes.dblCantidad=Cantidad;objImportes.dblCosto=dblCosto;objImportes.CalculaImporte();var dblImporte=objImportes.dblImporte;var datarow={MOVD_ID:0,MOVD_FECHA_CAD:document.getElementById("INV_FECHA_CAD").value,MOVD_LOTE:document.getElementById("INV_LOTE").value,MOVD_CANTIDAD:Cantidad,MOVD_DESCRIPCION:objProd.getAttribute("PR_DESCRIPCION"),MOVD_IMPORTE:dblImporte,MOVD_CVE:strCod,MOVD_CODBARRAS:objProd.getAttribute("PR_CODBARRAS"),MOVD_COSTO:dblCosto,MOVD_PR_ID:Pr_Id,MOVD_REQEXIST:objProd.getAttribute("PR_REQEXIST"),MOVD_EXIST:dblExist,MOVD_NOSERIE:"",MOVD_IMPORTEREAL:dblImporte,MOVD_UNI_MED:objProd.getAttribute("PR_UNIDADMEDIDA"),MOVD_CATEGORIA1:objProd.getAttribute("CATEGO1"),MOVD_USASERIE:objProd.getAttribute("PR_USO_NOSERIE")};itemIdInv++;jQuery("#INV_GRID").addRowData(itemIdInv,datarow,"last");CleanCaptura();setSumInv();$("#dialogWait").dialog("close");}}function CleanCaptura(){d.getElementById("INV_DESC").value="";d.getElementById("INV_PROD").value="";d.getElementById("INV_PROD").focus();d.getElementById("INV_CANT").value=1;d.getElementById("INV_DEVO").value=0;d.getElementById("INV_COSTO").value=0;d.getElementById("INV_LOTE").value="";}function OpnDiagProdInv(){OpnOpt("PROD","grid","dialogProd",false,false);}function setSumInv(){var grid=jQuery("#INV_GRID");var arr=grid.getDataIDs();var dblSuma=0;for(var i=0;i<arr.length;i++){var id=arr[i];var lstRow=grid.getRowData(id);dblSuma+=parseFloat(lstRow.MOVD_CANTIDAD);}d.getElementById("INV_TOT").value=dblSuma;if(document.getElementById("INV_TIPO").value!=TRASPASO_ENTRADA){if(dblSuma>0){SelectInactive(d.getElementById("SC_ID"));}else{SelectActive(d.getElementById("SC_ID"));}}}function lstRowChangeCosto(lstRow,idUpdate,grid){var objImportes=new _ImporteMovAlm();objImportes.dblCantidad=parseFloat(lstRow.MOVD_CANTIDAD);objImportes.dblCosto=parseFloat(lstRow.MOVD_COSTO);objImportes.CalculaImporte();lstRow.MOVD_IMPORTE=objImportes.dblImporte;grid.setRowData(idUpdate,lstRow);setSumInv();}function _ImporteMovAlm(){this.dblImporte=0;this.dblCantidad=0;this.dblCosto=0;this.CalculaImporte=function CalculaImporte(){this.dblImporte=parseFloat(this.dblCantidad)*parseFloat(this.dblCosto);};}function InvDrop(){var grid=jQuery("#INV_GRID");if(grid.getGridParam("selrow")!=null){grid.delRowData(grid.getGridParam("selrow"));document.getElementById("INV_PROD").focus();setSumInv();}}function ResetOperaActualInv(){$("#dialogWait").dialog("open");
d.getElementById("INV_FOLIO").value="";d.getElementById("INV_NOTAS").value="";d.getElementById("INV_LOTE").value="";d.getElementById("INV_TOT").value="0.0";d.getElementById("INV_COSTO").value="0.0";d.getElementById("INV_PROD").focus();d.getElementById("INV_TIPO").value=ENTRADA;d.getElementById("INV_TRASORIGEN").value="0";d.getElementById("SC_ID2").value="0";SelectActive(d.getElementById("SC_ID"));var grid=jQuery("#INV_GRID");grid.clearGridData();$("#dialogWait").dialog("close");SelOperInv();}function SaveInv(){ValidaClean("INV_PROD");ValidaClean("SC_ID");ValidaClean("SC_ID2");var bolValida=true;if(parseFloat(document.getElementById("INV_TOT").value)==0){ValidaShowHD("INV_PROD",lstMsg[40]);document.getElementById("INV_PROD").focus();bolValida=false;}if(document.getElementById("SC_ID").value==0){ValidaShowHD("SC_ID",lstMsg[41]);document.getElementById("SC_ID").focus();bolValida=false;}if(document.getElementById("SC_ID2").value==0&&(document.getElementById("INV_TIPO").value==TRASPASO||document.getElementById("INV_TIPO").value==TRASPASO_SALIDA)){ValidaShowHD("SC_ID2",lstMsg[41]);document.getElementById("SC_ID2").focus();bolValida=false;}if(bolValida){$("#SioNO").dialog("option","title",lstMsg[39]);d.getElementById("Operac").value="Save";document.getElementById("SioNO_inside").innerHTML="";$("#SioNO").dialog("open");}else{return;}}function SaveInvDo(){$("#dialogWait").dialog("open");var strPOST="INV_TIPO="+d.getElementById("INV_TIPO").value;strPOST+="&SC_ID="+d.getElementById("SC_ID").value;strPOST+="&SC_ID2="+d.getElementById("SC_ID2").value;strPOST+="&INV_FECHA="+d.getElementById("INV_FECHA").value;strPOST+="&INV_FOLIO="+d.getElementById("INV_FOLIO").value;strPOST+="&INV_NOTAS="+d.getElementById("INV_NOTAS").value;strPOST+="&INV_TRASORIGEN="+d.getElementById("INV_TRASORIGEN").value;strPOST+="&INV_TOT="+d.getElementById("INV_TOT").value;strPOST+="&TMP_ID="+d.getElementById("TMP_ID").value;var grid=jQuery("#INV_GRID");var arr=grid.getDataIDs();var intC=0;for(var i=0;i<arr.length;i++){var id=arr[i];var lstRow=grid.getRowData(id);intC++;strPOST+="&MOVD_CANTIDAD"+intC+"="+lstRow.MOVD_CANTIDAD;strPOST+="&MOVD_DESCRIPCION"+intC+"="+(lstRow.MOVD_DESCRIPCION);strPOST+="&MOVD_IMPORTE"+intC+"="+lstRow.MOVD_IMPORTE;strPOST+="&MOVD_CVE"+intC+"="+(lstRow.MOVD_CVE);strPOST+="&MOVD_COSTO"+intC+"="+lstRow.MOVD_COSTO;strPOST+="&MOVD_PR_ID"+intC+"="+lstRow.MOVD_PR_ID;strPOST+="&MOVD_REQEXIST"+intC+"="+lstRow.MOVD_REQEXIST;strPOST+="&MOVD_EXIST"+intC+"="+lstRow.MOVD_EXIST;strPOST+="&MOVD_NOSERIE"+intC+"="+lstRow.MOVD_NOSERIE;strPOST+="&MOVD_IMPORTEREAL"+intC+"="+lstRow.MOVD_IMPORTEREAL;strPOST+="&MOVD_NOTAS"+intC+"="+encode(lstRow.MOVD_NOTAS);strPOST+="&MOVD_FECHA_CAD"+intC+"="+lstRow.MOVD_FECHA_CAD;strPOST+="&MOVD_LOTE"+intC+"="+lstRow.MOVD_LOTE;}strPOST+="&COUNT_ITEM="+intC;$.ajax({type:"POST",data:encodeURI(strPOST),scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"InvMov.do?id=2",success:function(dato){dato=trim(dato);if(Left(dato,3)=="OK."){var strHtml2=CreaHidden("MP_ID",dato.replace("OK.",""));openReport("MOV_INV","PDF",strHtml2);ResetOperaActualInv();}else{alert(dato);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":pto9:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function clickVentanaInv(){$("#dialogPCaptura").dialog("open");$("#dialogPCaptura").dialog("option","title","PARRILLA DE CAPTURA");var strHTML="<td>Capture el modelo o clave corta:<input type='text' id = 'txtModelo'>";strHTML+="<td>"+CreaBoton("","btnAgregar","Agregar","BuscaModeloInv();","left",false,false);strHTML+="<div id='TablaP'>";strHTML+="</div>";strHTML+="Total de Piezas:<input type='text' id = 'TotalP' value='0.0' disabled>";strHTML+="<p><input type='hidden' id = 'TotalM' value='0.0' disabled></p>";strHTML+="<p><input type='hidden' id = 'Descuento' value='0.0' onBlur='CalculaValoresInv()'></p>";strHTML+="<p><input type='hidden' id = 'TotalSinIva' value='0.0' disabled></p>";strHTML+="<p><input type='hidden' id = 'IVA' value='0.0' disabled></p>";strHTML+="<p><input type='hidden' id = 'TotalaPagar' value='0.0' disabled></p>";strHTML+="<td>"+CreaBoton("","btnAceptar","Aceptar","AceptarBotonInv();","left",false,false);strHTML+="<td>&nbsp;</td>";strHTML+="<td>"+CreaBoton("","btnCancelar","Cancelar","CancelarBotonInv();","left",false,false);document.getElementById("dialogPCaptura_inside").innerHTML=strHTML;}function BuscaModeloInv(){var strPOST="strSC_ID="+document.getElementById("SC_ID").value;strPOST+="&Modelo="+document.getElementById("txtModelo").value;$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"VtasMov.do?id=24",success:function(datos){var objCodBar=datos.getElementsByTagName("Productos")[0];var lstProd=objCodBar.getElementsByTagName("Producto");if(objTabla==null){var divMaster=document.getElementById("TablaP");objTabla=new ctrlTabla(divMaster,1,0,0,"","Mitabla");objTabla.CreaTabla();var objFila=objTabla.AnadeFila("","","","");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("Modelo");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("Descripcion");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("Color");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("2/CH");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("4/M");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("6/G");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("8/EG");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("10/3M");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("12/6M");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("14/12M");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("16/18M");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("18/24M");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("UNI");var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido("Piezas");}for(var i=0;i<lstProd.length;i++,idT++){var obj=lstProd[i];var objFila=objTabla.AnadeFila("","","","");var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("idModelo"+idT,"text",10,obj.getAttribute("Modelo"),8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");objCelda.AnadeCeldaContenido(obj.getAttribute("Descripcion"));var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("idColor"+idT,"text",10,obj.getAttribute("Color"),8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("idCH"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("idM"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("idG"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("idXG"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("idRN"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("id3M"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");
var objControl=new Control("id6M"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("id12M"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("id18M"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("id24M"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("idPiezas"+idT,"text",10,"0",8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());var lstTallas=obj.getAttribute("Tallas").split(",");var objCelda=objFila.AnadeCelda("","","","");var objControl=new Control("idTallas"+idT,"hidden",10,lstTallas,8,"RecalculoInv()",false,true);objCelda.AnadeCeldaControl(objControl.CreaControl());for(var j=0;j<lstTallas.length;j++){var strTalla=lstTallas[j].toUpperCase();strTalla=strTalla.replace(" ","");switch(strTalla){case"2":case"CH":document.getElementById("idCH"+idT).disabled=false;break;case"4":case"M":document.getElementById("idM"+idT).disabled=false;break;case"6":case"G":document.getElementById("idG"+idT).disabled=false;break;case"8":case"EG":document.getElementById("idXG"+idT).disabled=false;break;case"10":case"3M":document.getElementById("idRN"+idT).disabled=false;break;case"12":case"6M":document.getElementById("id3M"+idT).disabled=false;break;case"14":case"12M":document.getElementById("id6M"+idT).disabled=false;break;case"16":case"18M":document.getElementById("id12M"+idT).disabled=false;break;case"18":case"24M":document.getElementById("id18M"+idT).disabled=false;break;case"UNI":document.getElementById("id24M"+idT).disabled=false;break;}}}numFilas=idT;document.getElementById("txtModelo").value="";document.getElementById("txtModelo").focus();},error:function(objeto,quepaso,otroobj){alert(":Series pto:"+objeto+" "+quepaso+" "+otroobj);}});}function AceptarBotonInv(){var strNombreCorto="";var strColor="";var strTalla="";var strTalla2="";var strCantidad="";for(var i=0;i<numFilas;i++){if(document.getElementById("idCH"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("idCH"+i).value+",";strTalla+="2,";strTalla2+="CH,";}if(document.getElementById("idM"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("idM"+i).value+",";strTalla+="4,";strTalla2+="M,";}if(document.getElementById("idG"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("idG"+i).value+",";strTalla+="6,";strTalla2+="G,";}if(document.getElementById("idXG"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("idXG"+i).value+",";strTalla+="8,";strTalla2+="EG,";}if(document.getElementById("idRN"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("idRN"+i).value+",";strTalla+="10,";strTalla2+="3M,";}if(document.getElementById("id3M"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("id3M"+i).value+",";strTalla+="12,";strTalla2+="6M,";}if(document.getElementById("id6M"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("id6M"+i).value+",";strTalla+="14,";strTalla2+="12M,";}if(document.getElementById("id12M"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("id12M"+i).value+",";strTalla+="16,";strTalla2+="18M,";}if(document.getElementById("id18M"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("id18M"+i).value+",";strTalla+="18,";strTalla2+="24M,";}if(document.getElementById("id24M"+i).value!=0){strNombreCorto+=document.getElementById("idModelo"+i).value+",";strColor+=document.getElementById("idColor"+i).value+",";strCantidad+=document.getElementById("id24M"+i).value+",";strTalla+="UNI,";strTalla2+="UNI,";}}var strPOST="&NombreCorto="+strNombreCorto;strPOST+="&Colores="+strColor;strPOST+="&Tallas="+strTalla;strPOST+="&Tallas2="+strTalla2;strPOST+="&Cantidad="+strCantidad;$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"VtasMov.do?id=26",success:function(datos){var lstXml=datos.getElementsByTagName("ElementosT")[0];var lstElementos=lstXml.getElementsByTagName("ElementoT");var bolFind=false;for(var i=0;i<lstElementos.length;i++){var obj2=lstElementos[i];var datarow={MOVD_ID:i,MOVD_CANTIDAD:parseFloat(obj2.getAttribute("CANTIDAD")),MOVD_DESCRIPCION:obj2.getAttribute("PR_DESCRIPCION"),MOVD_IMPORTE:obj2.getAttribute("PRECIO"),MOVD_CVE:obj2.getAttribute("PR_CODIGO"),MOVD_CODBARRAS:obj2.getAttribute("PR_CODBARRAS"),MOVD_COSTO:parseFloat(obj2.getAttribute("PR_COSTOCOMPRA")),MOVD_PR_ID:obj2.getAttribute("PR_ID"),MOVD_REQEXIST:obj2.getAttribute("PR_REQEXIST"),MOVD_EXIST:obj2.getAttribute("PR_EXISTENCIA"),MOVD_NOSERIE:"",MOVD_IMPORTEREAL:obj2.getAttribute("PRECIO")};itemId++;jQuery("#INV_GRID").addRowData(itemId,datarow,"last");bolFind=true;}if(!bolFind){}document.getElementById("INV_TOT").value=document.getElementById("TotalP").value;CancelarBotonInv();$("#dialogPCaptura").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":Series pto:"+objeto+" "+quepaso+" "+otroobj);}});}function CancelarBotonInv(){$("#dialogPCaptura").dialog("close");objTabla=null;numFilas=0;idT=0;}function RecalculoInv(){var TotalP=0;for(var i=0;i<numFilas;i++){var TotalPiezas=0;TotalPiezas+=parseFloat(document.getElementById("idCH"+i).value);TotalPiezas+=parseFloat(document.getElementById("idM"+i).value);TotalPiezas+=parseFloat(document.getElementById("idG"+i).value);TotalPiezas+=parseFloat(document.getElementById("idXG"+i).value);TotalPiezas+=parseFloat(document.getElementById("idRN"+i).value);TotalPiezas+=parseFloat(document.getElementById("id3M"+i).value);TotalPiezas+=parseFloat(document.getElementById("id6M"+i).value);TotalPiezas+=parseFloat(document.getElementById("id12M"+i).value);TotalPiezas+=parseFloat(document.getElementById("id18M"+i).value);TotalPiezas+=parseFloat(document.getElementById("id24M"+i).value);document.getElementById("idPiezas"+i).value=parseFloat(TotalPiezas);TotalP+=TotalPiezas;document.getElementById("TotalP").value=TotalP;}}function CalculaValoresInv(){var TotalsinIva=0;var Descuento=parseFloat(document.getElementById("Descuento").value);var Total=parseFloat(document.getElementById("TotalM").value);Descuento=Total*(Descuento/100);TotalsinIva=Total-Descuento;document.getElementById("TotalSinIva").value=TotalsinIva;var IVA=TotalsinIva*(0.16);document.getElementById("IVA").value=IVA;var TotalaPagar=TotalsinIva+IVA;document.getElementById("TotalaPagar").value=TotalaPagar;}function InvCapturaSerie(strCodigo,strDescripcion,intCantidad,idUpdate){$("#dialogInv").dialog("open");$("#dialogInv").dialog("option","title",lstMsg[107]+" - "+strCodigo+" "+strDescripcion+""+intCantidad);document.getElementById("dialogInv_inside").innerHTML="";var strHTML="<table border=0 cellpadding=0>";
strHTML+="<tr>";strHTML+="<td colspan=2>"+lstMsg[110]+"</td>";strHTML+="</tr>";strHTML+="<tr>";var intContaF=0;for(var i=1;i<=intCantidad;i++){if(i==intCantidad){strHTML+="<td>"+CreaTexto("","_Serie"+i,"",25,25,false,false,"ConfirmNoSerie","left",0,"",""," onkeydown='InvEvalSerieNext(event,this,"+idUpdate+","+intCantidad+")'",false,3,"")+"</td>";}else{strHTML+="<td>"+CreaTexto("","_Serie"+i,"",25,25,false,false,"_Serie"+(i+1),"left",0,"",""," onblur='InvEvalSerieScNext(event,this,"+idUpdate+","+intCantidad+")'",false,3,"")+"</td>";}intContaF++;if(intContaF==10){strHTML+="<br></tr>";strHTML+="<tr>";intContaF=0;}}strHTML+="</tr>";strHTML+="<tr>";strHTML+="<td>"+CreaBoton("","ConfirmNoSerie",lstMsg[111],"InvEntConfirmNumSerie("+idUpdate+","+intCantidad+");","left",false,false)+"</td>";strHTML+="<td>"+CreaBoton("","CancelNoSerie",lstMsg[112],"InvEntCancelNumSerie("+idUpdate+","+intCantidad+");","left",false,false)+"</td>";strHTML+="</tr>";strHTML+="</table>";document.getElementById("dialogInv_inside").innerHTML=strHTML;setTimeout("document.getElementById('_Serie1').focus();",1000);}function InvEntConfirmNumSerie(idUpdate,intCantidad){var grid=jQuery("#INV_GRID");var lstRow=grid.getRowData(idUpdate);var strlstSeries="";for(var i=1;i<=intCantidad;i++){strlstSeries+=$.trim(document.getElementById("_Serie"+i).value)+",";if(document.getElementById("_Serie"+i).value==""||document.getElementById("_Serie"+i).value.length==0){alert(lstMsg[113]+" "+lstRow.MOVD_CVE);document.getElementById("_Serie"+i).focus();return false;}if(document.getElementById("_Serie"+i).value!=""){for(var j=1;j<=intCantidad;j++){if(i!=j){if(document.getElementById("_Serie"+i).value==document.getElementById("_Serie"+j).value){alert(lstMsg[116]+":"+document.getElementById("_Serie"+j).value);return false;}}}}}$("#dialogWait").dialog("open");$.ajax({type:"POST",data:"PR_ID="+lstRow.MOVD_PR_ID+"&SERIE="+strlstSeries,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"InvMov.do?id=19",success:function(datos){if(trim(datos)=="OK"){lstRow.MOVD_CANTIDAD=parseFloat(lstRow.MOVD_CANTIDAD);lstRow.MOVD_NOSERIE=lstRow.MOVD_NOSERIE+strlstSeries;grid.setRowData(idUpdate,lstRow);$("#dialogWait").dialog("close");$("#dialogInv").dialog("close");return true;}else{alert(datos);$("#dialogWait").dialog("close");return false;}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":Recepcion Compras{Recep Prod}:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});return true;}function entradaYsalida(objProd){var grid=jQuery("#INV_GRID");var arr=grid.getDataIDs();var tipoMov=document.getElementById("INV_TIPO").value;var i=0;if(tipoMov==1|tipoMov==5){for(i=0;i<arr.length;i++){var id=arr[i];var lstRowUpdate=grid.getRowData(id);var intCant=parseFloat(lstRowUpdate.MOVD_CANTIDAD);InvCapturaSerie(lstRowUpdate.MOVD_CVE,lstRowUpdate.MOVD_DESCRIPCION,intCant,id);}}else{if(tipoMov==2|tipoMov==4){for(i=0;i<arr.length;i++){var idX=arr[i];var lstRowUpdate=grid.getRowData(idX);var intCant=0;if(parseFloat(lstRowUpdate.MOVD_CANTIDAD)>0){intCant=document.getElementById("INV_CANT").value;}else{intCant=parseFloat(lstRowUpdate.MOVD_CANTIDAD);}serieSalida(objProd,lstRowUpdate.MOVD_PR_ID,intCant,lstRowUpdate.MOVD_CVE,lstRowUpdate.MOVD_REQEXIST,lstRowUpdate.MOVD_NOSERIE,lstRowUpdate.MOVD_ID);}}}}function InvEntCancelNumSerie(){$("#dialogInv").dialog("close");}function InvEvalSerieNext(event,obj,idUpdate,intCantidad){if(event.keyCode==13){InvEntConfirmNumSerie(idUpdate,intCantidad);}}function InvEvalSerieScNext(event,obj,idUpdate,intCantidad){if(event.keyCode==13){InvEvalNumSerie(idUpdate,intCantidad);}}function InvEvalNumSerie(idUpdate,intCantidad){var grid=jQuery("#INV_GRID");var lstRow=grid.getRowData(idUpdate);var strlstSeries="";for(var i=1;i<=intCantidad;i++){strlstSeries+=document.getElementById("_Serie"+i).value+",";if(document.getElementById("_Serie"+i).value!=""){for(var j=1;j<=intCantidad;j++){if(i!=j){if(document.getElementById("_Serie"+i).value==document.getElementById("_Serie"+j).value){alert(lstMsg[116]+":"+document.getElementById("_Serie"+j).value);return false;}}}}}$("#dialogWait").dialog("open");$.ajax({type:"POST",data:"PR_ID="+lstRow.MOVD_PR_ID+"&SERIE="+strlstSeries,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"InvMov.do?id=19",success:function(datos){if(trim(datos)!="OK"){alert(datos);$("#dialogWait").dialog("close");return false;}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":Inventario Entrada {Recep Prod3}:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function serieSalida(objProd,Pr_Id,intCantidad,strCod,dblExist,strSeries,idProd){objeto=objProd;if(strSeries==null){strSeries="";}$.ajax({type:"POST",data:"PR_ID="+Pr_Id,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"InvMov.do?id=21",success:function(datos){var objCodBar=datos.getElementsByTagName("num_series")[0];var lstProd=objCodBar.getElementsByTagName("serie");var strOptionSelect="";for(i=0;i<lstProd.length;i++){var obj=lstProd[i];strOptionSelect+="<option value='"+obj.getAttribute("NO_SERIE")+"'>"+obj.getAttribute("NO_SERIE")+"</option>";}$("#dialog2").dialog("open");$("#dialog2").dialog("option","title",lstMsg[107]);var strHTML="<input type='hidden' id='_Pr_Id' value='"+Pr_Id+"'>";strHTML+="<input type='hidden' id='_Cantidad' value='"+intCantidad+"'>";strHTML+="<input type='hidden' id='_strCod' value='"+strCod+"'>";strHTML+="<input type='hidden' id='_dblExist' value='"+dblExist+"'>";strHTML+="<input type='hidden' id='_idProd' value='"+idProd+"'>";strHTML+="<table border=0 cellpadding=0>";strHTML+="<tr>";strHTML+="<td colspan=3>"+lstMsg[110]+"</td>";strHTML+="</tr>";strHTML+="<tr>";strHTML+="<td nowrap>&nbsp;"+lstMsg[172]+"<input type='text' id='search_cant' value='"+intCantidad+"' size='8' readonly disabled></td>";strHTML+="<td nowrap>&nbsp;</td>";strHTML+="<td nowrap>&nbsp;"+lstMsg[173]+"<input type='text' id='search_cant_sel' value='0' size='8' readonly disabled></td>";strHTML+="</tr>";strHTML+="<tr>";strHTML+="<td >"+lstMsg[174]+"<br><select id='series_origen' multiple>"+strOptionSelect+"</select></td>";strHTML+="<td ><input type='button' id='Agregar' value='"+lstMsg[176]+"' onclick='InvAgregaSerieX()'><br><input type='button' id='Quitar' value='"+lstMsg[177]+"' onClick='InvRemueveSerieX()'></td>";strHTML+="<td >"+lstMsg[175]+"<br><select id='series_destino' multiple ></select></td>";strHTML+="</tr>";strHTML+="<tr>";strHTML+="<td>"+CreaBoton("","ConfirmNoSerie1",lstMsg[111],"InvConfirmNumSerie();","left",false,false)+"</td>";strHTML+="<td>&nbsp;</td>";strHTML+="<td>"+CreaBoton("","CancelNoSerie2",lstMsg[112],"InvCancelNumSerie();","left",false,false)+"</td>";strHTML+="</tr>";strHTML+="</table>";document.getElementById("dialog2_inside").innerHTML=strHTML;},error:function(objeto,quepaso,otroobj){alert(":Series pto:"+objeto+" "+quepaso+" "+otroobj);}});}function InvAgregaSerieX(){var objSelOr=document.getElementById("series_origen");var objSelDest=document.getElementById("series_destino");var intXSurtir=parseInt(document.getElementById("search_cant").value);var intSurtido=parseInt(document.getElementById("search_cant_sel").value);for(var x=0;x<objSelOr.length;x++){if(objSelOr[x].selected){if(objSelDest.length+1<=intXSurtir){intSurtido++;document.getElementById("search_cant_sel").value=intSurtido;select_add(objSelDest,objSelOr[x].value,objSelOr[x].value);objSelOr.remove(x);}else{alert(lstMsg[178]);}}}}function InvRemueveSerieX(){var objSelOr=document.getElementById("series_origen");var objSelDest=document.getElementById("series_destino");var intSurtido=parseInt(document.getElementById("search_cant_sel").value);for(var x=0;x<objSelDest.length;x++){if(objSelDest[x].selected){intSurtido--;document.getElementById("search_cant_sel").value=intSurtido;select_add(objSelOr,objSelDest[x].value,objSelDest[x].value);
objSelDest.remove(x);}}}function InvCancelNumSerie(){$("#dialog2").dialog("close");_objProdTmpz=null;}function InvConfirmNumSerie(){var intXSurtir=parseInt(document.getElementById("search_cant").value);var intSurtido=parseInt(document.getElementById("search_cant_sel").value);if(intXSurtir==intSurtido){var objSelDest=document.getElementById("series_destino");var _idProd=document.getElementById("_idProd");var _strSeries="";for(var x=0;x<objSelDest.length;x++){_strSeries+=objSelDest[x].value+",";}$("#dialog2").dialog("close");var gridD=jQuery("#INV_GRID");var lstRow=gridD.getRowData(_idProd);lstRow.MOVD_CANTIDAD=parseFloat(lstRow.MOVD_CANTIDAD)+parseFloat(_Cantidad);lstRow.MOVD_NOSERIE=lstRow.MOVD_NOSERIE+_strSeries;if(lstRow.MOVD_REQEXIST==1){if(parseFloat(lstRow.MOVD_CANTIDAD)>parseFloat(lstRow.MOVD_REQEXIST)){alert(lstMsg[3]+" "+lstRow.MOVD_CVE+" "+lstMsg[4]);if(parseFloat(lstRow.MOVD_REQEXIST)>0){lstRow.MOVD_CANTIDAD=lstRow.MOVD_REQEXIST;}else{lstRow.MOVD_CANTIDAD=0;}}}$("#dialogWait").dialog("close");}else{alert(lstMsg[179]);}}