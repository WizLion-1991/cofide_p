function vta_cambio_precios(){}var _countTimePromoLoadJsLibPrecMas=0;function InitCambioPrecMas(){myLayout.close("west");myLayout.close("east");myLayout.close("south");myLayout.close("north");d.getElementById("btn1").setAttribute("class","Oculto");d.getElementById("btn1").setAttribute("className","Oculto");var strHtml="<ul>"+getMenuItem("SalirCamPrecMas();","Salir","images/ptovta/exitBig.png")+"</ul>";document.getElementById("TOOLBAR").innerHTML=strHtml;_LoadLibraryScriptPrecMas("vta_producto.js");}function _LoadLibraryScriptPrecMas(strNomLib){var strScript="if("+strNomLib.replace(".js","")+"){return true}else{return false}";var strFn=new Function(strScript);try{if(strFn()){}}catch(err){if(_countTimePromoLoadJsLibPrecMas==0){importa("javascript/"+strNomLib);}var delay=1;setTimeout("_LoadLibraryScriptPrecMas('"+strNomLib+"');",delay*1000);}}function AplicaCambio(){var a=confirm("Â¿Confirma que desea actualizar los precios?");if(a){var strPost="EMP_ID="+document.getElementById("PR_EMPRESA").value;strPost+="&SC_ID="+document.getElementById("VIEW_SUCURSAL").value;strPost+="&Codigo="+document.getElementById("PR_CODIGO").value;strPost+="&GpoPrec="+document.getElementById("PR_GRPPRE").value;strPost+="&PorUtilidad="+document.getElementById("PR_PORCAM").value;if(document.getElementById("PR_CAM1").checked){strPost+="&CambiarPorcUtilidad=1";}else{strPost+="&CambiarPorcUtilidad=0";}$.ajax({type:"POST",data:strPost,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"DamePrecio.do?id=5",success:function(datos){if(datos.substr(0,2)!="OK"){alert(datos);}else{alert(lstMsg[106]);}},error:function(objeto,quepaso,otroobj){alert("Cambios de precios: "+objeto+" "+quepaso+" "+otroobj);}});}}function SalirCamPrecMas(){myLayout.open("west");myLayout.open("east");myLayout.open("south");myLayout.open("north");document.getElementById("MainPanel").innerHTML="";var objMainFacPedi=objMap.getScreen("CAM_PRE");objMainFacPedi.bolActivo=false;objMainFacPedi.bolMain=false;objMainFacPedi.bolInit=false;objMainFacPedi.idOperAct=0;}function RefreshFiltroCamPrecMas(){$("#dialogWait").dialog("open");var strPost="EMP_ID="+document.getElementById("PR_EMPRESA").value;strPost+="&SC_ID="+document.getElementById("VIEW_SUCURSAL").value;strPost+="&Codigo="+document.getElementById("PR_CODIGO").value;strPost+="&GpoPrec="+document.getElementById("PR_GRPPRE").value;$.ajax({type:"POST",data:strPost,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_Producto.jsp?id=14",success:function(dato){var grid=jQuery("#PR_GRID");grid.clearGridData();var lstProd=dato.getElementsByTagName("prec");for(i=0;i<lstProd.length;i++){var obj=lstProd[i];var datarow={CPR_ID:obj.getAttribute("id"),CPR_COD:obj.getAttribute("cod"),CPR_DESC:obj.getAttribute("desc"),CPR_GRUPO:obj.getAttribute("grupo_prec"),CPR_PREC1:obj.getAttribute("p_tienda"),CPR_PREC2:obj.getAttribute("p_publico"),CPR_PREC3:obj.getAttribute("p_mayoreo"),CPR_PREC4:obj.getAttribute("p_distribucion"),CPR_PRECUSD1:obj.getAttribute("p_tienda_usd"),CPR_PRECUSD2:obj.getAttribute("p_publico_usd"),CPR_PRECUSD3:obj.getAttribute("p_mayoreo_usd"),CPR_PRECUSD4:obj.getAttribute("p_distribucion_usd"),CPR_UTIL1:obj.getAttribute("p_tienda_util"),CPR_UTIL2:obj.getAttribute("p_publico_util"),CPR_UTIL3:obj.getAttribute("p_mayoreo_util"),CPR_UTIL4:obj.getAttribute("p_distribucion_util")};grid.addRowData(obj.getAttribute("id"),datarow,"last");}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert("Cambios de precios list: "+objeto+" "+quepaso+" "+otroobj);}});}function OpenCalculoPrec(){var grid=jQuery("#PR_GRID");var arr=grid.getDataIDs();var intPrId=0;var strProdCod="";var strProdNom="";var dblPorTda=0;var dblPorPub=0;var dblPorMay=0;var dblPorDis=0;var dblPrecTda=0;var dblPrecPub=0;var dblPrecMay=0;var dblPrecDis=0;var dblPrecTdaUSD=0;var dblPrecPubUSD=0;var dblPrecMayUSD=0;var dblPrecDisUSD=0;var strGpoPrec="";if(grid.getGridParam("selrow")!=null){var lstRowAct=grid.getRowData(grid.getGridParam("selrow"));intPrId=lstRowAct.CPR_ID;strProdCod=lstRowAct.CPR_COD;strProdNom=lstRowAct.CPR_DESC;dblPorTda=lstRowAct.CPR_UTIL1;dblPorPub=lstRowAct.CPR_UTIL2;dblPorMay=lstRowAct.CPR_UTIL3;dblPorDis=lstRowAct.CPR_UTIL4;dblPrecTda=lstRowAct.CPR_PREC1;dblPrecPub=lstRowAct.CPR_PREC2;dblPrecMay=lstRowAct.CPR_PREC3;dblPrecDis=lstRowAct.CPR_PREC4;dblPrecTdaUSD=lstRowAct.CPR_PRECUSD1;dblPrecPubUSD=lstRowAct.CPR_PRECUSD2;dblPrecMayUSD=lstRowAct.CPR_PRECUSD3;dblPrecDisUSD=lstRowAct.CPR_PRECUSD4;strGpoPrec=lstRowAct.CPR_GRUPO;$.ajax({type:"POST",data:"PR_ID="+intPrId,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_Producto.jsp?id=15",success:function(dato){var lstProd=dato.getElementsByTagName("pc");for(i=0;i<lstProd.length;i++){var obj=lstProd[i];DrawCamPrecMasEdit(strProdCod,strProdNom,obj.getAttribute("NOM_MONEDA"),obj.getAttribute("PR_MONEDA_VTA"),obj.getAttribute("PR_COSTOREPOSICION"),obj.getAttribute("PR_FLETE"),obj.getAttribute("PR_VALORES"),obj.getAttribute("PR_DTA"),obj.getAttribute("PR_MADUANAL"),obj.getAttribute("PR_DPROVEEDOR"),obj.getAttribute("PR_TCAMBIO_PROV"),obj.getAttribute("PR_TCAMBIO_TDA"),dblPorTda,dblPorPub,dblPorMay,dblPorDis,dblPrecTda,dblPrecPub,dblPrecMay,dblPrecDis,dblPrecTdaUSD,dblPrecPubUSD,dblPrecMayUSD,dblPrecDisUSD,strGpoPrec);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert("Cambios de precios one: "+objeto+" "+quepaso+" "+otroobj);}});}}function DrawCamPrecMasEdit(strCodigo,strNombre,NOM_MONEDA,PR_MONEDA_VTA,PR_COSTOREPOSICION,PR_FLETE,PR_VALORES,PR_DTA,PR_MADUANAL,PR_DPROVEEDOR,PR_TCAMBIO_PROV,PR_TCAMBIO_TDA,PR_UTIL_TDA,PR_UTIL_PUB,PR_UTIL_MAY,PR_UTIL_DIS,PR_PREC_TDA,PR_PREC_PUB,PR_PREC_MAY,PR_PREC_DIS,PR_PREC_TDAUSD,PR_PREC_PUBUSD,PR_PREC_MAYUSD,PR_PREC_DISUSD,strGpoPrec){if(PR_MONEDA_VTA!=1){PR_PREC_TDA=PR_PREC_TDAUSD;PR_PREC_PUB=PR_PREC_PUBUSD;PR_PREC_MAY=PR_PREC_MAYUSD;PR_PREC_DIS=PR_PREC_DISUSD;}var strHtml="<div>";strHtml+="<table border=0>";strHtml+="<tr>";strHtml+="<td>"+lstMsg[212]+NOM_MONEDA;strHtml+="</td><td>";strHtml+="<input type=hidden name='PR_MONEDA_VTA' id='PR_MONEDA_VTA' value='"+PR_MONEDA_VTA+"'>";strHtml+="<input type=hidden name='PR_GPO_PREC_CAM' id='PR_GPO_PREC_CAM' value='"+strGpoPrec+"'>";strHtml+="</td>";strHtml+="<td colspan='2'>";strHtml+="</td>";strHtml+="</tr>";strHtml+="<tr>";strHtml+="<td>"+lstMsg[213];strHtml+="</td><td>";strHtml+="<input type=text name=PR_COSTOREPOSICION id=PR_COSTOREPOSICION value='"+PR_COSTOREPOSICION+"' size=15 maxlength=10 >";strHtml+="</td>";strHtml+="<td>"+lstMsg[250];strHtml+="</td><td>";strHtml+="<input type=text name=PR_UTIL_TDA id=PR_UTIL_TDA value='"+PR_UTIL_TDA+"'   size=15 maxlength=10 >";strHtml+="</td>";strHtml+="</tr>";strHtml+="<tr>";strHtml+="<td>"+lstMsg[214];strHtml+="</td><td>";strHtml+="<input type=text name=PR_FLETE id=PR_FLETE value='"+PR_FLETE+"' size=15 maxlength=10 >";strHtml+="</td>";strHtml+="<td>"+lstMsg[251];strHtml+="</td><td>";strHtml+="<input type=text name=PR_UTIL_PUB id=PR_UTIL_PUB value='"+PR_UTIL_PUB+"'   size=15 maxlength=10 >";strHtml+="</td>";strHtml+="</tr>";strHtml+="<tr>";strHtml+="<td>"+lstMsg[215];strHtml+="</td><td>";strHtml+="<input type=text name=PR_VALORES id=PR_VALORES value='"+PR_VALORES+"'  size=15 maxlength=10>";strHtml+="</td>";strHtml+="<td>"+lstMsg[252];strHtml+="</td><td>";strHtml+="<input type=text name=PR_UTIL_MAY id=PR_UTIL_MAY value='"+PR_UTIL_MAY+"'   size=15 maxlength=10 >";strHtml+="</td>";strHtml+="</tr>";strHtml+="<tr>";strHtml+="<td>"+lstMsg[216];strHtml+="</td><td>";strHtml+="<input type=text name=PR_DTA id=PR_DTA value='"+PR_DTA+"'  size=15 maxlength=10>";strHtml+="</td>";strHtml+="<td>"+lstMsg[253];strHtml+="</td><td>";strHtml+="<input type=text name=PR_UTIL_DIS id=PR_UTIL_DIS value='"+PR_UTIL_DIS+"'   size=15 maxlength=10 >";strHtml+="</td>";strHtml+="</tr>";strHtml+="<tr>";strHtml+="<td>"+lstMsg[217];
strHtml+="</td><td>";strHtml+="<input type=text name=PR_MADUANAL id=PR_MADUANAL value='"+PR_MADUANAL+"'  size=15 maxlength=10>";strHtml+="</td>";strHtml+="<td>"+lstMsg[254];strHtml+="</td><td>";strHtml+="<input type=text name=PR_PREC_TDA id=PR_PREC_TDA value='"+PR_PREC_TDA+"' readonly class='READONLY'  size=15 maxlength=10 >";strHtml+="<input type=hidden name='PR_PREC_TDA_CONV' id='PR_PREC_TDA_CONV' value='1'>";strHtml+="</td>";strHtml+="</tr>";strHtml+="<tr>";strHtml+="<td>"+lstMsg[218];strHtml+="</td><td>";strHtml+="<input type=text name=PR_DPROVEEDOR id=PR_DPROVEEDOR value='"+PR_DPROVEEDOR+"'  size=15 maxlength=10>";strHtml+="</td>";strHtml+="<td>"+lstMsg[255];strHtml+="</td><td>";strHtml+="<input type=text name=PR_PREC_PUB id=PR_PREC_PUB value='"+PR_PREC_PUB+"' readonly class='READONLY'  size=15 maxlength=10 >";strHtml+="<input type=hidden name='PPR_PREC_PUB_CONV' id='PR_PREC_PUB_CONV' value='1'>";strHtml+="</td>";strHtml+="</tr>";strHtml+="<tr>";strHtml+="<td>"+lstMsg[219];strHtml+="</td><td>";strHtml+="<input type=text name=PR_TCAMBIO_PROV id=PR_TCAMBIO_PROV value='"+PR_TCAMBIO_PROV+"'  size=15 maxlength=10>";strHtml+="</td>";strHtml+="<td>"+lstMsg[256];strHtml+="</td><td>";strHtml+="<input type=text name=PR_PREC_MAY id=PR_PREC_MAY value='"+PR_PREC_MAY+"' readonly class='READONLY'  size=15 maxlength=10 >";strHtml+="<input type=hidden name='PR_PREC_MAY_CONV' id='PR_PREC_MAY_CONV' value='1'>";strHtml+="</td>";strHtml+="</tr>";strHtml+="<tr>";strHtml+="<td>"+lstMsg[220];strHtml+="</td><td>";strHtml+="<input type=text name=PR_TCAMBIO_TDA id=PR_TCAMBIO_TDA value='"+PR_TCAMBIO_TDA+"'  size=15 maxlength=10>";strHtml+="</td>";strHtml+="<td>"+lstMsg[257];strHtml+="</td><td>";strHtml+="<input type=text name=PR_PREC_DIS id=PR_PREC_DIS value='"+PR_PREC_DIS+"' readonly class='READONLY'  size=15 maxlength=10 >";strHtml+="<input type=hidden name='PR_PREC_DIS_CONV' id='PR_PREC_DIS_CONV' value='1'>";strHtml+="</td>";strHtml+="</tr>";strHtml+="<tr>";strHtml+="<td  align=center>";strHtml+="<input type=button name=btn1_calc id=btn1_calc value='"+lstMsg[221]+"' onclick='CalculaCambPrecMas()'>";strHtml+="</td>";strHtml+="<td  align=center>";strHtml+="<input type=button name=btn2_calc id=btn2_calc value='"+lstMsg[31]+"' onclick='SaveCamPrecMas()'>";strHtml+="</td>";strHtml+="</tr>";strHtml+="</table>";strHtml+="<div>";document.getElementById("dialog2_inside").innerHTML=strHtml;$("#dialogWait").dialog("close");$("#dialog2").dialog("option","title",lstMsg[211]+" "+strCodigo+" "+strNombre);$("#dialog2").dialog("open");}function CalculaCambPrecMas(){var $costo_repo=document.getElementById("PR_COSTOREPOSICION").value;var $flete=document.getElementById("PR_FLETE").value;var $add_valores=document.getElementById("PR_VALORES").value;var $dta=document.getElementById("PR_DTA").value;var $manejo_aduanal=document.getElementById("PR_MADUANAL").value;var $descuento_prov=document.getElementById("PR_DPROVEEDOR").value;var $porc_utilidad=0;var intMonedaVta=document.getElementById("PR_MONEDA_VTA").value;$("#dialogWait").dialog("open");$.ajax({type:"POST",data:"",scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"DamePrecio.do?id=6",success:function(datos){var lstXml=datos.getElementsByTagName("formulas")[0];var lstFormula=lstXml.getElementsByTagName("formula");for(var i=0;i<lstFormula.length;i++){var obj=lstFormula[i];if(obj.getAttribute("sentencia")!=""){var _nvo_prec1=0;var strFormula="_nvo_prec1 = "+obj.getAttribute("sentencia");strFormula=replaceCaracterAll(strFormula,"$costo_repo",$costo_repo);strFormula=replaceCaracterAll(strFormula,"$flete",$flete);strFormula=replaceCaracterAll(strFormula,"$add_valores",$add_valores);strFormula=replaceCaracterAll(strFormula,"$dta",$dta);strFormula=replaceCaracterAll(strFormula,"$manejo_aduanal",$manejo_aduanal);strFormula=replaceCaracterAll(strFormula,"$descuento_prov",$descuento_prov);var $precioX=parseFloat(document.getElementById("PR_PREC_TDA").value);if(parseInt(obj.getAttribute("redondeo_calculo"))==1){if(parseInt(obj.getAttribute("redondeo"))==1){$precioX=redondeoDolares($precioX);}if(parseInt(obj.getAttribute("redondeo"))==2){$precioX=redondeoDolares($precioX);}}var $precioX2=parseFloat(document.getElementById("PR_PREC_PUB").value);if(parseInt(obj.getAttribute("redondeo_calculo"))==1){if(parseInt(obj.getAttribute("redondeo"))==1){$precioX2=redondeoDolares($precioX2);}if(parseInt(obj.getAttribute("redondeo"))==2){$precioX2=redondeoDolares($precioX2);}}var $precioX3=parseFloat(document.getElementById("PR_PREC_MAY").value);if(parseInt(obj.getAttribute("redondeo_calculo"))==1){if(parseInt(obj.getAttribute("redondeo"))==1){$precioX3=redondeoDolares($precioX3);}if(parseInt(obj.getAttribute("redondeo"))==2){$precioX3=redondeoDolares($precioX3);}}var $precioX4=parseFloat(document.getElementById("PR_PREC_DIS").value);if(parseInt(obj.getAttribute("redondeo_calculo"))==1){if(parseInt(obj.getAttribute("redondeo"))==1){$precioX4=redondeoDolares($precioX4);}if(parseInt(obj.getAttribute("redondeo"))==2){$precioX4=redondeoDolares($precioX4);}}strFormula=replaceCaracterAll(strFormula,"$precio1",$precioX);strFormula=replaceCaracterAll(strFormula,"$precio3",$precioX2);strFormula=replaceCaracterAll(strFormula,"$precio4",$precioX3);strFormula=replaceCaracterAll(strFormula,"$precio5",$precioX4);if(parseInt(obj.getAttribute("lp_id"))==1){$porc_utilidad=parseFloat(document.getElementById("PR_UTIL_TDA").value);strFormula=replaceCaracterAll(strFormula,"$porc_utilidad",$porc_utilidad);}if(parseInt(obj.getAttribute("lp_id"))==3){$porc_utilidad=parseFloat(document.getElementById("PR_UTIL_PUB").value);strFormula=replaceCaracterAll(strFormula,"$porc_utilidad",$porc_utilidad);}if(parseInt(obj.getAttribute("lp_id"))==4){$porc_utilidad=parseFloat(document.getElementById("PR_UTIL_MAY").value);strFormula=replaceCaracterAll(strFormula,"$porc_utilidad",$porc_utilidad);}if(parseInt(obj.getAttribute("lp_id"))==5){$porc_utilidad=parseFloat(document.getElementById("PR_UTIL_DIS").value);strFormula=replaceCaracterAll(strFormula,"$porc_utilidad",$porc_utilidad);}try{strFormula=replaceCaracterAll(strFormula,"$camb_proov",document.getElementById("PR_TCAMBIO_PROV").value);eval(strFormula);if(parseInt(obj.getAttribute("lp_id"))==1){_nvo_prec1=_nvo_prec1*parseFloat(document.getElementById("PR_TCAMBIO_TDA").value);document.getElementById("PR_PREC_TDA").value=_nvo_prec1;}if(parseInt(obj.getAttribute("lp_id"))==3){_nvo_prec1=_nvo_prec1*parseFloat(document.getElementById("PR_TCAMBIO_PROV").value);document.getElementById("PR_PREC_PUB").value=_nvo_prec1;}if(parseInt(obj.getAttribute("lp_id"))==4){_nvo_prec1=_nvo_prec1*parseFloat(document.getElementById("PR_TCAMBIO_PROV").value);document.getElementById("PR_PREC_MAY").value=_nvo_prec1;}if(parseInt(obj.getAttribute("lp_id"))==5){_nvo_prec1=_nvo_prec1*parseFloat(document.getElementById("PR_TCAMBIO_PROV").value);document.getElementById("PR_PREC_DIS").value=_nvo_prec1;}}catch(error){alert("Error al ejecutar la formula para el calculo del precio:"+error);}}}for(var i=0;i<lstFormula.length;i++){var obj=lstFormula[i];if(obj.getAttribute("sentencia")!=""){if(parseInt(intMonedaVta)==1||parseInt(obj.getAttribute("conversion"))==0){var dblXRedondear=parseFloat(document.getElementById("PR_PREC_TDA").value);if(parseInt(obj.getAttribute("lp_id"))==3){dblXRedondear=parseFloat(document.getElementById("PR_PREC_PUB").value);}if(parseInt(obj.getAttribute("lp_id"))==4){dblXRedondear=parseFloat(document.getElementById("PR_PREC_MAY").value);}if(parseInt(obj.getAttribute("lp_id"))==5){dblXRedondear=parseFloat(document.getElementById("PR_PREC_DIS").value);}if(parseInt(obj.getAttribute("redondeo"))==1){dblXRedondear=redondeoPesos(dblXRedondear);}if(parseInt(obj.getAttribute("redondeo"))==2){dblXRedondear=redondeoDolares(dblXRedondear);}if(parseInt(obj.getAttribute("lp_id"))==1){document.getElementById("PR_PREC_TDA").value=FormatNumber(dblXRedondear,intNumdecimal,true);document.getElementById("PR_PREC_TDA_CONV").value=parseInt(obj.getAttribute("conversion"));
}if(parseInt(obj.getAttribute("lp_id"))==3){document.getElementById("PR_PREC_PUB").value=FormatNumber(dblXRedondear,intNumdecimal,true);document.getElementById("PR_PREC_PUB_CONV").value=parseInt(obj.getAttribute("conversion"));}if(parseInt(obj.getAttribute("lp_id"))==4){document.getElementById("PR_PREC_MAY").value=FormatNumber(dblXRedondear,intNumdecimal,true);document.getElementById("PR_PREC_MAY_CONV").value=parseInt(obj.getAttribute("conversion"));}if(parseInt(obj.getAttribute("lp_id"))==5){document.getElementById("PR_PREC_DIS").value=FormatNumber(dblXRedondear,intNumdecimal,true);document.getElementById("PR_PREC_DIS_CONV").value=parseInt(obj.getAttribute("conversion"));}}else{var dblXRedondear=parseFloat(document.getElementById("PR_PREC_TDA").value);document.getElementById("PR_PREC_TDA_CONV").value=parseInt(obj.getAttribute("conversion"));if(parseInt(obj.getAttribute("lp_id"))==3){dblXRedondear=parseFloat(document.getElementById("PR_PREC_PUB").value);document.getElementById("PR_PREC_PUB_CONV").value=parseInt(obj.getAttribute("conversion"));}if(parseInt(obj.getAttribute("lp_id"))==4){dblXRedondear=parseFloat(document.getElementById("PR_PREC_MAY").value);document.getElementById("PR_PREC_MAY_CONV").value=parseInt(obj.getAttribute("conversion"));}if(parseInt(obj.getAttribute("lp_id"))==5){dblXRedondear=parseFloat(document.getElementById("PR_PREC_DIS").value);document.getElementById("PR_PREC_DIS_CONV").value=parseInt(obj.getAttribute("conversion"));}if(parseInt(obj.getAttribute("redondeo"))==1){dblXRedondear=redondeoPesos(dblXRedondear);}if(parseInt(obj.getAttribute("redondeo"))==2){dblXRedondear=redondeoDolares(dblXRedondear);}if(parseInt(obj.getAttribute("lp_id"))==1){document.getElementById("PR_PREC_TDA").value=FormatNumber(dblXRedondear,intNumdecimal,true);}if(parseInt(obj.getAttribute("lp_id"))==3){document.getElementById("PR_PREC_PUB").value=FormatNumber(dblXRedondear,intNumdecimal,true);}if(parseInt(obj.getAttribute("lp_id"))==4){document.getElementById("PR_PREC_MAY").value=FormatNumber(dblXRedondear,intNumdecimal,true);}if(parseInt(obj.getAttribute("lp_id"))==5){document.getElementById("PR_PREC_DIS").value=FormatNumber(dblXRedondear,intNumdecimal,true);}}}}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert("Cambios de precios formulas: "+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function SaveCamPrecMas(){var grid=jQuery("#PR_GRID");var arr=grid.getDataIDs();var strPost="";var iContador=0;var strPreciosGpo=document.getElementById("PR_GPO_PREC_CAM").value;for(var j=0;j<arr.length;j++){var id=arr[j];var lstRowAct=grid.getRowData(id);if(strPreciosGpo==lstRowAct.CPR_GRUPO){iContador++;strPost+="&PR_ID"+iContador+"="+lstRowAct.CPR_ID;if(document.getElementById("PR_MONEDA_VTA").value==1||document.getElementById("PR_PREC_TDA_CONV").value==0){strPost+="&P1"+iContador+"="+document.getElementById("PR_PREC_TDA").value;strPost+="&PUSD1"+iContador+"=0";}else{strPost+="&P1"+iContador+"=0";strPost+="&PUSD1"+iContador+"="+document.getElementById("PR_PREC_TDA").value;}if(document.getElementById("PR_MONEDA_VTA").value==1||document.getElementById("PR_PREC_PUB_CONV").value==0){strPost+="&P2"+iContador+"="+document.getElementById("PR_PREC_PUB").value;strPost+="&PUSD2"+iContador+"=0";}else{strPost+="&P2"+iContador+"=0";strPost+="&PUSD2"+iContador+"="+document.getElementById("PR_PREC_PUB").value;}if(document.getElementById("PR_MONEDA_VTA").value==1||document.getElementById("PR_PREC_MAY_CONV").value==0){strPost+="&P3"+iContador+"="+document.getElementById("PR_PREC_MAY").value;strPost+="&PUSD3"+iContador+"=0";}else{strPost+="&P3"+iContador+"=0";strPost+="&PUSD3"+iContador+"="+document.getElementById("PR_PREC_MAY").value;}if(document.getElementById("PR_MONEDA_VTA").value==1||document.getElementById("PR_PREC_DIS_CONV").value==0){strPost+="&P4"+iContador+"="+document.getElementById("PR_PREC_DIS").value;strPost+="&PUSD4"+iContador+"=0";}else{strPost+="&P4"+iContador+"=0";strPost+="&PUSD4"+iContador+"="+document.getElementById("PR_PREC_DIS").value;}strPost+="&PCOSTO_REPO"+iContador+"="+document.getElementById("PR_COSTOREPOSICION").value;strPost+="&PFLETE"+iContador+"="+document.getElementById("PR_FLETE").value;strPost+="&PVALORES"+iContador+"="+document.getElementById("PR_VALORES").value;strPost+="&PDTA"+iContador+"="+document.getElementById("PR_DTA").value;strPost+="&PMADUANAL"+iContador+"="+document.getElementById("PR_MADUANAL").value;strPost+="&PDPROVEEDOR"+iContador+"="+document.getElementById("PR_DPROVEEDOR").value;strPost+="&DTCAMBIO_TDA"+iContador+"="+document.getElementById("PR_TCAMBIO_TDA").value;strPost+="&TCAMBIO_PROV"+iContador+"="+document.getElementById("PR_TCAMBIO_PROV").value;}}strPost="contador="+iContador+strPost;$.ajax({type:"POST",data:encodeURI(strPost),scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_Producto.jsp?id=16",success:function(dato){dato=trim(dato);if(Left(dato,2)=="OK"){alert(lstMsg[222]);RefreshFiltroCamPrecMas();$("#dialog2").dialog("close");$("#dialogWait").dialog("close");}else{alert(dato);$("#dialogWait").dialog("close");}},error:function(objeto,quepaso,otroobj){alert(":pto9:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}