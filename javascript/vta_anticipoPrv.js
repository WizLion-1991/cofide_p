function vta_anticipoPrv(){}function InitAntProv(){var strHtml="<ul>"+getMenuItem("AddDeposito();","Guardar Anticipo","images/ptovta/CircleSave.png")+getMenuItem("CallbtnPagAnticipoP3();","Salir","images/ptovta/exitBig.png")+"</ul>";document.getElementById("TOOLBAR").innerHTML=strHtml;RevisaMetodoPagoAntiPrv();d.getElementById("btn1").setAttribute("class","Oculto");d.getElementById("btn1").setAttribute("className","Oculto");}function OpnDiagProvCob(){OpnOpt("PROVEEDOR","grid","dialogProv",false,false);}function AddDeposito(){if(document.getElementById("BC_ID").value!=0){if(document.getElementById("PV_ID").value!="0"&&document.getElementById("PV_ID").value!=""){if(document.getElementById("BCO_MONEDA").value!=0){var Seleccion=parseInt(document.getElementById("FORM_PAGO").value);var strNoCheque=document.getElementById("NO_CHEQUE").value;var strRFC_tercero=document.getElementById("MPD_RFC_TERCEROS").value;var strBCO_Trans=document.getElementById("COB_BCO_TRANS").value;var strCTA_Trans=document.getElementById("COB_CTA_TRANS").value;if((Seleccion==2&&strNoCheque!="")||Seleccion!=2){$("#dialogPagos").dialog("open");var strFecha=document.getElementById("MC_FECHA").value;var idProveedor=document.getElementById("PV_ID").value;var dblAnticipo=document.getElementById("MC_ANTICIPO").value;var intMonedaBanco=document.getElementById("BCO_MONEDA").value;var dblTasaCambio=document.getElementById("TIPO_CAMBIO").value;var intBancoID=document.getElementById("BC_ID").value;var dblTasaCambioProveedor=document.getElementById("PARIDAD").value;var strPOST="&idTrx="+0;strPOST+="&intAnticipo="+1;strPOST+="&COUNT_PAGOS="+1;strPOST+="&MPD_MONEDA1="+intMonedaBanco;strPOST+="&MPD_FOLIO1=1";strPOST+="&MPD_FORMAPAGO1="+document.getElementById("FORM_PAGO").value;strPOST+="&MPD_NOCHEQUE1=0";strPOST+="&MPD_BANCO1="+(document.getElementById("BC_ID").value);strPOST+="&MPD_NOTARJETA1=0";strPOST+="&MPD_TIPOTARJETA1=0";strPOST+="&MPD_IMPORTE1="+parseFloat(dblAnticipo);strPOST+="&MPD_TASAPESO1="+dblTasaCambioProveedor;strPOST+="&MPD_CAMBIO1=0.0";strPOST+="&COMISION="+document.getElementById("AP_COMISION").value;strPOST+="&FECHA="+strFecha;strPOST+="&NOTAS="+"";strPOST+="&MONEDA="+intMonedaBanco;strPOST+="&TASAPESO="+dblTasaCambio;strPOST+="&MONTOPAGO="+dblAnticipo;strPOST+="&BC_ID="+intBancoID;strPOST+="&IdProv="+idProveedor;strPOST+="&TASAPROV="+dblTasaCambioProveedor;if(parseInt(document.getElementById("FORM_PAGO").value)==2){strPOST+="&MCB_NOCHEQUE="+strNoCheque;}else{if(parseInt(document.getElementById("FORM_PAGO").value)==6){strPOST+="&COB_BCO_TRANS="+strBCO_Trans;strPOST+="&COB_CTA_TRANS="+strCTA_Trans;strPOST+="&MPD_RFC_TERCEROS="+strRFC_tercero;}}$.ajax({type:"POST",data:encodeURI(strPOST),scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_CobrosCuentas.jsp?id=1",success:function(dato){if(Left(dato,3)=="OK."){var strFechaActual=trim(strHoyFecha);strFechaActual=Right(strFechaActual,2)+"/"+Mid(strFechaActual,5,2)+"/"+Left(strFechaActual,4);document.getElementById("MC_FECHA").value=strFechaActual;document.getElementById("PV_ID").value=0;document.getElementById("BCO_MONEDA").value=0;document.getElementById("PARIDAD").value=1;document.getElementById("BC_ID").value=0;document.getElementById("MC_ANTICIPO").value=0;document.getElementById("FORM_PAGO").value="";document.getElementById("CT_RAZONSOCIAL").value="";document.getElementById("MONTO_TOTAL").value=0;document.getElementById("AP_COMISION").value=0;document.getElementById("MPD_RFC_TERCEROS").value="";document.getElementById("COB_BCO_TRANS").value="";document.getElementById("COB_CTA_TRANS").value="";alert(lstMsg[237]);$("#dialogPagos").dialog("close");}else{alert(dato);$("#dialogPagos").dialog("close");}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":pto9:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}else{alert("Debe agregar un numero de cheque");document.getElementById("NO_CHEQUE").focus();}}else{alert("Debes seleccionar una Moneda");document.getElementById("BCO_MONEDA").focus();}}else{alert("Debe seleccionar un Proveedor");document.getElementById("PV_ID").focus();}}else{alert("Debe seleccionar un banco");document.getElementById("BC_ID").focus();}}function CambiaBanco(){var intBanco=parseInt(document.getElementById("BC_ID").value);var strPOST="&BC_ID="+intBanco;$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_CobrosCuentas.jsp?id=7",success:function(datos){document.getElementById("MONEDA_BANCO").value=datos;document.getElementById("BCO_MONEDA").value=datos;BuscaTasaCambio();},error:function(objeto,quepaso,otroobj){alert(":ptoExist:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function BuscaTasaCambio(){var intMonedaBanco=document.getElementById("BCO_MONEDA").value;var intMonedaSeleccionada=document.getElementById("MONEDA_BANCO").value;var strFECHA=document.getElementById("MC_FECHA").value;var strPOST="&Moneda_1="+intMonedaBanco;strPOST+="&Moneda_2="+intMonedaSeleccionada;strPOST+="&fecha="+strFECHA;$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_CobrosCuentas.jsp?id=9",success:function(datos){var objsc=datos.getElementsByTagName("TasaCambio")[0];var lstTiks=objsc.getElementsByTagName("TasaCambios");var obj=lstTiks[0];var dblTC=obj.getAttribute("TC");var strOperacion=obj.getAttribute("Operacion");document.getElementById("COB_OPERACION").value=strOperacion;if(dblTC==0){dblTC=1;}document.getElementById("TIPO_CAMBIO").value=dblTC;BuscaTasaCambioPagoProveedor();$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":ptoExist:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function ObtenNomProvAnt(){var strPV_ID=document.getElementById("PV_ID").value;var strPOST="&PV_ID="+strPV_ID;$("#dialogWait").dialog("open");$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_CobrosCuentas.jsp?id=11",success:function(datos){if(trim(datos)){var info=datos.split("|");document.getElementById("CT_RAZONSOCIAL").value=info[0];if(isNaN(info[1])){document.getElementById("MONEDA_PROVEEDOR").value=0;}else{document.getElementById("MONEDA_PROVEEDOR").value=info[1];}$("#dialogWait").dialog("close");BuscaTasaCambioPagoProveedor();}else{$("#dialogWait").dialog("close");}},error:function(objeto,quepaso,otroobj){alert(":ptoExist:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function BuscaTasaCambioPagoProveedor(){var intMonedaBanco=document.getElementById("BCO_MONEDA").value;var intMonedaSeleccionada=document.getElementById("MONEDA_PROVEEDOR").value;var strFECHA=document.getElementById("MC_FECHA").value;var strPOST="&Moneda_1="+intMonedaBanco;strPOST+="&Moneda_2="+intMonedaSeleccionada;strPOST+="&fecha="+strFECHA;if(intMonedaBanco==intMonedaSeleccionada){document.getElementById("PARIDAD").disabled=true;}else{document.getElementById("PARIDAD").disabled=false;}$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_CobrosCuentas.jsp?id=9",success:function(datos){var objsc=datos.getElementsByTagName("TasaCambio")[0];var lstTiks=objsc.getElementsByTagName("TasaCambios");var obj=lstTiks[0];var dblTC=obj.getAttribute("TC");var strOperacion=obj.getAttribute("Operacion");document.getElementById("COB_OPERACION").value=strOperacion;if(dblTC==0){dblTC=1;}document.getElementById("PARIDAD").value=dblTC;MontoTotalAntiPrv();},error:function(objeto,quepaso,otroobj){alert(":ptoExist:"+objeto+" "+quepaso+" "+otroobj);}});}function CallbtnPagAnticipoP3(){myLayout.open("west");myLayout.open("east");myLayout.open("south");myLayout.open("north");var objMainFacPedi=objMap.getScreen("ANTI");
objMainFacPedi.bolActivo=false;objMainFacPedi.bolMain=false;objMainFacPedi.bolInit=false;objMainFacPedi.idOperAct=0;document.getElementById("MainPanel").innerHTML="";}function RevisaMetodoPagoAntiPrv(){var Seleccion=parseInt(document.getElementById("FORM_PAGO").value);if(Seleccion==2){document.getElementById("NO_CHEQUE").parentNode.parentNode.style.display="block";}else{document.getElementById("NO_CHEQUE").value="";document.getElementById("NO_CHEQUE").parentNode.parentNode.style.display="none";}if(Seleccion==6){document.getElementById("COB_BCO_TRANS").parentNode.parentNode.style.display="block";document.getElementById("COB_CTA_TRANS").parentNode.parentNode.style.display="block";document.getElementById("MPD_RFC_TERCEROS").parentNode.parentNode.style.display="block";}else{document.getElementById("COB_BCO_TRANS").parentNode.parentNode.style.display="none";document.getElementById("COB_CTA_TRANS").parentNode.parentNode.style.display="none";document.getElementById("MPD_RFC_TERCEROS").parentNode.parentNode.style.display="none";document.getElementById("COB_BCO_TRANS").value="Seleccione";document.getElementById("COB_CTA_TRANS").value="";document.getElementById("MPD_RFC_TERCEROS").value="";}}function MontoTotalAntiPrv(){var strOperacion=document.getElementById("COB_OPERACION").value;var srtComision=document.getElementById("AP_COMISION").value;var dblTasaCambio=parseFloat(document.getElementById("PARIDAD").value);var dblMonto=parseFloat(document.getElementById("MC_ANTICIPO").value);var dblMontoBanco=parseFloat(document.getElementById("MC_ANTICIPO").value)+parseFloat(srtComision);if(strOperacion=="D"){dblTasaCambio=1/dblTasaCambio;}document.getElementById("MONTO_TOTAL").value=FormatNumber(dblMonto*dblTasaCambio,intNumdecimal,true);document.getElementById("AP_TOTAL_BANCO").value=FormatNumber(dblMontoBanco,intNumdecimal,true);}