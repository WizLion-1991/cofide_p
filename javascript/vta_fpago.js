function vta_fpago(){}function InitFPago(){FormStylePago();var strNomMain=objMap.getNomMain();if(strNomMain=="COBROS"){d.getElementById("TOTALXPAGAR").value=d.getElementById("COB_TOTAL").value;CargaAnticiposVentas();}else{if(parseInt(intEMP_TIPOPERS)==2&&intCT_TIPOPERS==1&&parseInt(d.getElementById("FAC_TIPO").value)==1){d.getElementById("TOTALXPAGAR").value=d.getElementById("FAC_NETO").value;CargaAnticiposVentas();}else{d.getElementById("TOTALXPAGAR").value=d.getElementById("FAC_TOT").value;CargaAnticiposVentas();}}d.getElementById("Ef_1").focus();}function FormStylePago(){d.getElementById("TOTALXPAGAR").setAttribute("class","ui-Total");d.getElementById("TOTALXPAGAR").setAttribute("className","ui-Total");d.getElementById("TOTALPAGADO").setAttribute("class","ui-Total");d.getElementById("TOTALPAGADO").setAttribute("className","ui-Total");}function AplicaelCredito(){}function AplicaEfectivo(){if(isNumber(d.getElementById("Ef_1").value)){var efectivo=parseFloat(d.getElementById("Ef_1").value);var TotalPago=parseFloat(d.getElementById("TOTALXPAGAR").value)-parseFloat(d.getElementById("TOTALPAGADO").value);d.getElementById("Ef_2").value=0;if(efectivo>TotalPago){d.getElementById("Ef_2").value=FormatNumber(efectivo-TotalPago,intNumdecimal,true);d.getElementById("FPago1").value=FormatNumber(TotalPago,intNumdecimal,true);}else{d.getElementById("FPago1").value=FormatNumber(parseFloat(d.getElementById("Ef_1").value),intNumdecimal,true);}}else{d.getElementById("FPago1").value=0;d.getElementById("Ef_1").value=0;}SumaPagos();}function AplicaCheque(){if(isNumber(d.getElementById("Bc_1").value)){d.getElementById("FPago2").value=d.getElementById("Bc_1").value;}else{d.getElementById("Bc_1").value=0;d.getElementById("FPago2").value=0;}d.getElementById("FPago1").value="0.0";SumaPagos();AplicaEfectivo();}function AplicaTC(){if(isNumber(d.getElementById("Tj_1").value)){d.getElementById("FPago3").value=d.getElementById("Tj_1").value;}else{d.getElementById("Tj_1").value=0;d.getElementById("FPago3").value=0;}d.getElementById("FPago1").value="0.0";SumaPagos();AplicaEfectivo();}function AplicaSaldo(){if(isNumber(d.getElementById("sf_1").value)){d.getElementById("FPago4").value=d.getElementById("sf_1").value;}else{d.getElementById("sf_1").value=0;d.getElementById("FPago4").value=0;}d.getElementById("FPago1").value="0.0";SumaPagos();AplicaEfectivo();}function AplicaTransf(){if(isNumber(d.getElementById("tf_1").value)){d.getElementById("FPago5").value=d.getElementById("tf_1").value;}else{d.getElementById("tf_1").value=0;d.getElementById("FPago5").value=0;}d.getElementById("FPago1").value="0.0";SumaPagos();AplicaEfectivo();}function SumaPagos(){d.getElementById("TOTALPAGADO").value=parseFloat(d.getElementById("FPago1").value)+parseFloat(d.getElementById("FPago2").value)+parseFloat(d.getElementById("FPago3").value)+parseFloat(d.getElementById("FPago4").value)+parseFloat(d.getElementById("FPago5").value)+parseFloat(d.getElementById("FPago6").value);}function ValidaTotalPago(){var strAction="SaveVtaDo();";var strNomMain=objMap.getNomMain();if(strNomMain=="COBROS"){strAction="SaveCobDo();";}var strFnDoPago=new Function(strAction);var dblDev=parseFloat(d.getElementById("Ef_2").value);var dblxPagar=parseFloat(d.getElementById("TOTALXPAGAR").value);var dblPagado=parseFloat(d.getElementById("TOTALPAGADO").value);if(dblPagado>dblxPagar){alert(lstMsg[1]);}else{if(strNomMain=="COBROS"){strFnDoPago();}else{if((dblxPagar-dblPagado)>1){if(!d.getElementById("AplicaCredito1").checked){alert(lstMsg[2]);}else{strFnDoPago();}}else{strFnDoPago();}}}}function SaveCancel(){$("#dialogPagos").dialog("close");}function AplicaFicha(){if(isNumber(d.getElementById("Fd_1").value)){d.getElementById("FPago6").value=d.getElementById("Fd_1").value;}else{d.getElementById("Fd_1").value=0;d.getElementById("FPago6").value=0;}SumaPagos();}function CargaAnticiposVentas(){$("#dialogWait").dialog("open");var intCT=document.getElementById("FCT_ID").value;var intMonPago=1;var intMonDoc=1;var strPOST="CT_ID="+intCT;strPOST+="&MONEDAPAGO="+intMonPago;$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_Cobros.jsp?id=13",success:function(datos){var objsc=datos.getElementsByTagName("Anticipos")[0];var lstAnticipos=objsc.getElementsByTagName("Anticipo");$("#GRID_ANTIV").empty();if(lstAnticipos.length!=0){for(var i=0;i<lstAnticipos.length;i++){var obj=lstAnticipos[i];var strFecha=obj.getAttribute("MC_FECHA");var intMoneda=parseInt(obj.getAttribute("MC_MONEDA"));var txtMONEDA="";if(intMoneda==1){txtMONEDA="PESOS";}else{if(intMoneda==2){txtMONEDA="DOLARES";}else{if(intMoneda==3){txtMONEDA="EUROS";}}}strFecha=strFecha.substr(strFecha.length-2,strFecha.length)+"/"+strFecha.substr(4,2)+"/"+strFecha.substr(0,4);var datarow={ANTI_ID:obj.getAttribute("MC_ID"),ANTI_FECHA:strFecha,ANTI_ABONO:obj.getAttribute("MC_SALDO_ANTICIPO"),ANTI_FOLIO:obj.getAttribute("MC_FOLIO"),ANTI_MONEDA:obj.getAttribute("MC_MONEDA"),ANTI_TASAPESO:obj.getAttribute("MC_TASAPESO"),ANTI_ORIGINAL:obj.getAttribute("MC_ANTICIPO_ORIGINAL"),ANTI_MONEDA_LETRA:txtMONEDA};jQuery("#GRID_ANTIV").addRowData(i,datarow,"last");}}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":ptoExist:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function SelectAnticipoGrid(){var dblCantPagar=parseFloat(document.getElementById("TOTALXPAGAR").value);var dblTotal=0;var grid1=jQuery("#GRID_ANTIV");var lista=grid1.getGridParam("selarrrow");for(i=0;i<lista.length;i++){var idlast=lista[i];var lstRow=grid1.getRowData(idlast);dblTotal+=parseFloat(lstRow.ANTI_ABONO);}if(dblTotal>dblCantPagar){document.getElementById("sf_1").value=dblCantPagar;document.getElementById("FPago4").value=dblCantPagar;}else{document.getElementById("sf_1").value=dblTotal;document.getElementById("FPago4").value=dblTotal;}d.getElementById("FPago1").value="0.0";SumaPagos();AplicaEfectivo();}