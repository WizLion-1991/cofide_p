function vta_facturacion_contratos(){}function InitFacCon(){document.getElementById("btn1").setAttribute("class","Oculto");}function doXML(){var itemIdCob=0;var totalM1=0;var totalM2=0;var totalM3=0;var totalM4=0;var totalM5=0;var totalM6=0;var totalM7=0;var totalM8=0;var totalM9=0;var totalM10=0;var totalM11=0;var totalM12=0;var total_Importe=0;var strPOST="";var strPeriodo=document.getElementById("FAXCONT_PERIODO").value;$("#dialogWait").dialog("open");strPOST+="&Parametro="+strPeriodo;$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"vta_facturacionMasiva.jsp?ID=1",success:function(datos){console.log("SUCCES");jQuery("#FAXCONT_GRID").clearGridData();var objsc=datos.getElementsByTagName("Total_por_Anio")[0];var lst=objsc.getElementsByTagName("ReporteAnual");console.log("Tama√±o del arreglo: "+lst.length);for(var i=0;i<lst.length;i++){var obj=lst[i];var muestraDatos={FACONT_MONEDA:obj.getAttribute("Moneda"),FACONT_NOMBRE:obj.getAttribute("Nombre"),FACONT_ARRENDAMIENTO:obj.getAttribute("ARRENDAMIENTO"),FACONT_CONTRATO:obj.getAttribute("Contrato"),FACONT_MES1:obj.getAttribute("MES1"),FACONT_MES2:obj.getAttribute("MES2"),FACONT_MES3:obj.getAttribute("MES3"),FACONT_MES4:obj.getAttribute("MES4"),FACONT_MES5:obj.getAttribute("MES5"),FACONT_MES6:obj.getAttribute("MES6"),FACONT_MES7:obj.getAttribute("MES7"),FACONT_MES8:obj.getAttribute("MES8"),FACONT_MES9:obj.getAttribute("MES9"),FACONT_MES10:obj.getAttribute("MES10"),FACONT_MES11:obj.getAttribute("MES11"),FACONT_MES12:obj.getAttribute("MES12"),FACONT_TOTALCONT:obj.getAttribute("TOTAL_CONTRATO")};totalM1=totalM1+parseFloat(obj.getAttribute("MES1"));totalM2=totalM2+parseFloat(obj.getAttribute("MES2"));totalM3=totalM3+parseFloat(obj.getAttribute("MES3"));totalM4=totalM4+parseFloat(obj.getAttribute("MES4"));totalM5=totalM5+parseFloat(obj.getAttribute("MES5"));totalM6=totalM6+parseFloat(obj.getAttribute("MES6"));totalM7=totalM7+parseFloat(obj.getAttribute("MES7"));totalM8=totalM8+parseFloat(obj.getAttribute("MES8"));totalM9=totalM9+parseFloat(obj.getAttribute("MES9"));totalM10=totalM10+parseFloat(obj.getAttribute("MES10"));totalM11=totalM11+parseFloat(obj.getAttribute("MES11"));totalM12=totalM12+parseFloat(obj.getAttribute("MES12"));total_Importe=total_Importe+parseFloat(obj.getAttribute("TOTAL_CONTRATO"));itemIdCob++;jQuery("#FAXCONT_GRID").footerData("set",{FACONT_MONEDA:"TOTAL:",FACONT_MES1:totalM1,FACONT_MES2:totalM2,FACONT_MES3:totalM3,FACONT_MES4:totalM4,FACONT_MES5:totalM5,FACONT_MES6:totalM6,FACONT_MES7:totalM7,FACONT_MES8:totalM8,FACONT_MES9:totalM9,FACONT_MES10:totalM10,FACONT_MES11:totalM11,FACONT_MES12:totalM12,FACONT_TOTALCONT:total_Importe});jQuery("#FAXCONT_GRID").addRowData(itemIdCob,muestraDatos,"last");}$("#dialogWait").dialog("close");},error:function(){$("#dialogWait").dialog("close");}});}function doXML_MES(){var itemIdCob=0;var total1=0;var strPOST="";var strANIO=document.getElementById("FACCONT_ANIO").value;var strMES=document.getElementById("FACCONT_MES").value;if(strMES==""){alert("Seleccione un mes");document.getElementById("FACCONT_MES").focus();}else{$("#dialogWait").dialog("open");strPOST+="&ANIO="+strANIO;strPOST+="&MES="+strMES;console.log(strPOST);$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"vta_facturacionMasiva.jsp?ID=2",success:function(datos){jQuery("#GRID_FACONT_MES").clearGridData();var objsc=datos.getElementsByTagName("Total_por_Mes")[0];var lst=objsc.getElementsByTagName("ReporteMensual");for(var i=0;i<lst.length;i++){var obj=lst[i];var muestraDatos={FACONT_NUMCONTRATO_MES:obj.getAttribute("NumeroContrato"),FACONT_MONEDA_MES:obj.getAttribute("Moneda"),FACONT_NOMBRE_MES:obj.getAttribute("Nombre"),FACONT_ARRENDAMIENTO_MES:obj.getAttribute("ARRENDAMIENTO"),FACONT_CONTRATO_MES:obj.getAttribute("Contrato"),FACONT_IMPORTE_MES:obj.getAttribute("MES1")};total1=total1+parseFloat(obj.getAttribute("MES1"));itemIdCob++;jQuery("#GRID_FACONT_MES").addRowData(itemIdCob,muestraDatos,"last");}jQuery("#GRID_FACONT_MES").footerData("set",{FACONT_MONEDA_MES:"TOTAL:",FACONT_IMPORTE_MES:total1});$("#dialogWait").dialog("close");},error:function(){$("#dialogWait").dialog("close");}});}}function BotonImprimirTF(){var strMES=document.getElementById("FACCONT_MES").value;if(strMES==""){alert("Seleccione un mes");document.getElementById("FACCONT_MES").focus();}else{OpnOpt("PPOL_CONT",null,"dialogProv",false,false,true);}}function BotonImprimirTFANIO(){OpnOpt("PPOL_CONT",null,"dialogProv",false,false,true);}function impRepPoLGeneradas(frmt){var strPOST="";var strANIO=document.getElementById("FACCONT_ANIO").value;var strMES=document.getElementById("FACCONT_MES").value;strPOST+="&ANIO="+strANIO;strPOST+="&MES="+strMES;if(strMES==""){if(frmt==1){Abrir_Link("vta_facturacionMasiva.jsp?ID=4&boton_1=PDF"+strPOST,500,600,0,0);$("#dialogProv").dialog("close");}else{Abrir_Link("vta_facturacionMasiva.jsp?ID=4&boton_1=XLS"+strPOST,500,600,0,0);$("#dialogProv").dialog("close");}}else{if(frmt==1){Abrir_Link("vta_facturacionMasiva.jsp?ID=3&boton_1=PDF"+strPOST,500,600,0,0);$("#dialogProv").dialog("close");}else{Abrir_Link("vta_facturacionMasiva.jsp?ID=3&boton_1=XLS"+strPOST,500,600,0,0);$("#dialogProv").dialog("close");}document.getElementById("FACCONT_MES").value="";}}