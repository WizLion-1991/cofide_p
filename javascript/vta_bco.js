function vta_bco(){}var intNumItem=0;function InitBco(){$("#dialogWait").dialog("open");$("#dialogWait").dialog("close");myLayout.close("west");myLayout.close("east");myLayout.close("south");myLayout.close("north");var strHtml="<ul>"+getMenuItem("BancoSave();","Guardar Banco","images/ptovta/CircleSave.png")+getMenuItem("CallbtnBc1();","Nuevo Movimiento","images/ptovta/VisPlus.png")+getMenuItem("CallbtnBc2();","Recuperar Movimiento","images/ptovta/VisMagnifier.png")+getMenuItem("CallbtnBc4();","Cambio Importe","images/ptovta/VisModi.png")+getMenuItem("CallbtnBc10();","Edo. de cuenta","images/ptovta/VisAccount.png")+getMenuItem("CallbtnBc3();","Borrar item","images/ptovta/VisClose.png")+getMenuItem("CallbtnBC9();","Salir","images/ptovta/exitBig.png")+"</ul>";document.getElementById("TOOLBAR").innerHTML=strHtml;FormStyleBco();InitBcoSIoNO();document.getElementById("BNK_BANCO1").parentNode.parentNode.style.display="none";document.getElementById("BNK_PARIDAD1").parentNode.parentNode.style.display="none";document.getElementById("BNK_CTA_DEST").parentNode.parentNode.style.display="none";document.getElementById("BNK_BCO_DEST").parentNode.parentNode.style.display="none";document.getElementById("BNK_TRASPASO2").checked=true;document.getElementById("btn1").style.display="none";}function InitBcoSIoNO(){document.getElementById("btnSI").onclick=function(){ConfirmaSIBco();};document.getElementById("btnNO").onclick=function(){ConfirmaNOBco();};}function EsTraspaso(){var Sichecked=document.getElementById("BNK_TRASPASO1").checked;if(Sichecked){document.getElementById("BNK_TIPOMOV1").disabled=true;document.getElementById("BNK_TIPOMOV2").checked=true;document.getElementById("BNK_BANCO1").parentNode.parentNode.style.display="block";document.getElementById("BNK_PARIDAD1").parentNode.parentNode.style.display="block";}else{document.getElementById("BNK_TIPOMOV1").disabled=false;document.getElementById("BNK_TIPOMOV1").checked=true;document.getElementById("BNK_BANCO1").parentNode.parentNode.style.display="none";document.getElementById("BNK_PARIDAD1").parentNode.parentNode.style.display="none";}}function CallbtnBC9(){$("#dialogWait").dialog("open");$("#dialogWait").dialog("close");myLayout.open("west");myLayout.open("east");myLayout.open("south");myLayout.open("north");document.getElementById("MainPanel").innerHTML="";var objMainFacPedi=objMap.getScreen("BANK");objMainFacPedi.bolActivo=false;objMainFacPedi.bolMain=false;objMainFacPedi.bolInit=false;objMainFacPedi.idOperAct=0;}function BancoADD(){var dblImporte=document.getElementById("BNK_IMPORTE").value;var objCC=document.getElementById("BNK_CCOSTO");var objCG=document.getElementById("BNK_CGASTO");var strNotas=UCase(document.getElementById("BNK_NOTAS").value);var intCC=objCC.value;var intCG=objCG.value;var bolPasaAdd=false;if(parseFloat(dblImporte)==0){var b=confirm(lstMsg[22]);if(b){bolPasaAdd=true;}}else{bolPasaAdd=true;}if(bolPasaAdd){var w=objCC.selectedIndex;var strCC=objCC.options[w].text;w=objCG.selectedIndex;var strCG=objCG.options[w].text;BancoAddItem(dblImporte,intCC,intCG,strCC,strCG,strNotas);BancoCleanItem();document.getElementById("BNK_CCOSTO").focus();}}function BancoAddItem(dblImporte,intCC,intCG,strCC,strCG,strNotas){var datarow={BNKD_ID:0,BNKD_IMPORTE:dblImporte,BNKD_NOMCCOSTOS:strCC,BNKD_NOMCGASTOS:strCG,BNKD_CCOSTOS:intCC,BNKD_CGASTOS:intCG,BNKD_NOTAS:strNotas};intNumItem++;jQuery("#BNK_GRID1").addRowData(intNumItem,datarow,"last");SumaBancos();}function BancoClean(){document.getElementById("BNK_CONCEPTO").value="";document.getElementById("BNK_BENEFICIARIO").value="";document.getElementById("BNK_NOCHEQUE").value="";document.getElementById("BNK_CONCILIADO2").checked=true;document.getElementById("BNK_TOTAL").value=0;document.getElementById("BNK_CCOSTO").value=0;document.getElementById("BNK_CGASTO").value=0;document.getElementById("BNK_ID").value=0;document.getElementById("BNK_IMPORTE").value=0;document.getElementById("BNK_NOTAS").value="";document.getElementById("BNK_PROV").checked=false;document.getElementById("BNK_CTE").checked=false;document.getElementById("BNK_TRASPASO2").checked=true;document.getElementById("BNK_BANCO1").value=0;document.getElementById("BNK_BCO_DEST").value="";document.getElementById("BNK_RFC_BENEFICIARIO").value="";document.getElementById("BNK_CTA_DEST").value="";document.getElementById("BNK_ESTRANSFERENCIA2").checked=true;jQuery("#BNK_GRID1").clearGridData();intNumItem=0;EsTraspaso();EsTransferencia();}function BancoCleanItem(){document.getElementById("BNK_CCOSTO").value=0;document.getElementById("BNK_CGASTO").value=0;document.getElementById("BNK_IMPORTE").value=0;document.getElementById("BNK_NOTAS").value="";}function BancoValida(){var bolRes=true;ValidaClean("BNK_BANCO");ValidaClean("BNK_FECHA");ValidaClean("BNK_CONCEPTO");ValidaClean("BNK_TOTAL");if(document.getElementById("BNK_BANCO").value==0){ValidaShow("BNK_BANCO",lstMsg[24]);bolRes=false;return bolRes;}if(document.getElementById("BNK_FECHA").value==""){ValidaShow("BNK_FECHA",lstMsg[25]);bolRes=false;return bolRes;}if(document.getElementById("BNK_CONCEPTO").value==""){ValidaShow("BNK_CONCEPTO",lstMsg[26]);bolRes=false;return bolRes;}if(document.getElementById("BNK_MONEDA").value==0){ValidaShow("BNK_MONEDA",lstMsg193);bolRes=false;return bolRes;}if(document.getElementById("BNK_PROV").checked==true){var dblImporte1=parseFloat(document.getElementById("IMPORTE_DEVOLVER").value);var dblImporte2=parseFloat(replaceCaracter(document.getElementById("BNK_TOTAL").value,","));var dblImporDiff=dblImporte2-dblImporte1;if(dblImporDiff>1){alert(lstMsg[223]);return false;}}if(document.getElementById("BNK_CTE").checked==true){var dblImporte1=parseFloat(document.getElementById("IMPORTE_DEVOLVER_CTE").value);var dblImporte2=parseFloat(replaceCaracter(document.getElementById("BNK_TOTAL").value,","));var dblImporDiff=dblImporte2-dblImporte1;if(dblImporDiff>1){alert(lstMsg[223]);return false;}}if(document.getElementById("BNK_ESTRANSFERENCIA1").checked==true){if(document.getElementById("BNK_RFC_BENEFICIARIO").value==""){alert("Se debe poner un RFC");return false;}}return bolRes;}function BancoSave(){if(BancoValida()){$("#dialogWait").dialog("open");var strPOST=encodeURI(getPOSTBco());$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"Bancos.do?id=1",success:function(dato){dato=trim(dato);if(Left(dato,3)=="OK."){openFormat("BANCOS","PDF",CreaHidden("MCB_ID",dato.replace("OK.","")));BancoClean();}else{alert(dato);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":pto9:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}}function getPOSTBco(){var dblImporte=replaceCaracter(document.getElementById("BNK_TOTAL").value,",");var strPOST="";strPOST+="MCB_ID="+document.getElementById("BNK_ID").value;strPOST+="&BC_ID="+document.getElementById("BNK_BANCO").value;strPOST+="&MCB_FECHA="+document.getElementById("BNK_FECHA").value;strPOST+="&MCB_CONCEPTO="+encodeURIComponent(document.getElementById("BNK_CONCEPTO").value);strPOST+="&MCB_BENEFICIARIO="+encodeURIComponent(document.getElementById("BNK_BENEFICIARIO").value);strPOST+="&MCB_NOCHEQUE="+document.getElementById("BNK_NOCHEQUE").value;strPOST+="&MCB_MONEDA="+document.getElementById("BNK_MONEDA").value;strPOST+="&MCB_PARIDAD="+document.getElementById("BNK_PARIDAD").value;strPOST+="&MCB_CONCILIADO="+((document.getElementById("BNK_CONCILIADO1").checked)?1:0);strPOST+="&MCB_TIPO1="+((document.getElementById("MCB_TIPO1").checked)?1:0);strPOST+="&MCB_TIPO2="+((document.getElementById("MCB_TIPO2").checked)?1:0);strPOST+="&MCB_TIPO3="+((document.getElementById("MCB_TIPO3").checked)?1:0);strPOST+="&MCB_FECENTREGA="+document.getElementById("BNK_FECENTREGADOC").value;strPOST+="&MCB_NOTAS_ENT="+encodeURIComponent(document.getElementById("BNK_NOTAS_ENT").value);strPOST+=((document.getElementById("BNK_TIPOMOV1").checked)?"&MCB_DEPOSITO="+dblImporte:"&MCB_RETIRO="+dblImporte);strPOST+="&BNK_CTA_DEST="+encodeURIComponent(document.getElementById("BNK_CTA_DEST").value);
strPOST+="&BNK_BCO_DEST="+encodeURIComponent(document.getElementById("BNK_BCO_DEST").value);strPOST+="&BNK_RFC_BENEFICIARIO="+encodeURIComponent(document.getElementById("BNK_RFC_BENEFICIARIO").value);if(document.getElementById("BNK_ESTRANSFERENCIA1").checked){strPOST+="&BNK_ESTRANSFERENCIA="+1;}var grid=jQuery("#BNK_GRID1");var arr=grid.getDataIDs();for(var i=0;i<arr.length;i++){var id=arr[i];var lstRow=grid.getRowData(id);strPOST+="&CC_ID="+lstRow.BNKD_CCOSTOS;strPOST+="&GT_ID="+lstRow.BNKD_CGASTOS;strPOST+="&MCBD_IMPORTE="+lstRow.BNKD_IMPORTE;strPOST+="&MCBD_CONCEPTO="+lstRow.BNKD_NOTAS;}if(document.getElementById("BNK_PROV").checked==true){strPOST+="&MCB_DEV_PROV="+document.getElementById("ID_PROV").value;strPOST+="&ID_ANTICIPOPROV="+document.getElementById("ID_ANTICIPO").value;strPOST+="&TASA_CAMBIO_ANTI="+document.getElementById("TASA_CAMBIO").value;strPOST+="&IMPORTE_DEVOLVER="+document.getElementById("IMPORTE_DEVOLVER").value;}if(document.getElementById("BNK_CTE").checked==true){strPOST+="&MCB_DEV_CLIE="+document.getElementById("ID_CTE").value;strPOST+="&ID_ANTICIPO_CLIE="+document.getElementById("ID_ANTICIPO_CTE").value;strPOST+="&TASA_CAMBIO_ANTI_CLIE="+document.getElementById("TASA_CAMBIO_CTE").value;strPOST+="&IMPORTE_DEVOLVER_CLIE="+document.getElementById("IMPORTE_DEVOLVER_CTE").value;}strPOST+="&MCB_TRASPASO="+((document.getElementById("BNK_TRASPASO1").checked)?1:0);strPOST+="&BC_ID2="+document.getElementById("BNK_BANCO1").value;strPOST+="&MCB_PARIDAD2="+document.getElementById("BNK_PARIDAD1").value;strPOST+="&MCB_TRAS_ORIGEN="+document.getElementById("BNK_ID").value;return strPOST;}function BancoSaveDo(){}function BancoPrint(){var grid=jQuery("#BANK_VIEW");var idRow=grid.getGridParam("selrow");if(idRow!=null){openFormat("BANCOS","PDF",CreaHidden("MCB_ID",idRow));}}function BancoAnul(){var grid=jQuery("#BANK_VIEW");var idRow=grid.getGridParam("selrow");if(idRow!=null){var lstRow=grid.getRowData(idRow);if(lstRow.MCB_ANULADO=="NO"){document.getElementById("SioNO_inside").innerHTML="";$("#SioNO").dialog("open");$("#SioNO").dialog("option","title",lstMsg[32]);document.getElementById("btnSI").onclick=function(){$("#SioNO").dialog("close");BancoAnulDo();};document.getElementById("btnNO").onclick=function(){$("#SioNO").dialog("close");};}}}function BancoAnulDo(){var grid=jQuery("#BANK_VIEW");var idRow=grid.getGridParam("selrow");if(idRow!=null){$("#dialogWait").dialog("open");$.ajax({type:"POST",data:"MCB_ID="+idRow,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"Bancos.do?id=2",success:function(dato){dato=trim(dato);if(Left(dato,2)=="OK"){grid.trigger("reloadGrid");}else{alert(dato);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":ccaja:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}}function BancoConci(){var grid=jQuery("#BANK_VIEW");var idRow=grid.getGridParam("selrow");if(idRow!=null){var lstRow=grid.getRowData(idRow);if(lstRow.MCB_ANULADO=="NO"){$("#dialogWait").dialog("open");var intConci=true;if(lstRow.MCB_CONCILIADO=="SI"){intConci=false;}$.ajax({type:"POST",data:"MCB_ID="+idRow+"&MCB_CONCILIADO="+intConci,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"Bancos.do?id=3",success:function(dato){dato=trim(dato);if(Left(dato,2)=="OK"){grid.trigger("reloadGrid");}else{alert(dato);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":ccaja:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}}}function BancoClienteNoIdent(){$("#dialogWait").dialog("open");var grid=jQuery("#BANK_VIEW");var idRow=grid.getGridParam("selrow");if(idRow!=null){var lstRow=grid.getRowData(idRow);if(lstRow.MCB_ANULADO=="NO"){if(lstRow.MCB_TIPO1=="SI"){OpnOpt("CLIENTES","grid","dialogCte",false,false);$("#dialogWait").dialog("close");}else{alert(lstMsg[190]);}}else{alert(lstMsg[189]);}}$("#dialogWait").dialog("close");}function setBancoClienteNoIdent(idCte){var grid=jQuery("#BANK_VIEW");var idRow=grid.getGridParam("selrow");if(idRow!=null){var lstRow=grid.getRowData(idRow);if(lstRow.MCB_ANULADO=="NO"){var strPOST="&idTrx="+0;strPOST+="&COUNT_PAGOS="+0;strPOST+="&FECHA="+lstRow.MCB_FECHA;strPOST+="&NOTAS="+"";strPOST+="&MONEDA="+1;strPOST+="&TASAPESO="+1;strPOST+="&MONTOPAGO="+lstRow.MCB_DEPOSITO;strPOST+="&IdCte="+idCte;strPOST+="&intAnticipo="+1;$("#dialogWait").dialog("open");$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_Cobros.jsp?id=1",success:function(dato){dato=trim(dato);if(Left(dato,2)=="OK"){grid.trigger("reloadGrid");BancoBolAnticipo(idRow);alert(lstMsg[245]);$("#dialogWait").dialog("close");}else{alert(dato);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":ccaja:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}else{alert(lstMsg[189]);}}$("#dialogWait").dialog("close");}function BancoBolAnticipo(idRow){var grid=jQuery("#BANK_VIEW");if(idRow!=null){var lstRow=grid.getRowData(idRow);$("#dialogWait").dialog("open");var intUsoDeposito=true;if(lstRow.MCB_TIPO1=="SI"){intUsoDeposito=false;}$.ajax({type:"POST",data:"MCB_ID="+idRow+"&MCB_TIPO1="+intUsoDeposito,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"Bancos.do?id=7",success:function(dato){dato=trim(dato);if(Left(dato,2)=="OK"){grid.trigger("reloadGrid");$("#dialogWait").dialog("close");}else{alert(dato);}},error:function(objeto,quepaso,otroobj){alert(":ccaja:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}$("#dialogWait").dialog("close");}function BancoEntregaDoc(){var grid=jQuery("#BANK_VIEW");var idRow=grid.getGridParam("selrow");if(idRow!=null){var lstRow=grid.getRowData(idRow);if(lstRow.MCB_ANULADO=="NO"){$("#dialogWait").dialog("open");var intEntrega=true;if(lstRow.MCB_TIPO2=="SI"){intEntrega=false;}$.ajax({type:"POST",data:"MCB_ID="+idRow+"&MCB_TIPO2="+intEntrega,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"Bancos.do?id=5",success:function(dato){dato=trim(dato);if(Left(dato,2)=="OK"){grid.trigger("reloadGrid");}else{alert(dato);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":ccaja:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}else{alert(lstMsg[189]);}}$("#dialogWait").dialog("close");}function BancoStatus3(){var grid=jQuery("#BANK_VIEW");var idRow=grid.getGridParam("selrow");if(idRow!=null){var lstRow=grid.getRowData(idRow);if(lstRow.MCB_ANULADO=="NO"){$("#dialogWait").dialog("open");var intStatus3=true;if(lstRow.MCB_TIPO3=="SI"){intStatus3=false;}$.ajax({type:"POST",data:"MCB_ID="+idRow+"&MCB_TIPO3="+intStatus3,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"Bancos.do?id=6",success:function(dato){dato=trim(dato);if(Left(dato,2)=="OK"){grid.trigger("reloadGrid");}else{alert(dato);}$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":ccaja:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}else{alert(lstMsg[189]);}}$("#dialogWait").dialog("close");}function BancoEdit(){var grid=jQuery("#BANK_VIEW");var idRow=grid.getGridParam("selrow");if(idRow!=null){var lstRow=grid.getRowData(idRow);if(lstRow.MCB_ANULADO=="NO"){BancoClean();var strNomMain=objMap.getNomMain();if(strNomMain=="BANK"){$.ajax({type:"POST",data:"MCB_ID="+idRow,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"Bancos.do?id=4",success:function(dato){setInitMov(dato);},error:function(objeto,quepaso,otroobj){alert(":ccaja:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}}}}function setInitMov(uXml){var objsc=uXml.getElementsByTagName("movbco")[0];
if(objsc.getAttribute("MCB_CONCILIADO")==1){document.getElementById("BNK_CONCILIADO1").checked=true;}else{document.getElementById("BNK_CONCILIADO2").checked=true;}document.getElementById("BNK_BANCO").value=objsc.getAttribute("BC_ID");document.getElementById("BNK_FECHA").value=ObtenFecha(objsc.getAttribute("MCB_FECHA"));document.getElementById("BNK_CONCEPTO").value=objsc.getAttribute("MCB_CONCEPTO");document.getElementById("BNK_BENEFICIARIO").value=objsc.getAttribute("MCB_BENEFICIARIO");document.getElementById("BNK_NOCHEQUE").value=objsc.getAttribute("MCB_NOCHEQUE");document.getElementById("BNK_ID").value=objsc.getAttribute("MCB_ID");if(objsc.getAttribute("MCB_DEPOSITO")>0){document.getElementById("BNK_TIPOMOV1").checked=true;}else{document.getElementById("BNK_TIPOMOV2").checked=true;}document.getElementById("BNK_NOTAS_ENT").value=objsc.getAttribute("MCB_NOTAS_ENT");if(objsc.getAttribute("MCB_TIPO1")==1){document.getElementById("MCB_TIPO1").checked=true;}else{document.getElementById("MCB_TIPO1").checked=false;}if(objsc.getAttribute("MCB_TIPO2")==1){document.getElementById("MCB_TIPO2").checked=true;}else{document.getElementById("MCB_TIPO2").checked=false;}if(objsc.getAttribute("MCB_TIPO3")==1){document.getElementById("MCB_TIPO3").checked=true;}else{document.getElementById("MCB_TIPO3").checked=false;}if(objsc.getAttribute("MCB_DEV_PROV")==1){document.getElementById("BNK_PROV").checked=true;}else{document.getElementById("BNK_PROV").checked=false;}if(objsc.getAttribute("MCB_DEV_CLIE")==1){document.getElementById("BNK_CTE").checked=true;}else{document.getElementById("BNK_CTE").checked=false;}if(objsc.getAttribute("MCB_ES_TRASPASO")==1){document.getElementById("BNK_ESTRANSFERENCIA1").checked=true;}else{document.getElementById("BNK_ESTRANSFERENCIA1").checked=false;}EsTransferencia();document.getElementById("BNK_BCO_DEST").value=objsc.getAttribute("RBK_CVE");document.getElementById("BNK_CTA_DEST").value=objsc.getAttribute("MCB_CTA_DESTINO");var ctrl=objsc.getElementsByTagName("movdeta");for(var i=0;i<ctrl.length;i++){var obj=ctrl[i];var MCBD_CONCEPTO=obj.getAttribute("MCBD_CONCEPTO");var MCBD_IMPORTE=obj.getAttribute("MCBD_IMPORTE");var GT_ID=obj.getAttribute("GT_ID");var CC_ID=obj.getAttribute("CC_ID");var GT_DESC=obj.getAttribute("GT_DESC");var CC_DESC=obj.getAttribute("CC_DESC");BancoAddItem(MCBD_IMPORTE,CC_ID,GT_ID,CC_DESC,GT_DESC,MCBD_CONCEPTO);}if(parseInt(objsc.getAttribute("MCB_TRASPASO"))==1){document.getElementById("BNK_TRASPASO1").checked=true;document.getElementById("BNK_BANCO1").value=objsc.getAttribute("BC_ID2");document.getElementById("BNK_PARIDAD1").value=objsc.getAttribute("MCB_PARIDAD2");EsTraspaso();}$("#dialogView").dialog("close");$("#dialogWait").dialog("close");}function SumaBancos(){var grid=jQuery("#BNK_GRID1");var arr=grid.getDataIDs();var dblSuma=0;for(var i=0;i<arr.length;i++){var id=arr[i];var lstRow=grid.getRowData(id);dblSuma+=parseFloat(lstRow.BNKD_IMPORTE);}d.getElementById("BNK_TOTAL").value=FormatNumber(dblSuma,intNumdecimal,true,false,true);}function CallbtnBc1(){InitBcoSIoNO();$("#SioNO").dialog("option","title",lstMsg[23]);d.getElementById("Operac").value="NvoBNK";document.getElementById("SioNO_inside").innerHTML="";$("#SioNO").dialog("open");}function CallbtnBc2(){OpnOpt("BANK_VIEW","grid","dialogView",false,false);}function CallbtnBc3(){var grid=jQuery("#BNK_GRID1");if(grid.getGridParam("selrow")!=null){grid.delRowData(grid.getGridParam("selrow"));document.getElementById("BNK_CCOSTO").focus();SumaBancos();}}function FormStyleBco(){d.getElementById("BNK_TOTAL").setAttribute("class","ui-Total");d.getElementById("BNK_TOTAL").setAttribute("className","ui-Total");}function ConfirmaSIBco(){if(d.getElementById("Operac").value=="NvoBNK"){BancoClean();$("#SioNO").dialog("close");}if(d.getElementById("Operac").value=="EditBNKItem"){BancoEditItemSave();$("#SioNO").dialog("close");}}function ConfirmaNOBco(){$("#SioNO").dialog("close");}function CallbtnBc10(){var idBco=document.getElementById("BNK_BANCO").value;if(parseInt(idBco)!=0){MakeReportInside(13,"Banco",idBco,"1");}}function dblClickBco(id){var strNomMain=objMap.getNomMain();var grid=jQuery("#BANCOS");var lstVal=grid.getRowData(id);if(strNomMain=="BANCOS"){OpnEdit(document.getElementById("Ed"+strNomMain));}else{if(strNomMain=="EDO_CTA_BC"){document.getElementById("ED_BANCO").value=lstVal.BC_ID;document.getElementById("ED_NOMBRE").value=lstVal.BC_DESCRIPCION;RefreshBcoEdoCta();}}}function RefreshMonedaBank(){$("#dialogWait").dialog("open");var intBanco=parseInt(document.getElementById("BNK_BANCO").value);var strPOST="BC_ID="+intBanco;$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"html",url:"ERP_Cobros.jsp?id=7",success:function(datos){document.getElementById("BNK_MONEDA").value=datos;$("#dialogWait").dialog("close");},error:function(objeto,quepaso,otroobj){alert(":bancos 3:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function PantallaProv(){if(document.getElementById("BNK_PROV").checked==true){OpnOpt("EDIT_PROV","_ed","dialogProv",false,false,true);}}function SeleccionaProv(){$("#dialogWait").dialog("open");var intPV=document.getElementById("PROV_ID").value;var strPOST="PV_ID="+intPV;document.getElementById("ID_PROV").value=intPV;document.getElementById("ID_ANTICIPO").value="";document.getElementById("TASA_CAMBIO").value="";document.getElementById("IMPORTE_DEVOLVER").value="";$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_CobrosCuentas.jsp?id=14",success:function(datos){var objsc=datos.getElementsByTagName("Anticipos")[0];var lstAnticipos=objsc.getElementsByTagName("Anticipo");$("#GRID_ANTICIPO").empty();if(lstAnticipos.length!=0){for(var i=0;i<lstAnticipos.length;i++){var obj=lstAnticipos[i];var strFecha=obj.getAttribute("MP_FECHA");var intMoneda=parseInt(obj.getAttribute("MP_MONEDA"));var txtMONEDA="";if(intMoneda==1){txtMONEDA="PESOS";}else{if(intMoneda==2){txtMONEDA="DOLARES";}else{if(intMoneda==3){txtMONEDA="EUROS";}}}strFecha=strFecha.substr(strFecha.length-2,strFecha.length)+"/"+strFecha.substr(4,2)+"/"+strFecha.substr(0,4);var datarow={ANTI_ID:obj.getAttribute("MP_ID"),ANTI_FECHA:strFecha,ANTI_ABONO:obj.getAttribute("MP_SALDO_ANTICIPO"),ANTI_FOLIO:obj.getAttribute("MP_FOLIO"),ANTI_MONEDA:obj.getAttribute("MP_MONEDA"),ANTI_TASAPESO:obj.getAttribute("MP_TASAPESO"),ANTI_ORIGINAL:obj.getAttribute("dblMP_ANTICIPO_ORIGINAL"),ANTI_MONEDA_LETRA:txtMONEDA};jQuery("#GRID_ANTICIPO").addRowData(i,datarow,"last");}$("#dialogWait").dialog("close");}else{alert("El proveedor seeleccionado no tiene anticipos");$("#dialogWait").dialog("close");}},error:function(objeto,quepaso,otroobj){alert(":ptoExist:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function ClickAceptarProv(){document.getElementById("BNK_IMPORTE").value=document.getElementById("IMPORTE_DEVOLVER").value;var grid=jQuery("#GRID_ANTICIPO");if(grid.getGridParam("selrow")==null){alert("No se ha seleccionado Anticipo");document.getElementById("BNK_PROV").checked=false;}$("#dialogProv").dialog("close");}function ClickCancelarProv(){$("#dialogProv").dialog("close");}function SelAnticipoRow(rowid,status){var grid=jQuery("#GRID_ANTICIPO");var lstRow=grid.getRowData(rowid);document.getElementById("ID_ANTICIPO").value=lstRow.ANTI_ID;document.getElementById("TASA_CAMBIO").value=lstRow.ANTI_TASAPESO;document.getElementById("IMPORTE_DEVOLVER").value=lstRow.ANTI_ABONO;}function SelAnticipoRowCte(rowid,status){var grid=jQuery("#GRID_ANTICIPO_CTE");var lstRow=grid.getRowData(rowid);document.getElementById("ID_ANTICIPO_CTE").value=lstRow.ANTI_ID;document.getElementById("TASA_CAMBIO_CTE").value=lstRow.ANTI_TASAPESO;document.getElementById("IMPORTE_DEVOLVER_CTE").value=lstRow.ANTI_ABONO;}function PantallaCte(){if(document.getElementById("BNK_CTE").checked==true){document.getElementById("BNK_PROV").checked=false;
OpnOpt("EDIT_CTE","_ed","dialogProv",false,false,true);}}function ClickAceptarCte(){document.getElementById("BNK_IMPORTE").value=document.getElementById("IMPORTE_DEVOLVER_CTE").value;var grid=jQuery("#GRID_ANTICIPO_CTE");if(grid.getGridParam("selrow")==null){alert("No se ha seleccionado Anticipo");document.getElementById("BNK_CTE").checked=false;}$("#dialogProv").dialog("close");}function SeleccionaCte(){$("#dialogWait").dialog("open");var intCTE=document.getElementById("CTE_ID").value;var strPOST="CT_ID="+intCTE;document.getElementById("ID_CTE").value=intCTE;document.getElementById("ID_ANTICIPO_CTE").value="";document.getElementById("TASA_CAMBIO_CTE").value="";document.getElementById("IMPORTE_DEVOLVER_CTE").value="";$.ajax({type:"POST",data:strPOST,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=utf-8",cache:false,dataType:"xml",url:"ERP_Cobros.jsp?id=13",success:function(datos){var objsc=datos.getElementsByTagName("Anticipos")[0];var lstAnticipos=objsc.getElementsByTagName("Anticipo");$("#GRID_ANTICIPO_CTE").empty();if(lstAnticipos.length!=0){for(var i=0;i<lstAnticipos.length;i++){var obj=lstAnticipos[i];var strFecha=obj.getAttribute("MC_FECHA");var intMoneda=parseInt(obj.getAttribute("MC_MONEDA"));var txtMONEDA="";if(intMoneda==1){txtMONEDA="PESOS";}else{if(intMoneda==2){txtMONEDA="DOLARES";}else{if(intMoneda==3){txtMONEDA="EUROS";}}}strFecha=strFecha.substr(strFecha.length-2,strFecha.length)+"/"+strFecha.substr(4,2)+"/"+strFecha.substr(0,4);var datarow={ANTI_ID:obj.getAttribute("MC_ID"),ANTI_FECHA:strFecha,ANTI_ABONO:obj.getAttribute("MC_SALDO_ANTICIPO"),ANTI_FOLIO:obj.getAttribute("MC_FOLIO"),ANTI_MONEDA:obj.getAttribute("MC_MONEDA"),ANTI_TASAPESO:obj.getAttribute("MC_TASAPESO"),ANTI_ORIGINAL:obj.getAttribute("MC_ANTICIPO_ORIGINAL"),ANTI_MONEDA_LETRA:txtMONEDA};jQuery("#GRID_ANTICIPO_CTE").addRowData(i,datarow,"last");}$("#dialogWait").dialog("close");}else{alert("El cliente seleccionado no tiene anticipos");$("#dialogWait").dialog("close");}},error:function(objeto,quepaso,otroobj){alert(":vta_bco2:"+objeto+" "+quepaso+" "+otroobj);$("#dialogWait").dialog("close");}});}function EsTransferencia(){var Sichecked=document.getElementById("BNK_ESTRANSFERENCIA1").checked;if(Sichecked){document.getElementById("BNK_CTA_DEST").parentNode.parentNode.style.display="block";document.getElementById("BNK_BCO_DEST").parentNode.parentNode.style.display="block";}else{document.getElementById("BNK_CTA_DEST").parentNode.parentNode.style.display="none";document.getElementById("BNK_BCO_DEST").parentNode.parentNode.style.display="none";}}function CallbtnBc4(){var grid=jQuery("#BNK_GRID1");var ids=grid.getGridParam("selrow");if(ids!=null){var lstRow=grid.getRowData(ids);document.getElementById("Operac").value="EditBNKItem";InitBcoSIoNO();$("#SioNO").dialog("option","title",lstMsg[238]);var div=document.getElementById("SioNO_inside");var strHtml=CreaTexto(lstMsg[8],"_NvoImporte",lstRow.BNKD_IMPORTE,10,10,true,false,"","left",0,"","","",false,1);strHtml+="<div class=''><div align='left'>"+lstMsg[239]+"</div><div align='left'><select name='tmp_CCostos' id='tmp_CCostos' ></select></div></div>";strHtml+="<div class=''><div align='left'>"+lstMsg[240]+"</div><div align='left'><select name='tmp_CGastos' id='tmp_CGastos' ></select></div></div>";div.innerHTML=strHtml;$("#BNK_CCOSTO option").clone().appendTo("#tmp_CCostos");$("#BNK_CGASTO option").clone().appendTo("#tmp_CGastos");var intCCostosDefa=lstRow.BNKD_CCOSTOS;var intGastosDefa=lstRow.BNKD_CGASTOS;d.getElementById("tmp_CCostos").value=intCCostosDefa;d.getElementById("tmp_CGastos").value=intGastosDefa;$("#SioNO").dialog("open");}}function BancoEditItemSave(){var grid=jQuery("#BNK_GRID1");var id=grid.getGridParam("selrow");if(id!=null){var lstRow=grid.getRowData(id);lstRow.BNKD_CCOSTOS=d.getElementById("tmp_CCostos").value;lstRow.BNKD_CGASTOS=d.getElementById("tmp_CGastos").value;lstRow.BNKD_IMPORTE=d.getElementById("_NvoImporte").value;var intCostosIdx=d.getElementById("tmp_CCostos").selectedIndex;var txtCostos=d.getElementById("tmp_CCostos").options[intCostosIdx].text;var intGastosIdx=d.getElementById("tmp_CGastos").selectedIndex;var txtGastos=d.getElementById("tmp_CGastos").options[intGastosIdx].text;lstRow.BNKD_NOMCGASTOS=txtGastos;lstRow.BNKD_NOMCCOSTOS=txtCostos;grid.setRowData(id,lstRow);SumaBancos();}}